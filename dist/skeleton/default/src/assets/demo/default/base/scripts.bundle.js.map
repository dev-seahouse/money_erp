{"version":3,"names":[],"mappings":"","sources":["scripts.bundle.js"],"sourcesContent":["/**\r\n * @class mUtil  Metronic base utilize class that privides helper functions\r\n */\r\n//== Polyfill\r\n// matches polyfill\r\nthis.Element && function(ElementPrototype) {\r\n    ElementPrototype.matches = ElementPrototype.matches ||\r\n        ElementPrototype.matchesSelector ||\r\n        ElementPrototype.webkitMatchesSelector ||\r\n        ElementPrototype.msMatchesSelector ||\r\n        function(selector) {\r\n            var node = this,\r\n                nodes = (node.parentNode || node.document).querySelectorAll(selector),\r\n                i = -1;\r\n            while (nodes[++i] && nodes[i] != node);\r\n            return !!nodes[i];\r\n        }\r\n}(Element.prototype);\r\n\r\n// closest polyfill\r\nthis.Element && function(ElementPrototype) {\r\n    ElementPrototype.closest = ElementPrototype.closest ||\r\n        function(selector) {\r\n            var el = this;\r\n            while (el.matches && !el.matches(selector)) el = el.parentNode;\r\n            return el.matches ? el : null;\r\n        }\r\n}(Element.prototype);\r\n\r\n\r\n// matches polyfill\r\nthis.Element && function(ElementPrototype) {\r\n    ElementPrototype.matches = ElementPrototype.matches ||\r\n        ElementPrototype.matchesSelector ||\r\n        ElementPrototype.webkitMatchesSelector ||\r\n        ElementPrototype.msMatchesSelector ||\r\n        function(selector) {\r\n            var node = this,\r\n                nodes = (node.parentNode || node.document).querySelectorAll(selector),\r\n                i = -1;\r\n            while (nodes[++i] && nodes[i] != node);\r\n            return !!nodes[i];\r\n        }\r\n}(Element.prototype);\r\n\r\n//\r\n// requestAnimationFrame polyfill by Erik Möller.\r\n//  With fixes from Paul Irish and Tino Zijdel\r\n//\r\n//  http://paulirish.com/2011/requestanimationframe-for-smart-animating/\r\n//  http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating\r\n//\r\n//  MIT license\r\n//\r\n(function() {\r\n    var lastTime = 0;\r\n    var vendors = ['webkit', 'moz'];\r\n    for (var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\r\n        window.requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame'];\r\n        window.cancelAnimationFrame =\r\n            window[vendors[x] + 'CancelAnimationFrame'] || window[vendors[x] + 'CancelRequestAnimationFrame'];\r\n    }\r\n\r\n    if (!window.requestAnimationFrame)\r\n        window.requestAnimationFrame = function(callback) {\r\n            var currTime = new Date().getTime();\r\n            var timeToCall = Math.max(0, 16 - (currTime - lastTime));\r\n            var id = window.setTimeout(function() {\r\n                callback(currTime + timeToCall);\r\n            }, timeToCall);\r\n            lastTime = currTime + timeToCall;\r\n            return id;\r\n        };\r\n\r\n    if (!window.cancelAnimationFrame)\r\n        window.cancelAnimationFrame = function(id) {\r\n            clearTimeout(id);\r\n        };\r\n}());\r\n\r\n// Source: https://github.com/jserz/js_piece/blob/master/DOM/ParentNode/prepend()/prepend().md\r\n(function(arr) {\r\n    arr.forEach(function(item) {\r\n        if (item.hasOwnProperty('prepend')) {\r\n            return;\r\n        }\r\n        Object.defineProperty(item, 'prepend', {\r\n            configurable: true,\r\n            enumerable: true,\r\n            writable: true,\r\n            value: function prepend() {\r\n                var argArr = Array.prototype.slice.call(arguments),\r\n                    docFrag = document.createDocumentFragment();\r\n\r\n                argArr.forEach(function(argItem) {\r\n                    var isNode = argItem instanceof Node;\r\n                    docFrag.appendChild(isNode ? argItem : document.createTextNode(String(argItem)));\r\n                });\r\n\r\n                this.insertBefore(docFrag, this.firstChild);\r\n            }\r\n        });\r\n    });\r\n})([Element.prototype, Document.prototype, DocumentFragment.prototype]);\r\n\r\n//== Global variables \r\nwindow.mUtilElementDataStore = {};\r\nwindow.mUtilElementDataStoreID = 0;\r\nwindow.mUtilDelegatedEventHandlers = {};\r\n\r\nvar mUtil = function() {\r\n\r\n    var resizeHandlers = [];\r\n\r\n    /** @type {object} breakpoints The device width breakpoints **/\r\n    var breakpoints = {\r\n        sm: 544, // Small screen / phone           \r\n        md: 768, // Medium screen / tablet            \r\n        lg: 1024, // Large screen / desktop        \r\n        xl: 1200 // Extra large screen / wide desktop\r\n    };\r\n\r\n    /**\r\n     * Handle window resize event with some \r\n     * delay to attach event handlers upon resize complete \r\n     */\r\n    var _windowResizeHandler = function() {\r\n        var _runResizeHandlers = function() {\r\n            // reinitialize other subscribed elements\r\n            for (var i = 0; i < resizeHandlers.length; i++) {\r\n                var each = resizeHandlers[i];\r\n                each.call();\r\n            }\r\n        };\r\n\r\n        var timeout = false; // holder for timeout id\r\n        var delay = 250; // delay after event is \"complete\" to run callback\r\n\r\n        window.addEventListener('resize', function() {\r\n            clearTimeout(timeout);\r\n            timeout = setTimeout(function() {\r\n                _runResizeHandlers();\r\n            }, delay); // wait 50ms until window resize finishes.\r\n        });\r\n    };\r\n\r\n    return {\r\n        /**\r\n         * Class main initializer.\r\n         * @param {object} options.\r\n         * @returns null\r\n         */\r\n        //main function to initiate the theme\r\n        init: function(options) {\r\n            if (options && options.breakpoints) {\r\n                breakpoints = options.breakpoints;\r\n            }\r\n\r\n            _windowResizeHandler();\r\n        },\r\n\r\n        /**\r\n         * Adds window resize event handler.\r\n         * @param {function} callback function.\r\n         */\r\n        addResizeHandler: function(callback) {\r\n            resizeHandlers.push(callback);\r\n        },\r\n\r\n        /**\r\n         * Removes window resize event handler.\r\n         * @param {function} callback function.\r\n         */\r\n        removeResizeHandler: function(callback) {\r\n            for (var i = 0; i < resizeHandlers.length; i++) {\r\n                if (callback === resizeHandlers[i]) {\r\n                    delete resizeHandlers[i];\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Trigger window resize handlers.\r\n         */\r\n        runResizeHandlers: function() {\r\n            _runResizeHandlers();\r\n        },\r\n\r\n        resize: function() {\r\n            if (typeof(Event) === 'function') {\r\n                // modern browsers\r\n                window.dispatchEvent(new Event('resize'));\r\n            } else {\r\n                // for IE and other old browsers\r\n                // causes deprecation warning on modern browsers\r\n                var evt = window.document.createEvent('UIEvents'); \r\n                evt.initUIEvent('resize', true, false, window, 0); \r\n                window.dispatchEvent(evt);\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Get GET parameter value from URL.\r\n         * @param {string} paramName Parameter name.\r\n         * @returns {string}  \r\n         */\r\n        getURLParam: function(paramName) {\r\n            var searchString = window.location.search.substring(1),\r\n                i, val, params = searchString.split(\"&\");\r\n\r\n            for (i = 0; i < params.length; i++) {\r\n                val = params[i].split(\"=\");\r\n                if (val[0] == paramName) {\r\n                    return unescape(val[1]);\r\n                }\r\n            }\r\n\r\n            return null;\r\n        },\r\n\r\n        /**\r\n         * Checks whether current device is mobile touch.\r\n         * @returns {boolean}  \r\n         */\r\n        isMobileDevice: function() {\r\n            return (this.getViewPort().width < this.getBreakpoint('lg') ? true : false);\r\n        },\r\n\r\n        /**\r\n         * Checks whether current device is desktop.\r\n         * @returns {boolean}  \r\n         */\r\n        isDesktopDevice: function() {\r\n            return mUtil.isMobileDevice() ? false : true;\r\n        },\r\n\r\n        /**\r\n         * Gets browser window viewport size. Ref:\r\n         * http://andylangton.co.uk/articles/javascript/get-viewport-size-javascript/\r\n         * @returns {object}  \r\n         */\r\n        getViewPort: function() {\r\n            var e = window,\r\n                a = 'inner';\r\n            if (!('innerWidth' in window)) {\r\n                a = 'client';\r\n                e = document.documentElement || document.body;\r\n            }\r\n\r\n            return {\r\n                width: e[a + 'Width'],\r\n                height: e[a + 'Height']\r\n            };\r\n        },\r\n\r\n        /**\r\n         * Checks whether given device mode is currently activated.\r\n         * @param {string} mode Responsive mode name(e.g: desktop,\r\n         *     desktop-and-tablet, tablet, tablet-and-mobile, mobile)\r\n         * @returns {boolean}  \r\n         */\r\n        isInResponsiveRange: function(mode) {\r\n            var breakpoint = this.getViewPort().width;\r\n\r\n            if (mode == 'general') {\r\n                return true;\r\n            } else if (mode == 'desktop' && breakpoint >= (this.getBreakpoint('lg') + 1)) {\r\n                return true;\r\n            } else if (mode == 'tablet' && (breakpoint >= (this.getBreakpoint('md') + 1) && breakpoint < this.getBreakpoint('lg'))) {\r\n                return true;\r\n            } else if (mode == 'mobile' && breakpoint <= this.getBreakpoint('md')) {\r\n                return true;\r\n            } else if (mode == 'desktop-and-tablet' && breakpoint >= (this.getBreakpoint('md') + 1)) {\r\n                return true;\r\n            } else if (mode == 'tablet-and-mobile' && breakpoint <= this.getBreakpoint('lg')) {\r\n                return true;\r\n            } else if (mode == 'minimal-desktop-and-below' && breakpoint <= this.getBreakpoint('xl')) {\r\n                return true;\r\n            }\r\n\r\n            return false;\r\n        },\r\n\r\n        /**\r\n         * Generates unique ID for give prefix.\r\n         * @param {string} prefix Prefix for generated ID\r\n         * @returns {boolean}  \r\n         */\r\n        getUniqueID: function(prefix) {\r\n            return prefix + Math.floor(Math.random() * (new Date()).getTime());\r\n        },\r\n\r\n        /**\r\n         * Gets window width for give breakpoint mode.\r\n         * @param {string} mode Responsive mode name(e.g: xl, lg, md, sm)\r\n         * @returns {number}  \r\n         */\r\n        getBreakpoint: function(mode) {\r\n            return breakpoints[mode];\r\n        },\r\n\r\n        /**\r\n         * Checks whether object has property matchs given key path.\r\n         * @param {object} obj Object contains values paired with given key path\r\n         * @param {string} keys Keys path seperated with dots\r\n         * @returns {object}  \r\n         */\r\n        isset: function(obj, keys) {\r\n            var stone;\r\n\r\n            keys = keys || '';\r\n\r\n            if (keys.indexOf('[') !== -1) {\r\n                throw new Error('Unsupported object path notation.');\r\n            }\r\n\r\n            keys = keys.split('.');\r\n\r\n            do {\r\n                if (obj === undefined) {\r\n                    return false;\r\n                }\r\n\r\n                stone = keys.shift();\r\n\r\n                if (!obj.hasOwnProperty(stone)) {\r\n                    return false;\r\n                }\r\n\r\n                obj = obj[stone];\r\n\r\n            } while (keys.length);\r\n\r\n            return true;\r\n        },\r\n\r\n        /**\r\n         * Gets highest z-index of the given element parents\r\n         * @param {object} el jQuery element object\r\n         * @returns {number}  \r\n         */\r\n        getHighestZindex: function(el) {\r\n            var elem = mUtil.get(el),\r\n                position, value;\r\n\r\n            while (elem && elem !== document) {\r\n                // Ignore z-index if position is set to a value where z-index is ignored by the browser\r\n                // This makes behavior of this function consistent across browsers\r\n                // WebKit always returns auto if the element is positioned\r\n                position = mUtil.css(elem, 'position');\r\n\r\n                if (position === \"absolute\" || position === \"relative\" || position === \"fixed\") {\r\n                    // IE returns 0 when zIndex is not specified\r\n                    // other browsers return a string\r\n                    // we ignore the case of nested elements with an explicit value of 0\r\n                    // <div style=\"z-index: -10;\"><div style=\"z-index: 0;\"></div></div>\r\n                    value = parseInt(mUtil.css(elem, 'z-index'));\r\n\r\n                    if (!isNaN(value) && value !== 0) {\r\n                        return value;\r\n                    }\r\n                }\r\n\r\n                elem = elem.parentNode;\r\n            }\r\n\r\n            return null;\r\n        },\r\n\r\n        /**\r\n         * Checks whether the element has any parent with fixed positionfreg\r\n         * @param {object} el jQuery element object\r\n         * @returns {boolean}  \r\n         */\r\n        hasFixedPositionedParent: function(el) {\r\n            while (el && el !== document) {\r\n                position = mUtil.css(el, 'position');\r\n\r\n                if (position === \"fixed\") {\r\n                    return true;\r\n                }\r\n\r\n                el = el.parentNode;\r\n            }\r\n\r\n            return false;\r\n        },\r\n\r\n        /**\r\n         * Simulates delay\r\n         */\r\n        sleep: function(milliseconds) {\r\n            var start = new Date().getTime();\r\n            for (var i = 0; i < 1e7; i++) {\r\n                if ((new Date().getTime() - start) > milliseconds) {\r\n                    break;\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Gets randomly generated integer value within given min and max range\r\n         * @param {number} min Range start value\r\n         * @param {number} min Range end value\r\n         * @returns {number}  \r\n         */\r\n        getRandomInt: function(min, max) {\r\n            return Math.floor(Math.random() * (max - min + 1)) + min;\r\n        },\r\n\r\n        /**\r\n         * Checks whether Angular library is included\r\n         * @returns {boolean}  \r\n         */\r\n        isAngularVersion: function() {\r\n            return window.Zone !== undefined ? true : false;\r\n        },\r\n\r\n        //== jQuery Workarounds\r\n\r\n        //== Deep extend:  $.extend(true, {}, objA, objB);\r\n        deepExtend: function(out) {\r\n            out = out || {};\r\n\r\n            for (var i = 1; i < arguments.length; i++) {\r\n                var obj = arguments[i];\r\n\r\n                if (!obj)\r\n                    continue;\r\n\r\n                for (var key in obj) {\r\n                    if (obj.hasOwnProperty(key)) {\r\n                        if (typeof obj[key] === 'object')\r\n                            out[key] = mUtil.deepExtend(out[key], obj[key]);\r\n                        else\r\n                            out[key] = obj[key];\r\n                    }\r\n                }\r\n            }\r\n\r\n            return out;\r\n        },\r\n\r\n        //== extend:  $.extend({}, objA, objB); \r\n        extend: function(out) {\r\n            out = out || {};\r\n\r\n            for (var i = 1; i < arguments.length; i++) {\r\n                if (!arguments[i])\r\n                    continue;\r\n\r\n                for (var key in arguments[i]) {\r\n                    if (arguments[i].hasOwnProperty(key))\r\n                        out[key] = arguments[i][key];\r\n                }\r\n            }\r\n\r\n            return out;\r\n        },\r\n\r\n        get: function(query) {\r\n            var el;\r\n\r\n            if (query === document) {\r\n                return document;\r\n            }\r\n\r\n            if (!!(query && query.nodeType === 1)) {\r\n                return query;\r\n            }\r\n\r\n            if (el = document.getElementById(query)) {\r\n                return el;\r\n            } else if (el = document.getElementsByTagName(query)) {\r\n                return el[0];\r\n            } else if (el = document.getElementsByClassName(query)) {\r\n                return el[0];\r\n            } else {\r\n                return null;\r\n            }\r\n        },\r\n\r\n        getByClass: function(query) {\r\n            var el;\r\n            \r\n            if (el = document.getElementsByClassName(query)) {\r\n                return el[0];\r\n            } else {\r\n                return null;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Checks whether the element has given classes\r\n         * @param {object} el jQuery element object\r\n         * @param {string} Classes string\r\n         * @returns {boolean}  \r\n         */\r\n        hasClasses: function(el, classes) {\r\n            if (!el) {\r\n                return;\r\n            }\r\n\r\n            var classesArr = classes.split(\" \");\r\n\r\n            for (var i = 0; i < classesArr.length; i++) {\r\n                if (mUtil.hasClass(el, mUtil.trim(classesArr[i])) == false) {\r\n                    return false;\r\n                }\r\n            }\r\n\r\n            return true;\r\n        },\r\n\r\n        hasClass: function(el, className) {\r\n            if (!el) {\r\n                return;\r\n            }\r\n\r\n            return el.classList ? el.classList.contains(className) : new RegExp('\\\\b' + className + '\\\\b').test(el.className);\r\n        },\r\n\r\n        addClass: function(el, className) {\r\n            if (!el || typeof className === 'undefined') {\r\n                return;\r\n            }\r\n\r\n            var classNames = className.split(' ');\r\n\r\n            if (el.classList) {\r\n                for (var i = 0; i < classNames.length; i++) {\r\n                    if (classNames[i] && classNames[i].length > 0) {\r\n                        el.classList.add(mUtil.trim(classNames[i]));\r\n                    }\r\n                }\r\n            } else if (!mUtil.hasClass(el, className)) {\r\n                for (var i = 0; i < classNames.length; i++) {\r\n                    el.className += ' ' + mUtil.trim(classNames[i]);\r\n                }\r\n            }\r\n        },\r\n\r\n        removeClass: function(el, className) {\r\n            if (!el) {\r\n                return;\r\n            }\r\n\r\n            var classNames = className.split(' ');\r\n\r\n            if (el.classList) {\r\n                for (var i = 0; i < classNames.length; i++) {\r\n                    el.classList.remove(mUtil.trim(classNames[i]));\r\n                }\r\n            } else if (mUtil.hasClass(el, className)) {\r\n                for (var i = 0; i < classNames.length; i++) {\r\n                    el.className = el.className.replace(new RegExp('\\\\b' + mUtil.trim(classNames[i]) + '\\\\b', 'g'), '');\r\n                }\r\n            }\r\n        },\r\n\r\n        triggerCustomEvent: function(el, eventName, data) {\r\n            if (window.CustomEvent) {\r\n                var event = new CustomEvent(eventName, {\r\n                    detail: data\r\n                });\r\n            } else {\r\n                var event = document.createEvent('CustomEvent');\r\n                event.initCustomEvent(eventName, true, true, data);\r\n            }\r\n\r\n            el.dispatchEvent(event);\r\n        },\r\n\r\n        trim: function(string) {\r\n            return string.trim();\r\n        },\r\n\r\n        eventTriggered: function(e) {\r\n            if (e.currentTarget.dataset.triggered) {\r\n                return true;\r\n            } else {\r\n                e.currentTarget.dataset.triggered = true;\r\n\r\n                return false;\r\n            }\r\n        },\r\n\r\n        remove: function(el) {\r\n            if (el && el.parentNode) {\r\n                el.parentNode.removeChild(el);\r\n            }\r\n        },\r\n\r\n        find: function(parent, query) {\r\n            return parent.querySelector(query);\r\n        },\r\n\r\n        findAll: function(parent, query) {\r\n            return parent.querySelectorAll(query);\r\n        },\r\n\r\n        insertAfter: function(el, referenceNode) {\r\n            return referenceNode.parentNode.insertBefore(el, referenceNode.nextSibling);\r\n        },\r\n\r\n        parents: function(el, query) {\r\n            function collectionHas(a, b) { //helper function (see below)\r\n                for (var i = 0, len = a.length; i < len; i++) {\r\n                    if (a[i] == b) return true;\r\n                }\r\n\r\n                return false;\r\n            }\r\n\r\n            function findParentBySelector(el, selector) {\r\n                var all = document.querySelectorAll(selector);\r\n                var cur = el.parentNode;\r\n\r\n                while (cur && !collectionHas(all, cur)) { //keep going up until you find a match\r\n                    cur = cur.parentNode; //go up\r\n                }\r\n\r\n                return cur; //will return null if not found\r\n            }\r\n\r\n            return findParentBySelector(el, query);\r\n        },\r\n\r\n        children: function(el, selector, log) {\r\n            if (!el || !el.childNodes) {\r\n                return;\r\n            }\r\n\r\n            var result = [],\r\n                i = 0,\r\n                l = el.childNodes.length;\r\n\r\n            for (var i; i < l; ++i) {\r\n                if (el.childNodes[i].nodeType == 1 && mUtil.matches(el.childNodes[i], selector, log)) {\r\n                    result.push(el.childNodes[i]);\r\n                }\r\n            }\r\n\r\n            return result;\r\n        },\r\n\r\n        child: function(el, selector, log) {\r\n            var children = mUtil.children(el, selector, log);\r\n\r\n            return children ? children[0] : null;\r\n        },\r\n\r\n        matches: function(el, selector, log) {\r\n            var p = Element.prototype;\r\n            var f = p.matches || p.webkitMatchesSelector || p.mozMatchesSelector || p.msMatchesSelector || function(s) {\r\n                return [].indexOf.call(document.querySelectorAll(s), this) !== -1;\r\n            };\r\n\r\n            if (el && el.tagName) {\r\n                return f.call(el, selector);\r\n            } else {\r\n                return false;\r\n            }\r\n        },\r\n\r\n        data: function(element) {\r\n            element = mUtil.get(element);\r\n\r\n            return {\r\n                set: function(name, data) {\r\n                    if (element.customDataTag === undefined) {\r\n                        mUtilElementDataStoreID++;\r\n                        element.customDataTag = mUtilElementDataStoreID;\r\n                    }\r\n\r\n                    if (mUtilElementDataStore[element.customDataTag] === undefined) {\r\n                        mUtilElementDataStore[element.customDataTag] = {};\r\n                    }\r\n\r\n                    mUtilElementDataStore[element.customDataTag][name] = data;\r\n                },\r\n\r\n                get: function(name) {\r\n                    return this.has(name) ? mUtilElementDataStore[element.customDataTag][name] : null;\r\n                },\r\n\r\n                has: function(name) {\r\n                    return (mUtilElementDataStore[element.customDataTag] && mUtilElementDataStore[element.customDataTag][name]) ? true : false;\r\n                },\r\n\r\n                remove: function(name) {\r\n                    if (this.has(name)) {\r\n                        delete mUtilElementDataStore[element.customDataTag][name];\r\n                    }\r\n                }\r\n            };\r\n        },\r\n\r\n        outerWidth: function(el, margin) {\r\n            var width;\r\n\r\n            if (margin === true) {\r\n                var width = parseFloat(el.offsetWidth);\r\n                width += parseFloat(mUtil.css(el, 'margin-left')) + parseFloat(mUtil.css(el, 'margin-right'));\r\n\r\n                return parseFloat(width);\r\n            } else {\r\n                var width = parseFloat(el.offsetWidth);\r\n\r\n                return width;\r\n            }\r\n        },\r\n\r\n        offset: function(elem) {\r\n            var rect, win;\r\n            elem = mUtil.get(elem);\r\n\r\n            if ( !elem ) {\r\n                return;\r\n            }\r\n\r\n            // Return zeros for disconnected and hidden (display: none) elements (gh-2310)\r\n            // Support: IE <=11 only\r\n            // Running getBoundingClientRect on a\r\n            // disconnected node in IE throws an error\r\n\r\n            if ( !elem.getClientRects().length ) {\r\n                return { top: 0, left: 0 };\r\n            }\r\n\r\n            // Get document-relative position by adding viewport scroll to viewport-relative gBCR\r\n            rect = elem.getBoundingClientRect();\r\n            win = elem.ownerDocument.defaultView;\r\n\r\n            return {\r\n                top: rect.top + win.pageYOffset,\r\n                left: rect.left + win.pageXOffset\r\n            };\r\n        },\r\n\r\n        height: function(el) {\r\n            return mUtil.css(el, 'height');\r\n        },\r\n\r\n        visible: function(el) {\r\n            return !(el.offsetWidth === 0 && el.offsetHeight === 0);\r\n        },\r\n\r\n        attr: function(el, name, value) {\r\n            el = mUtil.get(el);\r\n\r\n            if (el == undefined) {\r\n                return;\r\n            }\r\n\r\n            if (value !== undefined) {\r\n                el.setAttribute(name, value);\r\n            } else {\r\n                return el.getAttribute(name);\r\n            }\r\n        },\r\n\r\n        hasAttr: function(el, name) {\r\n            el = mUtil.get(el);\r\n\r\n            if (el == undefined) {\r\n                return;\r\n            }\r\n\r\n            return el.getAttribute(name) ? true : false;\r\n        },\r\n\r\n        removeAttr: function(el, name) {\r\n            el = mUtil.get(el);\r\n\r\n            if (el == undefined) {\r\n                return;\r\n            }\r\n\r\n            el.removeAttribute(name);\r\n        },\r\n\r\n        animate: function(from, to, duration, update, easing, done) {\r\n            /**\r\n             * TinyAnimate.easings\r\n             *  Adapted from jQuery Easing\r\n             */\r\n            var easings = {};\r\n            var easing;\r\n\r\n            easings.linear = function(t, b, c, d) {\r\n                return c * t / d + b;\r\n            };\r\n\r\n            easing = easings.linear;\r\n\r\n            // Early bail out if called incorrectly\r\n            if (typeof from !== 'number' ||\r\n                typeof to !== 'number' ||\r\n                typeof duration !== 'number' ||\r\n                typeof update !== 'function') {\r\n                return;\r\n            }\r\n\r\n            // Create mock done() function if necessary\r\n            if (typeof done !== 'function') {\r\n                done = function() {};\r\n            }\r\n\r\n            // Pick implementation (requestAnimationFrame | setTimeout)\r\n            var rAF = window.requestAnimationFrame || function(callback) {\r\n                window.setTimeout(callback, 1000 / 50);\r\n            };\r\n\r\n            // Animation loop\r\n            var canceled = false;\r\n            var change = to - from;\r\n\r\n            function loop(timestamp) {\r\n                var time = (timestamp || +new Date()) - start;\r\n\r\n                if (time >= 0) {\r\n                    update(easing(time, from, change, duration));\r\n                }\r\n                if (time >= 0 && time >= duration) {\r\n                    update(to);\r\n                    done();\r\n                } else {\r\n                    rAF(loop);\r\n                }\r\n            }\r\n\r\n            update(from);\r\n\r\n            // Start animation loop\r\n            var start = window.performance && window.performance.now ? window.performance.now() : +new Date();\r\n\r\n            rAF(loop);\r\n        },\r\n\r\n        actualCss: function(el, prop, cache) {\r\n            if (el instanceof HTMLElement === false) {\r\n                return;\r\n            }\r\n\r\n            if (!el.getAttribute('m-hidden-' + prop) || cache === false) {\r\n                var value;\r\n\r\n                // the element is hidden so:\r\n                // making the el block so we can meassure its height but still be hidden\r\n                el.style.cssText = 'position: absolute; visibility: hidden; display: block;';\r\n\r\n                if (prop == 'width') {\r\n                    value = el.offsetWidth;\r\n                } else if (prop == 'height') {\r\n                    value = el.offsetHeight;\r\n                }\r\n\r\n                el.style.cssText = '';\r\n\r\n                // store it in cache\r\n                el.setAttribute('m-hidden-' + prop, value);\r\n\r\n                return parseFloat(value);\r\n            } else {\r\n                // store it in cache\r\n                return parseFloat(el.getAttribute('m-hidden-' + prop));\r\n            }\r\n        },\r\n\r\n        actualHeight: function(el, cache) {\r\n            return mUtil.actualCss(el, 'height', cache);\r\n        },\r\n\r\n        actualWidth: function(el, cache) {\r\n            return mUtil.actualCss(el, 'width', cache);\r\n        },\r\n\r\n        getScroll: function(element, method) {\r\n            // The passed in `method` value should be 'Top' or 'Left'\r\n            method = 'scroll' + method;\r\n            return (element == window || element == document) ? (\r\n                self[(method == 'scrollTop') ? 'pageYOffset' : 'pageXOffset'] ||\r\n                (browserSupportsBoxModel && document.documentElement[method]) ||\r\n                document.body[method]\r\n            ) : element[method];\r\n        },\r\n\r\n        css: function(el, styleProp, value) {\r\n            el = mUtil.get(el);\r\n\r\n            if (!el) {\r\n                return;\r\n            }\r\n\r\n            if (value !== undefined) {\r\n                el.style[styleProp] = value;\r\n            } else {\r\n                var value, defaultView = (el.ownerDocument || document).defaultView;\r\n                // W3C standard way:\r\n                if (defaultView && defaultView.getComputedStyle) {\r\n                    // sanitize property name to css notation\r\n                    // (hyphen separated words eg. font-Size)\r\n                    styleProp = styleProp.replace(/([A-Z])/g, \"-$1\").toLowerCase();\r\n                    return defaultView.getComputedStyle(el, null).getPropertyValue(styleProp);\r\n                } else if (el.currentStyle) { // IE\r\n                    // sanitize property name to camelCase\r\n                    styleProp = styleProp.replace(/\\-(\\w)/g, function(str, letter) {\r\n                        return letter.toUpperCase();\r\n                    });\r\n                    value = el.currentStyle[styleProp];\r\n                    // convert other units to pixels on IE\r\n                    if (/^\\d+(em|pt|%|ex)?$/i.test(value)) {\r\n                        return (function(value) {\r\n                            var oldLeft = el.style.left,\r\n                                oldRsLeft = el.runtimeStyle.left;\r\n                            el.runtimeStyle.left = el.currentStyle.left;\r\n                            el.style.left = value || 0;\r\n                            value = el.style.pixelLeft + \"px\";\r\n                            el.style.left = oldLeft;\r\n                            el.runtimeStyle.left = oldRsLeft;\r\n                            return value;\r\n                        })(value);\r\n                    }\r\n                    return value;\r\n                }\r\n            }\r\n        },\r\n\r\n        slide: function(el, dir, speed, callback, recalcMaxHeight) {\r\n            if (!el || (dir == 'up' && mUtil.visible(el) === false) || (dir == 'down' && mUtil.visible(el) === true)) {\r\n                return;\r\n            }\r\n\r\n            speed = (speed ? speed : 600);\r\n            var calcHeight = mUtil.actualHeight(el);\r\n            var calcPaddingTop = false;\r\n            var calcPaddingBottom = false;\r\n\r\n            if (mUtil.css(el, 'padding-top') && mUtil.data(el).has('slide-padding-top') !== true) {\r\n                mUtil.data(el).set('slide-padding-top', mUtil.css(el, 'padding-top'));\r\n            }\r\n\r\n            if (mUtil.css(el, 'padding-bottom') && mUtil.data(el).has('slide-padding-bottom') !== true) {\r\n                mUtil.data(el).set('slide-padding-bottom', mUtil.css(el, 'padding-bottom'));\r\n            }\r\n\r\n            if (mUtil.data(el).has('slide-padding-top')) {\r\n                calcPaddingTop = parseInt(mUtil.data(el).get('slide-padding-top'));\r\n            }\r\n\r\n            if (mUtil.data(el).has('slide-padding-bottom')) {\r\n                calcPaddingBottom = parseInt(mUtil.data(el).get('slide-padding-bottom'));\r\n            }\r\n\r\n            if (dir == 'up') { // up          \r\n                el.style.cssText = 'display: block; overflow: hidden;';\r\n\r\n                if (calcPaddingTop) {\r\n                    mUtil.animate(0, calcPaddingTop, speed, function(value) {\r\n                        el.style.paddingTop = (calcPaddingTop - value) + 'px';\r\n                    }, 'linear');\r\n                }\r\n\r\n                if (calcPaddingBottom) {\r\n                    mUtil.animate(0, calcPaddingBottom, speed, function(value) {\r\n                        el.style.paddingBottom = (calcPaddingBottom - value) + 'px';\r\n                    }, 'linear');\r\n                }\r\n\r\n                mUtil.animate(0, calcHeight, speed, function(value) {\r\n                    el.style.height = (calcHeight - value) + 'px';\r\n                }, 'linear', function() {\r\n                    callback();\r\n                    el.style.height = '';\r\n                    el.style.display = 'none';\r\n                });\r\n\r\n\r\n            } else if (dir == 'down') { // down\r\n                el.style.cssText = 'display: block; overflow: hidden;';\r\n\r\n                if (calcPaddingTop) {\r\n                    mUtil.animate(0, calcPaddingTop, speed, function(value) {\r\n                        el.style.paddingTop = value + 'px';\r\n                    }, 'linear', function() {\r\n                        el.style.paddingTop = '';\r\n                    });\r\n                }\r\n\r\n                if (calcPaddingBottom) {\r\n                    mUtil.animate(0, calcPaddingBottom, speed, function(value) {\r\n                        el.style.paddingBottom = value + 'px';\r\n                    }, 'linear', function() {\r\n                        el.style.paddingBottom = '';\r\n                    });\r\n                }\r\n\r\n                mUtil.animate(0, calcHeight, speed, function(value) {\r\n                    el.style.height = value + 'px';\r\n                }, 'linear', function() {\r\n                    callback();\r\n                    el.style.height = '';\r\n                    el.style.display = '';\r\n                    el.style.overflow = '';\r\n                });\r\n            }\r\n        },\r\n\r\n        slideUp: function(el, speed, callback) {\r\n            mUtil.slide(el, 'up', speed, callback);\r\n        },\r\n\r\n        slideDown: function(el, speed, callback) {\r\n            mUtil.slide(el, 'down', speed, callback);\r\n        },\r\n\r\n        show: function(el, display) {\r\n            el.style.display = (display ? display : 'block');\r\n        },\r\n\r\n        hide: function(el) {\r\n            el.style.display = 'none';\r\n        },\r\n\r\n        addEvent: function(el, type, handler, one) {\r\n            el = mUtil.get(el);\r\n            if (typeof el !== 'undefined') {\r\n                el.addEventListener(type, handler);\r\n            }\r\n        },\r\n\r\n        removeEvent: function(el, type, handler) {\r\n            el = mUtil.get(el);\r\n            el.removeEventListener(type, handler);\r\n        },\r\n\r\n        on: function(element, selector, event, handler) {\r\n            if (!selector) {\r\n                return;\r\n            }\r\n\r\n            var eventId = mUtil.getUniqueID('event');\r\n\r\n            mUtilDelegatedEventHandlers[eventId] = function(e) {\r\n                var targets = element.querySelectorAll(selector);\r\n                var target = e.target;\r\n\r\n                while (target && target !== element) {\r\n                    for (var i = 0, j = targets.length; i < j; i++) {\r\n                        if (target === targets[i]) {\r\n                            handler.call(target, e);\r\n                        }\r\n                    }\r\n\r\n                    target = target.parentNode;\r\n                }\r\n            }\r\n\r\n            mUtil.addEvent(element, event, mUtilDelegatedEventHandlers[eventId]);\r\n\r\n            return eventId;\r\n        },\r\n\r\n        off: function(element, event, eventId) {\r\n            if (!element || !mUtilDelegatedEventHandlers[eventId]) {\r\n                return;\r\n            }\r\n\r\n            mUtil.removeEvent(element, event, mUtilDelegatedEventHandlers[eventId]);\r\n\r\n            delete mUtilDelegatedEventHandlers[eventId];\r\n        },\r\n\r\n        one: function onetime(el, type, callback) {\r\n            el = mUtil.get(el);\r\n\r\n            el.addEventListener(type, function(e) {\r\n                // remove event\r\n                e.target.removeEventListener(e.type, arguments.callee);\r\n                // call handler\r\n                return callback(e);\r\n            });\r\n        },\r\n\r\n        hash: function(str) {\r\n            var hash = 0,\r\n                i, chr;\r\n\r\n            if (str.length === 0) return hash;\r\n            for (i = 0; i < str.length; i++) {\r\n                chr = str.charCodeAt(i);\r\n                hash = ((hash << 5) - hash) + chr;\r\n                hash |= 0; // Convert to 32bit integer\r\n            }\r\n\r\n            return hash;\r\n        },\r\n\r\n        animateClass: function(el, animationName, callback) {\r\n            var animationEnd = 'webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend';\r\n\r\n            mUtil.addClass(el, 'animated ' + animationName);\r\n\r\n            mUtil.one(el, animationEnd, function() {\r\n                mUtil.removeClass(el, 'animated ' + animationName);\r\n            });\r\n\r\n            if (callback) {\r\n                mUtil.one(el.animationEnd, callback);\r\n            }\r\n        },\r\n\r\n        animateDelay: function(el, value) {\r\n            var vendors = ['webkit-', 'moz-', 'ms-', 'o-', ''];\r\n            for (var i = 0; i < vendors.length; i++) {\r\n                mUtil.css(el, vendors[i] + 'animation-delay', value);\r\n            }\r\n        },\r\n\r\n        animateDuration: function(el, value) {\r\n            var vendors = ['webkit-', 'moz-', 'ms-', 'o-', ''];\r\n            for (var i = 0; i < vendors.length; i++) {\r\n                mUtil.css(el, vendors[i] + 'animation-duration', value);\r\n            }\r\n        },\r\n\r\n        scrollTo: function(target, offset, duration) {\r\n            var duration = duration ? duration : 500;\r\n            var target = mUtil.get(target);\r\n            var targetPos = target ? mUtil.offset(target).top : 0;\r\n            var scrollPos = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;\r\n            var from, to;\r\n\r\n            if (targetPos > scrollPos) {\r\n                from = targetPos;\r\n                to = scrollPos;\r\n            } else {\r\n                from = scrollPos;\r\n                to = targetPos;\r\n            }\r\n\r\n            if (offset) {\r\n                to += offset;\r\n            }\r\n\r\n            mUtil.animate(from, to, duration, function(value) {\r\n                document.documentElement.scrollTop = value;\r\n                document.body.parentNode.scrollTop = value;\r\n                document.body.scrollTop = value;\r\n            }); //, easing, done\r\n        },\r\n\r\n        scrollTop: function(offset, duration) {\r\n            mUtil.scrollTo(null, offset, duration);\r\n        },\r\n\r\n        isArray: function(obj) {\r\n            return obj && Array.isArray(obj);\r\n        },\r\n\r\n        ready: function(callback) {\r\n            if (document.attachEvent ? document.readyState === \"complete\" : document.readyState !== \"loading\") {\r\n                callback();\r\n            } else {\r\n                document.addEventListener('DOMContentLoaded', callback);\r\n            }\r\n        },\r\n\r\n        isEmpty: function(obj) {\r\n            for (var prop in obj) {\r\n                if (obj.hasOwnProperty(prop)) {\r\n                    return false;\r\n                }\r\n            }\r\n\r\n            return true;\r\n        },\r\n\r\n        numberString: function(nStr) {\r\n            nStr += '';\r\n            var x = nStr.split('.');\r\n            var x1 = x[0];\r\n            var x2 = x.length > 1 ? '.' + x[1] : '';\r\n            var rgx = /(\\d+)(\\d{3})/;\r\n            while (rgx.test(x1)) {\r\n                x1 = x1.replace(rgx, '$1' + ',' + '$2');\r\n            }\r\n            return x1 + x2;\r\n        },\r\n\r\n        detectIE: function() {\r\n            var ua = window.navigator.userAgent;\r\n\r\n            // Test values; Uncomment to check result …\r\n\r\n            // IE 10\r\n            // ua = 'Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; Trident/6.0)';\r\n\r\n            // IE 11\r\n            // ua = 'Mozilla/5.0 (Windows NT 6.3; Trident/7.0; rv:11.0) like Gecko';\r\n\r\n            // Edge 12 (Spartan)\r\n            // ua = 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.71 Safari/537.36 Edge/12.0';\r\n\r\n            // Edge 13\r\n            // ua = 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2486.0 Safari/537.36 Edge/13.10586';\r\n\r\n            var msie = ua.indexOf('MSIE ');\r\n            if (msie > 0) {\r\n                // IE 10 or older => return version number\r\n                return parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10);\r\n            }\r\n\r\n            var trident = ua.indexOf('Trident/');\r\n            if (trident > 0) {\r\n                // IE 11 => return version number\r\n                var rv = ua.indexOf('rv:');\r\n                return parseInt(ua.substring(rv + 3, ua.indexOf('.', rv)), 10);\r\n            }\r\n\r\n            var edge = ua.indexOf('Edge/');\r\n            if (edge > 0) {\r\n                // Edge (IE 12+) => return version number\r\n                return parseInt(ua.substring(edge + 5, ua.indexOf('.', edge)), 10);\r\n            }\r\n\r\n            // other browser\r\n            return false;\r\n        },\r\n\r\n        isRTL: function() {\r\n            return (mUtil.attr(mUtil.get('html'), 'direction') == 'rtl');\r\n        },\r\n\r\n        //== Scroller\r\n        scrollerInit: function(element, options) {\r\n            //== Define init function\r\n            function init() {\r\n                var ps;\r\n                var height;\r\n\r\n                if (options.height instanceof Function) {\r\n                    height = parseInt(options.height.call());\r\n                } else {\r\n                    height = parseInt(options.height);\r\n                }\r\n\r\n                //== Destroy scroll on table and mobile modes\r\n                if (options.disableForMobile && mUtil.isInResponsiveRange('tablet-and-mobile')) {\r\n                    if (ps = mUtil.data(element).get('ps')) {\r\n                        if (options.resetHeightOnDestroy) {\r\n                            mUtil.css(element, 'height', 'auto');\r\n                        } else {\r\n                            mUtil.css(element, 'overflow', 'auto');\r\n                            if (height > 0) {\r\n                                mUtil.css(element, 'height', height + 'px');\r\n                            }\r\n                        }\r\n\r\n                        ps.destroy();\r\n                        ps = mUtil.data(element).remove('ps');\r\n                    } else if (height > 0){\r\n                        mUtil.css(element, 'overflow', 'auto');\r\n                        mUtil.css(element, 'height', height + 'px');\r\n                    }\r\n\r\n                    return;\r\n                }\r\n\r\n                if (height > 0) {\r\n                    mUtil.css(element, 'height', height + 'px');\r\n                }\r\n\r\n                mUtil.css(element, 'overflow', 'hidden');\r\n\r\n                //== Init scroll\r\n                if (ps = mUtil.data(element).get('ps')) {\r\n                    ps.update();\r\n                } else {\r\n                    mUtil.addClass(element, 'm-scroller');\r\n                    ps = new PerfectScrollbar(element, {\r\n                        wheelSpeed: 0.5,\r\n                        swipeEasing: true,\r\n                        wheelPropagation: false,\r\n                        minScrollbarLength: 40,\r\n                        suppressScrollX: true\r\n                    });\r\n\r\n                    mUtil.data(element).set('ps', ps);\r\n                }\r\n            }\r\n\r\n            //== Init\r\n            init();\r\n\r\n            //== Handle window resize\r\n            if (options.handleWindowResize) {\r\n                mUtil.addResizeHandler(function() {\r\n                    init();\r\n                });\r\n            }\r\n        },\r\n\r\n        scrollerUpdate: function(element) {\r\n            var ps;\r\n            if (ps = mUtil.data(element).get('ps')) {\r\n                console.log('update!');\r\n                ps.update();\r\n            }\r\n        },\r\n\r\n        scrollersUpdate: function(parent) {\r\n            var scrollers = mUtil.findAll(parent, '.ps');\r\n            for (var i = 0, len = scrollers.length; i < len; i++) {\r\n                mUtil.scrollerUpdate(scrollers[i]);\r\n            }\r\n        },\r\n\r\n        scrollerTop: function(element) {\r\n            var ps;\r\n            if (ps = mUtil.data(element).get('ps')) {\r\n                element.scrollTop = 0;\r\n            }\r\n        },\r\n\r\n        scrollerDestroy: function(element) {\r\n            var ps;\r\n            if (ps = mUtil.data(element).get('ps')) {\r\n                ps.destroy();\r\n                ps = mUtil.data(element).remove('ps');\r\n            }\r\n        }\r\n    }\r\n}();\r\n\r\n//== Initialize mUtil class on document ready\r\nmUtil.ready(function() {\r\n    mUtil.init();\r\n});\n/**\r\n * @class mApp  Metronic App class\r\n */\r\n\r\nvar mApp = function() {\r\n\r\n    /** @type {object} colors State colors **/\r\n    var colors = {\r\n        brand:      '#716aca',\r\n        metal:      '#c4c5d6',\r\n        light:      '#ffffff',\r\n        accent:     '#00c5dc',\r\n        primary:    '#5867dd',\r\n        success:    '#34bfa3',\r\n        info:       '#36a3f7',\r\n        warning:    '#ffb822',\r\n        danger:     '#f4516c',\r\n        focus:      '#9816f4'\r\n    }\r\n\r\n    /**\r\n    * Initializes bootstrap tooltip\r\n    */\r\n    var initTooltip = function(el) {\r\n        var skin = el.data('skin') ? 'm-tooltip--skin-' + el.data('skin') : '';\r\n        var width = el.data('width') == 'auto' ? 'm-tooltop--auto-width' : '';\r\n        var triggerValue = el.data('trigger') ? el.data('trigger') : 'hover';\r\n        var placement = el.data('placement') ? el.data('placement') : 'left';\r\n                    \r\n        el.tooltip({\r\n            trigger: triggerValue,\r\n            template: '<div class=\"m-tooltip ' + skin + ' ' + width + ' tooltip\" role=\"tooltip\">\\\r\n                <div class=\"arrow\"></div>\\\r\n                <div class=\"tooltip-inner\"></div>\\\r\n            </div>'\r\n        });\r\n    }\r\n    \r\n    /**\r\n    * Initializes bootstrap tooltips\r\n    */\r\n    var initTooltips = function() {\r\n        // init bootstrap tooltips\r\n        $('[data-toggle=\"m-tooltip\"]').each(function() {\r\n            initTooltip($(this));\r\n        });\r\n    }\r\n\r\n    /**\r\n    * Initializes bootstrap popover\r\n    */\r\n    var initPopover = function(el) {\r\n        var skin = el.data('skin') ? 'm-popover--skin-' + el.data('skin') : '';\r\n        var triggerValue = el.data('trigger') ? el.data('trigger') : 'hover';\r\n            \r\n        el.popover({\r\n            trigger: triggerValue,\r\n            template: '\\\r\n            <div class=\"m-popover ' + skin + ' popover\" role=\"tooltip\">\\\r\n                <div class=\"arrow\"></div>\\\r\n                <h3 class=\"popover-header\"></h3>\\\r\n                <div class=\"popover-body\"></div>\\\r\n            </div>'\r\n        });\r\n    }\r\n\r\n    /**\r\n    * Initializes bootstrap popovers\r\n    */\r\n    var initPopovers = function() {\r\n        // init bootstrap popover\r\n        $('[data-toggle=\"m-popover\"]').each(function() {\r\n            initPopover($(this));\r\n        });\r\n    }\r\n\r\n    /**\r\n    * Initializes bootstrap file input\r\n    */\r\n    var initFileInput = function() {\r\n        // init bootstrap popover\r\n        $('.custom-file-input').on('change',function(){\r\n            var fileName = $(this).val();\r\n            $(this).next('.custom-file-label').addClass(\"selected\").html(fileName);\r\n        });\r\n    }           \r\n\r\n    /**\r\n    * Initializes metronic portlet\r\n    */\r\n    var initPortlet = function(el, options) {\r\n        // init portlet tools\r\n        var el = $(el);\r\n        var portlet = new mPortlet(el[0], options);\r\n    }\r\n\r\n    /**\r\n    * Initializes metronic portlets\r\n    */\r\n    var initPortlets = function() {\r\n        // init portlet tools\r\n        $('[m-portlet=\"true\"]').each(function() {\r\n            var el = $(this);\r\n\r\n            if ( el.data('portlet-initialized') !== true ) {\r\n                initPortlet(el, {});\r\n                el.data('portlet-initialized', true);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n    * Initializes scrollable contents\r\n    */\r\n    var initScrollers = function() {\r\n        $('[data-scrollable=\"true\"]').each(function(){\r\n            var el = $(this);\r\n            mUtil.scrollerInit(this, {disableForMobile: true, handleWindowResize: true, height: function() {\r\n                if (mUtil.isInResponsiveRange('tablet-and-mobile') && el.data('mobile-height')) {\r\n                    return el.data('mobile-height');\r\n                } else {\r\n                    return el.data('height');\r\n                }\r\n            }});\r\n        });\r\n    }\r\n\r\n    /**\r\n    * Initializes bootstrap alerts\r\n    */\r\n    var initAlerts = function() {\r\n        // init bootstrap popover\r\n        $('body').on('click', '[data-close=alert]', function() {\r\n            $(this).closest('.alert').hide();\r\n        });\r\n    }\r\n\r\n    /**\r\n    * Initializes Metronic custom tabs\r\n    */\r\n    var initCustomTabs = function() {\r\n        // init bootstrap popover\r\n        $('[data-tab-target]').each(function() {\r\n            if ($(this).data('tabs-initialized') == true ) {\r\n                return;\r\n            }\r\n\r\n            $(this).click(function(e) {\r\n                e.preventDefault();\r\n                \r\n                var tab = $(this);\r\n                var tabs = tab.closest('[data-tabs=\"true\"]');\r\n                var contents = $( tabs.data('tabs-contents') );\r\n                var content = $( tab.data('tab-target') );\r\n\r\n                tabs.find('.m-tabs__item.m-tabs__item--active').removeClass('m-tabs__item--active');\r\n                tab.addClass('m-tabs__item--active');\r\n\r\n                contents.find('.m-tabs-content__item.m-tabs-content__item--active').removeClass('m-tabs-content__item--active');\r\n                content.addClass('m-tabs-content__item--active');         \r\n            });\r\n\r\n            $(this).data('tabs-initialized', true);\r\n        });\r\n    }\r\n\r\n\tvar hideTouchWarning = function() {\r\n\t\tjQuery.event.special.touchstart = {\r\n\t\t\tsetup: function(_, ns, handle) {\r\n\t\t\t\tif (typeof this === 'function')\r\n\t\t\t\t\tif (ns.includes('noPreventDefault')) {\r\n\t\t\t\t\t\tthis.addEventListener('touchstart', handle, {passive: false});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.addEventListener('touchstart', handle, {passive: true});\r\n\t\t\t\t\t}\r\n\t\t\t},\r\n\t\t};\r\n\t\tjQuery.event.special.touchmove = {\r\n\t\t\tsetup: function(_, ns, handle) {\r\n\t\t\t\tif (typeof this === 'function')\r\n\t\t\t\t\tif (ns.includes('noPreventDefault')) {\r\n\t\t\t\t\t\tthis.addEventListener('touchmove', handle, {passive: false});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.addEventListener('touchmove', handle, {passive: true});\r\n\t\t\t\t\t}\r\n\t\t\t},\r\n\t\t};\r\n\t\tjQuery.event.special.wheel = {\r\n\t\t\tsetup: function(_, ns, handle) {\r\n\t\t\t\tif (typeof this === 'function')\r\n\t\t\t\t\tif (ns.includes('noPreventDefault')) {\r\n\t\t\t\t\t\tthis.addEventListener('wheel', handle, {passive: false});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.addEventListener('wheel', handle, {passive: true});\r\n\t\t\t\t\t}\r\n\t\t\t},\r\n\t\t};\r\n\t};\r\n\r\n    return {\r\n        /**\r\n        * Main class initializer\r\n        */\r\n        init: function(options) {\r\n            if (options && options.colors) {\r\n                colors = options.colors;\r\n            }\r\n            mApp.initComponents();\r\n        },\r\n\r\n        /**\r\n        * Initializes components\r\n        */\r\n        initComponents: function() {\r\n            hideTouchWarning();\r\n            initScrollers();\r\n            initTooltips();\r\n            initPopovers();\r\n            initAlerts();\r\n            initPortlets();\r\n            initFileInput();\r\n            initCustomTabs();\r\n        },\r\n\r\n\r\n        /**\r\n        * Init custom tabs\r\n        */\r\n        initCustomTabs: function() {\r\n            initCustomTabs();\r\n        },\r\n\r\n        /**\r\n        * \r\n        * @param {object} el jQuery element object\r\n        */\r\n        // wrJangoer function to scroll(focus) to an element\r\n        initTooltips: function() {\r\n            initTooltips();\r\n        },\r\n\r\n        /**\r\n        * \r\n        * @param {object} el jQuery element object\r\n        */\r\n        // wrJangoer function to scroll(focus) to an element\r\n        initTooltip: function(el) {\r\n            initTooltip(el);\r\n        },\r\n\r\n        /**\r\n        * \r\n        * @param {object} el jQuery element object\r\n        */\r\n        // wrJangoer function to scroll(focus) to an element\r\n        initPopovers: function() {\r\n            initPopovers();\r\n        },\r\n\r\n        /**\r\n        * \r\n        * @param {object} el jQuery element object\r\n        */\r\n        // wrJangoer function to scroll(focus) to an element\r\n        initPopover: function(el) {\r\n            initPopover(el);\r\n        },\r\n\r\n        /**\r\n        * \r\n        * @param {object} el jQuery element object\r\n        */\r\n        // function to init portlet\r\n        initPortlet: function(el, options) {\r\n            initPortlet(el, options);\r\n        },\r\n\r\n        /**\r\n        * \r\n        * @param {object} el jQuery element object\r\n        */\r\n        // function to init portlets\r\n        initPortlets: function() {\r\n            initPortlets();\r\n        },\r\n\r\n        /**\r\n        * Blocks element with loading indiciator using http://malsup.com/jquery/block/\r\n        * @param {object} target jQuery element object\r\n        * @param {object} options \r\n        */\r\n        block: function(target, options) {\r\n            var el = $(target);\r\n\r\n            options = $.extend(true, {\r\n                opacity: 0.03,\r\n                overlayColor: '#000000',\r\n                state: 'brand',\r\n                type: 'loader',\r\n                size: 'lg',\r\n                centerX: true,\r\n                centerY: true,\r\n                message: '',\r\n                shadow: true,\r\n                width: 'auto'\r\n            }, options);\r\n\r\n            var skin;\r\n            var state;\r\n            var loading;\r\n\r\n            if (options.type == 'spinner') {\r\n                skin = options.skin ? 'm-spinner--skin-' + options.skin : '';\r\n                state = options.state ? 'm-spinner--' + options.state : '';\r\n                loading = '<div class=\"m-spinner ' + skin + ' ' + state + '\"></div';\r\n            } else {\r\n                skin = options.skin ? 'm-loader--skin-' + options.skin : '';\r\n                state = options.state ? 'm-loader--' + options.state : '';\r\n                size = options.size ? 'm-loader--' + options.size : '';\r\n                loading = '<div class=\"m-loader ' + skin + ' ' + state + ' ' + size + '\"></div';\r\n            }\r\n\r\n            if (options.message && options.message.length > 0) {\r\n                var classes = 'm-blockui ' + (options.shadow === false ? 'm-blockui-no-shadow' : '');\r\n\r\n                html = '<div class=\"' + classes + '\"><span>' + options.message + '</span><span>' + loading + '</span></div>';\r\n\r\n                var el = document.createElement('div');\r\n                mUtil.get('body').prepend(el);\r\n                mUtil.addClass(el, classes);\r\n                el.innerHTML = '<span>' + options.message + '</span><span>' + loading + '</span>';\r\n                options.width = mUtil.actualWidth(el) + 10;\r\n                mUtil.remove(el);\r\n\r\n                if (target == 'body') {\r\n                    html = '<div class=\"' + classes + '\" style=\"margin-left:-'+ (options.width / 2) +'px;\"><span>' + options.message + '</span><span>' + loading + '</span></div>';\r\n                }\r\n            } else {\r\n                html = loading;\r\n            }\r\n\r\n            var params = {\r\n                message: html,\r\n                centerY: options.centerY,\r\n                centerX: options.centerX,\r\n                css: {\r\n                    top: '30%',\r\n                    left: '50%',\r\n                    border: '0',\r\n                    padding: '0',\r\n                    backgroundColor: 'none',\r\n                    width: options.width\r\n                },\r\n                overlayCSS: {\r\n                    backgroundColor: options.overlayColor,\r\n                    opacity: options.opacity,\r\n                    cursor: 'wait',\r\n                    zIndex: '10'\r\n                },\r\n                onUnblock: function() {\r\n                    if (el && el[0]) {\r\n                        mUtil.css(el[0], 'position', '');\r\n                        mUtil.css(el[0], 'zoom', '');\r\n                    }                    \r\n                }\r\n            };\r\n\r\n            if (target == 'body') {\r\n                params.css.top = '50%';\r\n                $.blockUI(params);\r\n            } else {\r\n                var el = $(target);\r\n                el.block(params);\r\n            }\r\n        },\r\n\r\n        /**\r\n        * Un-blocks the blocked element \r\n        * @param {object} target jQuery element object\r\n        */\r\n        unblock: function(target) {\r\n            if (target && target != 'body') {\r\n                $(target).unblock();\r\n            } else {\r\n                $.unblockUI();\r\n            }\r\n        },\r\n\r\n        /**\r\n        * Blocks the page body element with loading indicator\r\n        * @param {object} options \r\n        */\r\n        blockPage: function(options) {\r\n            return mApp.block('body', options);\r\n        },\r\n\r\n        /**\r\n        * Un-blocks the blocked page body element\r\n        */\r\n        unblockPage: function() {\r\n            return mApp.unblock('body');\r\n        },\r\n\r\n        /**\r\n        * Enable loader progress for button and other elements\r\n        * @param {object} target jQuery element object\r\n        * @param {object} options\r\n        */\r\n        progress: function(target, options) {\r\n            var skin = (options && options.skin) ? options.skin : 'light';\r\n            var alignment = (options && options.alignment) ? options.alignment : 'right'; \r\n            var size = (options && options.size) ? 'm-spinner--' + options.size : ''; \r\n            var classes = 'm-loader ' + 'm-loader--' + skin + ' m-loader--' + alignment + ' m-loader--' + size;\r\n\r\n            mApp.unprogress(target);\r\n            \r\n            $(target).addClass(classes);\r\n            $(target).data('progress-classes', classes);\r\n        },\r\n\r\n        /**\r\n        * Disable loader progress for button and other elements\r\n        * @param {object} target jQuery element object\r\n        */\r\n        unprogress: function(target) {\r\n            $(target).removeClass($(target).data('progress-classes'));\r\n        },\r\n\r\n        /**\r\n        * Gets state color's hex code by color name\r\n        * @param {string} name Color name\r\n        * @returns {string}  \r\n        */\r\n        getColor: function(name) {\r\n            return colors[name];\r\n        }\r\n    };\r\n}();\r\n\r\n//== Initialize mApp class on document ready\r\n$(document).ready(function() {\r\n    mApp.init({});\r\n});\n(function($) {\r\n\r\n    if (typeof mUtil === 'undefined') throw new Error('mUtil is required and must be included before mDatatable.');\r\n\r\n    // plugin setup\r\n    $.fn.mDatatable = function(options) {\r\n        if ($(this).length === 0) {\r\n            console.log('No mDatatable element exist.');\r\n            return;\r\n        }\r\n\r\n        // global variables\r\n        var datatable = this;\r\n\r\n        // debug enabled?\r\n        // 1) state will be cleared on each refresh\r\n        // 2) enable some logs\r\n        // 3) etc.\r\n        datatable.debug = false;\r\n\r\n        datatable.API = {\r\n            record: null,\r\n            value: null,\r\n            params: null,\r\n        };\r\n\r\n        var Plugin = {\r\n            /********************\r\n             ** PRIVATE METHODS\r\n             ********************/\r\n            isInit: false,\r\n            offset: 110,\r\n            stateId: 'meta',\r\n            ajaxParams: {},\r\n\r\n            init: function(options) {\r\n                var isHtmlTable = false;\r\n                // data source option empty is normal table\r\n                if (options.data.source === null) {\r\n                    Plugin.extractTable();\r\n                    isHtmlTable = true;\r\n                }\r\n\r\n                Plugin.setupBaseDOM.call();\r\n                Plugin.setupDOM(datatable.table);\r\n                Plugin.spinnerCallback(true);\r\n\r\n                // set custom query from options\r\n                Plugin.setDataSourceQuery(Plugin.getOption('data.source.read.params.query'));\r\n\r\n                // on event after layout had done setup, show datatable\r\n                $(datatable).on('m-datatable--on-layout-updated', Plugin.afterRender);\r\n\r\n                if (datatable.debug) Plugin.stateRemove(Plugin.stateId);\r\n\r\n                // initialize extensions\r\n                $.each(Plugin.getOption('extensions'), function(extName, extOptions) {\r\n                    if (typeof $.fn.mDatatable[extName] === 'function')\r\n                        new $.fn.mDatatable[extName](datatable, extOptions);\r\n                });\r\n\r\n                // get data\r\n                if (options.data.type === 'remote' || options.data.type === 'local') {\r\n                    if (options.data.saveState === false ||\r\n                        options.data.saveState.cookie === false &&\r\n                        options.data.saveState.webstorage === false) {\r\n                        Plugin.stateRemove(Plugin.stateId);\r\n                    }\r\n                    // get data for local datatable and local table\r\n                    if (options.data.type === 'local' && typeof options.data.source === 'object') {\r\n                        datatable.dataSet = datatable.originalDataSet = Plugin.dataMapCallback(options.data.source);\r\n                    }\r\n                    Plugin.dataRender();\r\n                }\r\n\r\n                if (!isHtmlTable) {\r\n                    // if not a html table, setup header\r\n                    Plugin.setHeadTitle();\r\n                    if (Plugin.getOption('layout.footer')) {\r\n                        Plugin.setHeadTitle(datatable.tableFoot);\r\n                    }\r\n                }\r\n\r\n                // hide header\r\n                if (typeof options.layout.header !== 'undefined' &&\r\n                    options.layout.header === false) {\r\n                    $(datatable.table).find('thead').remove();\r\n                }\r\n\r\n                // hide footer\r\n                if (typeof options.layout.footer !== 'undefined' &&\r\n                    options.layout.footer === false) {\r\n                    $(datatable.table).find('tfoot').remove();\r\n                }\r\n\r\n                // for normal and local data type, run layoutUpdate\r\n                if (options.data.type === null ||\r\n                    options.data.type === 'local') {\r\n                    Plugin.setupCellField.call();\r\n                    Plugin.setupTemplateCell.call();\r\n\r\n                    // setup nested datatable, if option enabled\r\n                    Plugin.setupSubDatatable.call();\r\n\r\n                    // setup extra system column properties\r\n                    Plugin.setupSystemColumn.call();\r\n                    Plugin.redraw();\r\n                }\r\n\r\n                $(window).resize(Plugin.fullRender);\r\n\r\n                $(datatable).height('');\r\n\r\n                $(Plugin.getOption('search.input')).on('keyup', function(e) {\r\n                    if (Plugin.getOption('search.onEnter') && e.which !== 13) return;\r\n                    Plugin.search($(this).val());\r\n                });\r\n\r\n                return datatable;\r\n            },\r\n\r\n            /**\r\n             * Extract static HTML table content into datasource\r\n             */\r\n            extractTable: function() {\r\n                var columns = [];\r\n                var headers = $(datatable).find('tr:first-child th').get().map(function(cell, i) {\r\n                    var field = $(cell).data('field');\r\n                    if (typeof field === 'undefined') {\r\n                        field = $(cell).text().trim();\r\n                    }\r\n                    var column = { field: field, title: field };\r\n                    for (var ii in options.columns) {\r\n                        if (options.columns[ii].field === field) {\r\n                            column = $.extend(true, {}, options.columns[ii], column);\r\n                        }\r\n                    }\r\n                    columns.push(column);\r\n                    return field;\r\n                });\r\n                // auto create columns config\r\n                options.columns = columns;\r\n\r\n                var rowProp = [];\r\n                var source = [];\r\n\r\n                $(datatable).find('tr').each(function() {\r\n                    if ($(this).find('td').length) {\r\n                        rowProp.push($(this).prop('attributes'));\r\n                    }\r\n                    var td = {};\r\n                    $(this).find('td').each(function(i, cell) {\r\n\r\n                        td[headers[i]] = cell.innerHTML.trim();\r\n                    });\r\n                    if (!mUtil.isEmpty(td)) {\r\n                        source.push(td);\r\n                    }\r\n                });\r\n\r\n                options.data.attr.rowProps = rowProp;\r\n                options.data.source = source;\r\n            },\r\n\r\n            /**\r\n             * One time layout update on init\r\n             */\r\n            layoutUpdate: function() {\r\n                // setup nested datatable, if option enabled\r\n                Plugin.setupSubDatatable.call();\r\n\r\n                // setup extra system column properties\r\n                Plugin.setupSystemColumn.call();\r\n\r\n                // setup cell hover event\r\n                Plugin.setupHover.call();\r\n\r\n                if (typeof options.detail === 'undefined'\r\n                    // temporary disable lock column in subtable\r\n                    &&\r\n                    Plugin.getDepth() === 1) {\r\n                    // lock columns handler\r\n                    Plugin.lockTable.call();\r\n                }\r\n\r\n                Plugin.columnHide.call();\r\n\r\n                Plugin.resetScroll();\r\n\r\n                if (!Plugin.isInit) {\r\n                    $(datatable).trigger('m-datatable--on-init', { table: $(datatable.wrap).attr('id'), options: options });\r\n                    Plugin.isInit = true;\r\n                }\r\n\r\n                $(datatable).trigger('m-datatable--on-layout-updated', { table: $(datatable.wrap).attr('id') });\r\n            },\r\n\r\n            lockTable: function() {\r\n                // todo; revise lock table responsive\r\n                var lock = {\r\n                    lockEnabled: false,\r\n                    init: function() {\r\n                        // check if table should be locked columns\r\n                        lock.lockEnabled = Plugin.lockEnabledColumns();\r\n                        if (lock.lockEnabled.left.length === 0 &&\r\n                            lock.lockEnabled.right.length === 0) {\r\n                            return;\r\n                        }\r\n                        lock.enable();\r\n                    },\r\n                    enable: function() {\r\n                        var enableLock = function(tablePart) {\r\n                            // check if already has lock column\r\n                            if ($(tablePart).find('.m-datatable__lock').length > 0) {\r\n                                Plugin.log('Locked container already exist in: ', tablePart);\r\n                                return;\r\n                            }\r\n                            // check if no rows exists\r\n                            if ($(tablePart).find('.m-datatable__row').length === 0) {\r\n                                Plugin.log('No row exist in: ', tablePart);\r\n                                return;\r\n                            }\r\n\r\n                            // locked div container\r\n                            var lockLeft = $('<div/>').addClass('m-datatable__lock m-datatable__lock--left');\r\n                            var lockScroll = $('<div/>').addClass('m-datatable__lock m-datatable__lock--scroll');\r\n                            var lockRight = $('<div/>').addClass('m-datatable__lock m-datatable__lock--right');\r\n\r\n                            $(tablePart).find('.m-datatable__row').each(function() {\r\n                                var rowLeft = $('<tr/>').addClass('m-datatable__row').appendTo(lockLeft);\r\n                                var rowScroll = $('<tr/>').addClass('m-datatable__row').appendTo(lockScroll);\r\n                                var rowRight = $('<tr/>').addClass('m-datatable__row').appendTo(lockRight);\r\n                                $(this).find('.m-datatable__cell').each(function() {\r\n                                    var locked = $(this).data('locked');\r\n                                    if (typeof locked !== 'undefined') {\r\n                                        if (typeof locked.left !== 'undefined' || locked === true) {\r\n                                            // default locked to left\r\n                                            $(this).appendTo(rowLeft);\r\n                                        }\r\n                                        if (typeof locked.right !== 'undefined') {\r\n                                            $(this).appendTo(rowRight);\r\n                                        }\r\n                                    } else {\r\n                                        $(this).appendTo(rowScroll);\r\n                                    }\r\n                                });\r\n                                // remove old row\r\n                                $(this).remove();\r\n                            });\r\n\r\n                            if (lock.lockEnabled.left.length > 0) {\r\n                                $(datatable.wrap).addClass('m-datatable--lock');\r\n                                $(lockLeft).appendTo(tablePart);\r\n                            }\r\n                            if (lock.lockEnabled.left.length > 0 || lock.lockEnabled.right.length > 0) {\r\n                                $(lockScroll).appendTo(tablePart);\r\n                            }\r\n                            if (lock.lockEnabled.right.length > 0) {\r\n                                $(datatable.wrap).addClass('m-datatable--lock');\r\n                                $(lockRight).appendTo(tablePart);\r\n                            }\r\n                        };\r\n\r\n                        $(datatable.table).find('thead,tbody,tfoot').each(function() {\r\n                            var tablePart = this;\r\n                            if ($(this).find('.m-datatable__lock').length === 0) {\r\n                                $(this).ready(function() {\r\n                                    enableLock(tablePart);\r\n                                });\r\n                            }\r\n                        });\r\n                    },\r\n                };\r\n                lock.init();\r\n                return lock;\r\n            },\r\n\r\n            /**\r\n             * Render everything for resize\r\n             */\r\n            fullRender: function() {\r\n                if (Plugin.isLocked()) {\r\n\r\n                    $(datatable.tableHead).empty();\r\n                    Plugin.setHeadTitle();\r\n                    if (Plugin.getOption('layout.footer')) {\r\n                        $(datatable.tableFoot).empty();\r\n                        Plugin.setHeadTitle(datatable.tableFoot);\r\n                    }\r\n\r\n                    // todo; full render datatable for specific condition only\r\n                    Plugin.spinnerCallback(true);\r\n                    $(datatable.wrap).removeClass('m-datatable--loaded');\r\n\r\n                    Plugin.insertData();\r\n                }\r\n            },\r\n\r\n            lockEnabledColumns: function() {\r\n                var screen = $(window).width();\r\n                var columns = options.columns;\r\n                var enabled = { left: [], right: [] };\r\n                $.each(columns, function(i, column) {\r\n                    if (typeof column.locked !== 'undefined') {\r\n                        if (typeof column.locked.left !== 'undefined') {\r\n                            if (mUtil.getBreakpoint(column.locked.left) <= screen) {\r\n                                enabled['left'].push(column.locked.left);\r\n                            }\r\n                        }\r\n                        if (typeof column.locked.right !== 'undefined') {\r\n                            if (mUtil.getBreakpoint(column.locked.right) <= screen) {\r\n                                enabled['right'].push(column.locked.right);\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n                return enabled;\r\n            },\r\n\r\n            /**\r\n             * After render event, called by m-datatable--on-layout-updated\r\n             * @param e\r\n             * @param args\r\n             */\r\n            afterRender: function(e, args) {\r\n                if (args.table == $(datatable.wrap).attr('id')) {\r\n                    $(datatable).ready(function() {\r\n                        if (!Plugin.isLocked()) {\r\n                            Plugin.redraw();\r\n                            // work on non locked columns\r\n                            if (Plugin.getOption('rows.autoHide')) {\r\n                                Plugin.autoHide();\r\n                                // reset row\r\n                                $(datatable.table).find('.m-datatable__row').css('height', '');\r\n                            }\r\n                        }\r\n\r\n                        Plugin.rowEvenOdd.call();\r\n\r\n                        // redraw locked columns table\r\n                        if (Plugin.isLocked()) Plugin.redraw();\r\n                        $(datatable.tableBody).css('visibility', '');\r\n                        $(datatable.wrap).addClass('m-datatable--loaded');\r\n\r\n                        Plugin.sorting.call();\r\n                        Plugin.scrollbar.call();\r\n\r\n                        // Plugin.hoverColumn.call();\r\n                        Plugin.spinnerCallback(false);\r\n                    });\r\n                }\r\n            },\r\n\r\n            hoverTimer: 0,\r\n            isScrolling: false,\r\n            setupHover: function() {\r\n                $(window).scroll(function(e) {\r\n                    // stop hover when scrolling\r\n                    clearTimeout(Plugin.hoverTimer);\r\n                    Plugin.isScrolling = true;\r\n                });\r\n\r\n                $(datatable.tableBody).find('.m-datatable__cell').off('mouseenter', 'mouseleave').on('mouseenter', function() {\r\n                    // reset scroll timer to hover class\r\n                    Plugin.hoverTimer = setTimeout(function() {\r\n                        Plugin.isScrolling = false;\r\n                    }, 200);\r\n                    if (Plugin.isScrolling) return;\r\n\r\n                    // normal table\r\n                    var row = $(this).closest('.m-datatable__row').addClass('m-datatable__row--hover');\r\n                    var index = $(row).index() + 1;\r\n\r\n                    // lock table\r\n                    $(row).closest('.m-datatable__lock').parent().find('.m-datatable__row:nth-child(' + index + ')').addClass('m-datatable__row--hover');\r\n                }).on('mouseleave', function() {\r\n                    // normal table\r\n                    var row = $(this).closest('.m-datatable__row').removeClass('m-datatable__row--hover');\r\n                    var index = $(row).index() + 1;\r\n\r\n                    // look table\r\n                    $(row).closest('.m-datatable__lock').parent().find('.m-datatable__row:nth-child(' + index + ')').removeClass('m-datatable__row--hover');\r\n                });\r\n            },\r\n\r\n            /**\r\n             * Adjust width of locked table containers by resize handler\r\n             * @returns {number}\r\n             */\r\n            adjustLockContainer: function() {\r\n                if (!Plugin.isLocked()) return 0;\r\n\r\n                // refer to head dimension\r\n                var containerWidth = $(datatable.tableHead).width();\r\n                var lockLeft = $(datatable.tableHead).find('.m-datatable__lock--left').width();\r\n                var lockRight = $(datatable.tableHead).find('.m-datatable__lock--right').width();\r\n\r\n                if (typeof lockLeft === 'undefined') lockLeft = 0;\r\n                if (typeof lockRight === 'undefined') lockRight = 0;\r\n\r\n                var lockScroll = Math.floor(containerWidth - lockLeft - lockRight);\r\n                $(datatable.table).find('.m-datatable__lock--scroll').css('width', lockScroll);\r\n\r\n                return lockScroll;\r\n            },\r\n\r\n            /**\r\n             * todo; not in use\r\n             */\r\n            dragResize: function() {\r\n                var pressed = false;\r\n                var start = undefined;\r\n                var startX, startWidth;\r\n                $(datatable.tableHead).find('.m-datatable__cell').mousedown(function(e) {\r\n                    start = $(this);\r\n                    pressed = true;\r\n                    startX = e.pageX;\r\n                    startWidth = $(this).width();\r\n                    $(start).addClass('m-datatable__cell--resizing');\r\n\r\n                }).mousemove(function(e) {\r\n                    if (pressed) {\r\n                        var i = $(start).index();\r\n                        var tableBody = $(datatable.tableBody);\r\n                        var ifLocked = $(start).closest('.m-datatable__lock');\r\n\r\n                        if (ifLocked) {\r\n                            var lockedIndex = $(ifLocked).index();\r\n                            tableBody = $(datatable.tableBody).find('.m-datatable__lock').eq(lockedIndex);\r\n                        }\r\n\r\n                        $(tableBody).find('.m-datatable__row').each(function(tri, tr) {\r\n                            $(tr).find('.m-datatable__cell').eq(i).width(startWidth + (e.pageX - startX)).children().width(startWidth + (e.pageX - startX));\r\n                        });\r\n\r\n                        $(start).children().css('width', startWidth + (e.pageX - startX));\r\n                    }\r\n\r\n                }).mouseup(function() {\r\n                    $(start).removeClass('m-datatable__cell--resizing');\r\n                    pressed = false;\r\n                });\r\n\r\n                $(document).mouseup(function() {\r\n                    $(start).removeClass('m-datatable__cell--resizing');\r\n                    pressed = false;\r\n                });\r\n            },\r\n\r\n            /**\r\n             * To prepare placeholder for table before content is loading\r\n             */\r\n            initHeight: function() {\r\n                if (options.layout.height && options.layout.scroll) {\r\n                    var theadHeight = $(datatable.tableHead).find('.m-datatable__row').height();\r\n                    var tfootHeight = $(datatable.tableFoot).find('.m-datatable__row').height();\r\n                    var bodyHeight = options.layout.height;\r\n                    if (theadHeight > 0) {\r\n                        bodyHeight -= theadHeight;\r\n                    }\r\n                    if (tfootHeight > 0) {\r\n                        bodyHeight -= tfootHeight;\r\n                    }\r\n                    $(datatable.tableBody).css('max-height', bodyHeight);\r\n\r\n                    // set scrollable area fixed height\r\n                    $(datatable.tableBody).find('.m-datatable__lock--scroll').css('height', bodyHeight);\r\n                }\r\n            },\r\n\r\n            /**\r\n             * Setup base DOM (table, thead, tbody, tfoot) and create if not exist.\r\n             */\r\n            setupBaseDOM: function() {\r\n                // keep original state before mDatatable initialize\r\n                datatable.initialDatatable = $(datatable).clone();\r\n\r\n                // main element\r\n                if ($(datatable).prop('tagName') === 'TABLE') {\r\n                    // if main init element is <table>, wrap with div\r\n                    datatable.table = $(datatable).removeClass('m-datatable').addClass('m-datatable__table');\r\n                    if ($(datatable.table).parents('.m-datatable').length === 0) {\r\n                        datatable.table.wrap($('<div/>').addClass('m-datatable').addClass('m-datatable--' + options.layout.theme));\r\n                        datatable.wrap = $(datatable.table).parent();\r\n                    }\r\n                } else {\r\n                    // create table\r\n                    datatable.wrap = $(datatable).addClass('m-datatable').addClass('m-datatable--' + options.layout.theme);\r\n                    datatable.table = $('<table/>').addClass('m-datatable__table').appendTo(datatable);\r\n                }\r\n\r\n                if (typeof options.layout.class !== 'undefined') {\r\n                    $(datatable.wrap).addClass(options.layout.class);\r\n                }\r\n\r\n                $(datatable.table).removeClass('m-datatable--destroyed').css('display', 'block');\r\n\r\n                // force disable save state\r\n                if (typeof $(datatable).attr('id') === 'undefined') {\r\n                    Plugin.setOption('data.saveState', false);\r\n                    $(datatable.table).attr('id', mUtil.getUniqueID('m-datatable--'));\r\n                }\r\n\r\n                // predefine table height\r\n                if (Plugin.getOption('layout.minHeight'))\r\n                    $(datatable.table).css('min-height', Plugin.getOption('layout.minHeight'));\r\n\r\n                if (Plugin.getOption('layout.height'))\r\n                    $(datatable.table).css('max-height', Plugin.getOption('layout.height'));\r\n\r\n                // for normal table load\r\n                if (options.data.type === null) {\r\n                    $(datatable.table).css('width', '').css('display', '');\r\n                }\r\n\r\n                // create table head element\r\n                datatable.tableHead = $(datatable.table).find('thead');\r\n                if ($(datatable.tableHead).length === 0) {\r\n                    datatable.tableHead = $('<thead/>').prependTo(datatable.table);\r\n                }\r\n\r\n                // create table head element\r\n                datatable.tableBody = $(datatable.table).find('tbody');\r\n                if ($(datatable.tableBody).length === 0) {\r\n                    datatable.tableBody = $('<tbody/>').appendTo(datatable.table);\r\n                }\r\n\r\n                if (typeof options.layout.footer !== 'undefined' &&\r\n                    options.layout.footer) {\r\n                    // create table foot element\r\n                    datatable.tableFoot = $(datatable.table).find('tfoot');\r\n                    if ($(datatable.tableFoot).length === 0) {\r\n                        datatable.tableFoot = $('<tfoot/>').appendTo(datatable.table);\r\n                    }\r\n                }\r\n            },\r\n\r\n            /**\r\n             * Set column data before table manipulation.\r\n             */\r\n            setupCellField: function(tableParts) {\r\n                if (typeof tableParts === 'undefined') tableParts = $(datatable.table).children();\r\n                var columns = options.columns;\r\n                $.each(tableParts, function(part, tablePart) {\r\n                    $(tablePart).find('.m-datatable__row').each(function(tri, tr) {\r\n                        // prepare data\r\n                        $(tr).find('.m-datatable__cell').each(function(tdi, td) {\r\n                            if (typeof columns[tdi] !== 'undefined') {\r\n                                $(td).data(columns[tdi]);\r\n                            }\r\n                        });\r\n                    });\r\n                });\r\n            },\r\n\r\n            /**\r\n             * Set column template callback\r\n             * @param tablePart\r\n             */\r\n            setupTemplateCell: function(tablePart) {\r\n                if (typeof tablePart === 'undefined') tablePart = datatable.tableBody;\r\n                var columns = options.columns;\r\n                $(tablePart).find('.m-datatable__row').each(function(tri, tr) {\r\n                    // row data object, if any\r\n                    var obj = $(tr).data('obj') || {};\r\n\r\n                    // @deprecated in v5.0.6\r\n                    // obj['getIndex'] = function() {\r\n                    // \treturn tri;\r\n                    // };\r\n                    // @deprecated in v5.0.6\r\n                    // obj['getDatatable'] = function() {\r\n                    // \treturn datatable;\r\n                    // };\r\n\r\n                    // @deprecated in v5.0.6\r\n                    var rowCallback = Plugin.getOption('rows.callback');\r\n                    if (typeof rowCallback === 'function') {\r\n                        rowCallback($(tr), obj, tri);\r\n                    }\r\n                    // before template row callback\r\n                    var beforeTemplate = Plugin.getOption('rows.beforeTemplate');\r\n                    if (typeof beforeTemplate === 'function') {\r\n                        beforeTemplate($(tr), obj, tri);\r\n                    }\r\n                    // if data object is undefined, collect from table\r\n                    if (typeof obj === 'undefined') {\r\n                        obj = {};\r\n                        $(tr).find('.m-datatable__cell').each(function(tdi, td) {\r\n                            // get column settings by field\r\n                            var column = $.grep(columns, function(n, i) {\r\n                                return $(td).data('field') === n.field;\r\n                            })[0];\r\n                            if (typeof column !== 'undefined') {\r\n                                obj[column['field']] = $(td).text();\r\n                            }\r\n                        });\r\n                    }\r\n\r\n                    $(tr).find('.m-datatable__cell').each(function(tdi, td) {\r\n                        // get column settings by field\r\n                        var column = $.grep(columns, function(n, i) {\r\n                            return $(td).data('field') === n.field;\r\n                        })[0];\r\n                        if (typeof column !== 'undefined') {\r\n                            // column template\r\n                            if (typeof column.template !== 'undefined') {\r\n                                var finalValue = '';\r\n                                // template string\r\n                                if (typeof column.template === 'string') {\r\n                                    finalValue = Plugin.dataPlaceholder(column.template, obj);\r\n                                }\r\n                                // template callback function\r\n                                if (typeof column.template === 'function') {\r\n                                    finalValue = column.template(obj, tri, datatable);\r\n                                }\r\n                                var span = document.createElement('span');\r\n                                span.innerHTML = finalValue;\r\n                                // insert to cell, wrap with span\r\n                                $(td).html(span);\r\n\r\n                                // set span overflow\r\n                                if (typeof column.overflow !== 'undefined') {\r\n                                    $(span).css('overflow', column.overflow);\r\n                                    $(span).css('position', 'relative');\r\n                                }\r\n                            }\r\n                        }\r\n                    });\r\n\r\n                    // after template row callback\r\n                    var afterTemplate = Plugin.getOption('rows.afterTemplate');\r\n                    if (typeof afterTemplate === 'function') {\r\n                        afterTemplate($(tr), obj, tri);\r\n                    }\r\n                });\r\n            },\r\n\r\n            /**\r\n             * Setup extra system column properties\r\n             * Note: selector checkbox, subtable toggle\r\n             */\r\n            setupSystemColumn: function() {\r\n                datatable.dataSet = datatable.dataSet || [];\r\n                // no records available\r\n                if (datatable.dataSet.length === 0) return;\r\n\r\n                var columns = options.columns;\r\n                $(datatable.tableBody).find('.m-datatable__row').each(function(tri, tr) {\r\n                    $(tr).find('.m-datatable__cell').each(function(tdi, td) {\r\n                        // get column settings by field\r\n                        var column = $.grep(columns, function(n, i) {\r\n                            return $(td).data('field') === n.field;\r\n                        })[0];\r\n                        if (typeof column !== 'undefined') {\r\n                            var value = $(td).text();\r\n\r\n                            // enable column selector\r\n                            if (typeof column.selector !== 'undefined' &&\r\n                                column.selector !== false) {\r\n                                // check if checkbox exist\r\n                                if ($(td).find('.m-checkbox [type=\"checkbox\"]').length > 0) return;\r\n                                $(td).addClass('m-datatable__cell--check');\r\n                                // append checkbox\r\n                                var chk = $('<label/>').addClass('m-checkbox m-checkbox--single').append($('<input/>').attr('type', 'checkbox').attr('value', value).on('click', function() {\r\n                                    if ($(this).is(':checked')) {\r\n                                        // add checkbox active row class\r\n                                        Plugin.setActive(this);\r\n                                    } else {\r\n                                        // add checkbox active row class\r\n                                        Plugin.setInactive(this);\r\n                                    }\r\n                                })).append($('<span/>'));\r\n\r\n                                // checkbox selector has outline style\r\n                                if (typeof column.selector.class !== 'undefined') {\r\n                                    $(chk).addClass(column.selector.class);\r\n                                }\r\n\r\n                                $(td).children().html(chk);\r\n                            }\r\n\r\n                            // enable column subtable toggle\r\n                            if (typeof column.subtable !== 'undefined' && column.subtable) {\r\n                                // check if subtable toggle exist\r\n                                if ($(td).find('.m-datatable__toggle-subtable').length > 0) return;\r\n                                // append subtable toggle\r\n                                $(td).children().html($('<a/>').addClass('m-datatable__toggle-subtable').attr('href', '#').attr('data-value', value).append($('<i/>').addClass(Plugin.getOption('layout.icons.rowDetail.collapse'))));\r\n                            }\r\n                        }\r\n                    });\r\n                });\r\n\r\n                // init checkbox for header/footer\r\n                var initCheckbox = function(tr) {\r\n                    // get column settings by field\r\n                    var column = $.grep(columns, function(n, i) {\r\n                        return typeof n.selector !== 'undefined' && n.selector !== false;\r\n                    })[0];\r\n\r\n                    if (typeof column !== 'undefined') {\r\n                        // enable column selector\r\n                        if (typeof column.selector !== 'undefined' && column.selector !== false) {\r\n                            var td = $(tr).find('[data-field=\"' + column.field + '\"]');\r\n                            // check if checkbox exist\r\n                            if ($(td).find('.m-checkbox [type=\"checkbox\"]').length > 0) return;\r\n                            $(td).addClass('m-datatable__cell--check');\r\n\r\n                            // todo; check all, for server pagination\r\n                            // append checkbox\r\n                            var chk = $('<label/>').addClass('m-checkbox m-checkbox--single m-checkbox--all').append($('<input/>').attr('type', 'checkbox').on('click', function() {\r\n                                if ($(this).is(':checked')) {\r\n                                    Plugin.setActiveAll(true);\r\n                                } else {\r\n                                    Plugin.setActiveAll(false);\r\n                                }\r\n                            })).append($('<span/>'));\r\n\r\n                            // checkbox selector has outline style\r\n                            if (typeof column.selector.class !== 'undefined') {\r\n                                $(chk).addClass(column.selector.class);\r\n                            }\r\n\r\n                            $(td).children().html(chk);\r\n                        }\r\n                    }\r\n                };\r\n\r\n                if (options.layout.header) {\r\n                    initCheckbox($(datatable.tableHead).find('.m-datatable__row').first());\r\n                }\r\n                if (options.layout.footer) {\r\n                    initCheckbox($(datatable.tableFoot).find('.m-datatable__row').first());\r\n                }\r\n            },\r\n\r\n            /**\r\n             * Adjust width to match container size\r\n             */\r\n            adjustCellsWidth: function() {\r\n                // get table width\r\n                var containerWidth = $(datatable.tableHead).width();\r\n\r\n                // offset reserved for sort icon\r\n                var sortOffset = 20;\r\n\r\n                // get total number of columns\r\n                var columns = $(datatable.tableHead).find('.m-datatable__row:first-child').find('.m-datatable__cell:visible').length;\r\n                if (columns > 0) {\r\n                    //  remove reserved sort icon width\r\n                    containerWidth = containerWidth - (sortOffset * columns);\r\n                    var minWidth = Math.floor(containerWidth / columns);\r\n\r\n                    // minimum width\r\n                    if (minWidth <= Plugin.offset) {\r\n                        minWidth = Plugin.offset;\r\n                    }\r\n\r\n                    $(datatable.table).find('.m-datatable__row').find('.m-datatable__cell:visible').each(function(tdi, td) {\r\n                        var width = minWidth;\r\n                        var dataWidth = $(td).data('width');\r\n                        if (typeof dataWidth !== 'undefined') {\r\n                            width = dataWidth;\r\n                        }\r\n                        $(td).children().css('width', parseInt(width));\r\n                    });\r\n                }\r\n\r\n                return datatable;\r\n            },\r\n\r\n            /**\r\n             * Adjust height to match container size\r\n             */\r\n            adjustCellsHeight: function() {\r\n                $.each($(datatable.table).children(), function(part, tablePart) {\r\n                    var totalRows = $(tablePart).find('.m-datatable__row').first().parent().find('.m-datatable__row').length;\r\n                    for (var i = 1; i <= totalRows; i++) {\r\n                        var rows = $(tablePart).find('.m-datatable__row:nth-child(' + i + ')');\r\n                        if ($(rows).length > 0) {\r\n                            var maxHeight = Math.max.apply(null, $(rows).map(function() {\r\n                                return $(this).height();\r\n                            }).get());\r\n                            $(rows).css('height', Math.ceil(parseInt(maxHeight)));\r\n                        }\r\n                    }\r\n                });\r\n            },\r\n\r\n            /**\r\n             * Setup table DOM and classes\r\n             */\r\n            setupDOM: function(table) {\r\n                // set table classes\r\n                $(table).find('> thead').addClass('m-datatable__head');\r\n                $(table).find('> tbody').addClass('m-datatable__body');\r\n                $(table).find('> tfoot').addClass('m-datatable__foot');\r\n                $(table).find('tr').addClass('m-datatable__row');\r\n                $(table).find('tr > th, tr > td').addClass('m-datatable__cell');\r\n                $(table).find('tr > th, tr > td').each(function(i, td) {\r\n                    if ($(td).find('span').length === 0) {\r\n                        $(td).wrapInner($('<span/>').css('width', Plugin.offset));\r\n                    }\r\n                });\r\n            },\r\n\r\n            /**\r\n             * Default scrollbar\r\n             * @returns {{tableLocked: null, init: init, onScrolling: onScrolling}}\r\n             */\r\n            scrollbar: function() {\r\n                var scroll = {\r\n                    scrollable: null,\r\n                    tableLocked: null,\r\n                    mcsOptions: {\r\n                        scrollInertia: 0,\r\n                        autoDraggerLength: true,\r\n                        autoHideScrollbar: true,\r\n                        autoExpandScrollbar: false,\r\n                        alwaysShowScrollbar: 0,\r\n                        mouseWheel: {\r\n                            scrollAmount: 120,\r\n                            preventDefault: false,\r\n                        },\r\n                        advanced: {\r\n                            updateOnContentResize: true,\r\n                            autoExpandHorizontalScroll: true,\r\n                        },\r\n                        theme: 'minimal-dark',\r\n                    },\r\n                    init: function() {\r\n                        if (mUtil.isRTL()) {\r\n                            $.fn.extend({\r\n                                scrollRight: function(val) {\r\n                                    if (val === undefined) {\r\n                                        return this[0].scrollWidth - (this[0].scrollLeft + this[0].clientWidth) + 1;\r\n                                    }\r\n                                    return this.scrollLeft(this[0].scrollWidth - this[0].clientWidth - val);\r\n                                }\r\n                            });\r\n                        }\r\n\r\n                        var screen = mUtil.getViewPort().width;\r\n                        // setup scrollable datatable\r\n                        if (options.layout.scroll) {\r\n                            // add scrollable datatable class\r\n                            $(datatable.wrap).addClass('m-datatable--scroll');\r\n\r\n                            var scrollable = $(datatable.tableBody).find('.m-datatable__lock--scroll');\r\n\r\n                            // check if scrollable area have rows\r\n                            if ($(scrollable).find('.m-datatable__row').length > 0 && $(scrollable).length > 0) {\r\n                                scroll.scrollHead = $(datatable.tableHead).find('> .m-datatable__lock--scroll > .m-datatable__row');\r\n                                scroll.scrollFoot = $(datatable.tableFoot).find('> .m-datatable__lock--scroll > .m-datatable__row');\r\n                                scroll.tableLocked = $(datatable.tableBody).find('.m-datatable__lock:not(.m-datatable__lock--scroll)');\r\n                                if (Plugin.getOption('layout.customScrollbar') && mUtil.detectIE() != 10 && screen > mUtil.getBreakpoint('lg')) {\r\n                                    scroll.initCustomScrollbar(scrollable[0]);\r\n                                } else {\r\n                                    scroll.initDefaultScrollbar(scrollable);\r\n                                }\r\n                            } else if ($(datatable.tableBody).find('.m-datatable__row').length > 0) {\r\n                                scroll.scrollHead = $(datatable.tableHead).find('> .m-datatable__row');\r\n                                scroll.scrollFoot = $(datatable.tableFoot).find('> .m-datatable__row');\r\n                                if (Plugin.getOption('layout.customScrollbar') && mUtil.detectIE() != 10 && screen > mUtil.getBreakpoint('lg')) {\r\n                                    scroll.initCustomScrollbar(datatable.tableBody);\r\n                                } else {\r\n                                    scroll.initDefaultScrollbar(datatable.tableBody);\r\n                                }\r\n                            }\r\n                        } else {\r\n                            $(datatable.table). // css('height', 'auto').\r\n                            css('overflow-x', 'auto');\r\n                        }\r\n                    },\r\n                    initDefaultScrollbar: function(scrollable) {\r\n                        $(scrollable).css('overflow', 'auto').off().on('scroll', scroll.onScrolling);\r\n                    },\r\n                    onScrolling: function(e) {\r\n                        var top = $(this).scrollTop();\r\n                        if (mUtil.isRTL()) {\r\n                            var right = $(this).scrollRight();\r\n                            $(scroll.scrollHead).css('right', -right);\r\n                            $(scroll.scrollFoot).css('right', -right);\r\n                        } else {\r\n                            var left = $(this).scrollLeft();\r\n                            $(scroll.scrollHead).css('left', -left);\r\n                            $(scroll.scrollFoot).css('left', -left);\r\n                        }\r\n                        $(scroll.tableLocked).each(function(i, table) {\r\n                            $(table).css('top', -top);\r\n                        });\r\n                    },\r\n                    initCustomScrollbar: function(scrollable) {\r\n                        scroll.scrollable = scrollable;\r\n                        // create a new instance for table body with scrollbar\r\n                        Plugin.initScrollbar(scrollable);\r\n                        $(scrollable).off().on('scroll', scroll.onScrolling);\r\n                    },\r\n                };\r\n                scroll.init();\r\n                return scroll;\r\n            },\r\n\r\n            /**\r\n             * Init custom scrollbar and reset position\r\n             * @param element\r\n             * @param options\r\n             */\r\n            initScrollbar: function(element, options) {\r\n                $(datatable.tableBody).css('overflow', '');\r\n                if (mUtil.hasClass(element, 'ps')) {\r\n                    $(element).data('ps').update();\r\n                } else {\r\n                    var ps = new PerfectScrollbar(element);\r\n                    $(element).data('ps', ps);\r\n                }\r\n            },\r\n\r\n            /**\r\n             * Set column title from options.columns settings\r\n             */\r\n            setHeadTitle: function(tablePart) {\r\n                if (typeof tablePart === 'undefined') tablePart = datatable.tableHead;\r\n                tablePart = $(tablePart)[0];\r\n                var columns = options.columns;\r\n                var row = tablePart.getElementsByTagName('tr')[0];\r\n                var ths = tablePart.getElementsByTagName('td');\r\n\r\n                if (typeof row === 'undefined') {\r\n                    row = document.createElement('tr');\r\n                    tablePart.appendChild(row);\r\n                }\r\n\r\n                $.each(columns, function(i, column) {\r\n                    var th = ths[i];\r\n                    if (typeof th === 'undefined') {\r\n                        th = document.createElement('th');\r\n                        row.appendChild(th);\r\n                    }\r\n\r\n                    // set column title\r\n                    if (typeof column['title'] !== 'undefined') {\r\n                        th.innerHTML = column.title;\r\n                        th.setAttribute('data-field', column.field);\r\n                        mUtil.addClass(th, column.class);\r\n                        $(th).data(column);\r\n                    }\r\n\r\n                    // set header attr option\r\n                    if (typeof column.attr !== 'undefined') {\r\n                        $.each(column.attr, function(key, val) {\r\n                            th.setAttribute(key, val);\r\n                        });\r\n                    }\r\n\r\n                    // apply text align to thead/tfoot\r\n                    if (typeof column.textAlign !== 'undefined') {\r\n                        var align = typeof datatable.textAlign[column.textAlign] !== 'undefined' ? datatable.textAlign[column.textAlign] : '';\r\n                        mUtil.addClass(th, align);\r\n                    }\r\n                });\r\n                Plugin.setupDOM(tablePart);\r\n            },\r\n\r\n            /**\r\n             * Initiate to get remote or local data via ajax\r\n             */\r\n            dataRender: function(action) {\r\n                $(datatable.table).siblings('.m-datatable__pager').removeClass('m-datatable--paging-loaded');\r\n\r\n                var buildMeta = function() {\r\n                    datatable.dataSet = datatable.dataSet || [];\r\n                    Plugin.localDataUpdate();\r\n                    // local pagination meta\r\n                    var meta = Plugin.getDataSourceParam('pagination');\r\n                    if (meta.perpage === 0) {\r\n                        meta.perpage = options.data.pageSize || 10;\r\n                    }\r\n                    meta.total = datatable.dataSet.length;\r\n                    var start = Math.max(meta.perpage * (meta.page - 1), 0);\r\n                    var end = Math.min(start + meta.perpage, meta.total);\r\n                    datatable.dataSet = $(datatable.dataSet).slice(start, end);\r\n                    return meta;\r\n                };\r\n\r\n                var afterGetData = function(result) {\r\n                    var localPagingCallback = function(ctx, meta) {\r\n                        if (!$(ctx.pager).hasClass('m-datatable--paging-loaded')) {\r\n                            $(ctx.pager).remove();\r\n                            ctx.init(meta);\r\n                        }\r\n                        $(ctx.pager).off().on('m-datatable--on-goto-page', function(e) {\r\n                            $(ctx.pager).remove();\r\n                            ctx.init(meta);\r\n                        });\r\n\r\n                        var start = Math.max(meta.perpage * (meta.page - 1), 0);\r\n                        var end = Math.min(start + meta.perpage, meta.total);\r\n\r\n                        Plugin.localDataUpdate();\r\n                        datatable.dataSet = $(datatable.dataSet).slice(start, end);\r\n\r\n                        // insert data into table content\r\n                        Plugin.insertData();\r\n                    };\r\n\r\n                    $(datatable.wrap).removeClass('m-datatable--error');\r\n                    // pagination enabled\r\n                    if (options.pagination) {\r\n                        if (options.data.serverPaging && options.data.type !== 'local') {\r\n                            // server pagination\r\n                            var serverMeta = Plugin.getObject('meta', result || null);\r\n                            if (serverMeta !== null) {\r\n                                Plugin.paging(serverMeta);\r\n                            } else {\r\n                                // no meta object from server response, fallback to local pagination\r\n                                Plugin.paging(buildMeta(), localPagingCallback);\r\n                            }\r\n                        } else {\r\n                            // local pagination can be used by remote data also\r\n                            Plugin.paging(buildMeta(), localPagingCallback);\r\n                        }\r\n                    } else {\r\n                        // pagination is disabled\r\n                        Plugin.localDataUpdate();\r\n                    }\r\n                    // insert data into table content\r\n                    Plugin.insertData();\r\n                };\r\n\r\n                // get local datasource\r\n                if (options.data.type === 'local'\r\n                    // for remote json datasource\r\n                    // || typeof options.data.source.read === 'undefined' && datatable.dataSet !== null\r\n                    // for remote datasource, server sorting is disabled and data already received from remote\r\n                    ||\r\n                    options.data.serverSorting === false && action === 'sort' ||\r\n                    options.data.serverFiltering === false && action === 'search'\r\n                ) {\r\n                    afterGetData();\r\n                    return;\r\n                }\r\n\r\n                // getting data from remote only\r\n                Plugin.getData().done(afterGetData);\r\n            },\r\n\r\n            /**\r\n             * Process ajax data\r\n             */\r\n            insertData: function() {\r\n                datatable.dataSet = datatable.dataSet || [];\r\n                var params = Plugin.getDataSourceParam();\r\n\r\n                // get row attributes\r\n                var pagination = params.pagination;\r\n                var start = (Math.max(pagination.page, 1) - 1) * pagination.perpage;\r\n                var end = Math.min(pagination.page, pagination.pages) * pagination.perpage;\r\n                var rowProps = {};\r\n                if (typeof options.data.attr.rowProps !== 'undefined' && options.data.attr.rowProps.length) {\r\n                    rowProps = options.data.attr.rowProps.slice(start, end);\r\n                }\r\n\r\n                // todo; fix performance\r\n                var tableBody = document.createElement('tbody');\r\n                tableBody.style.visibility = 'hidden';\r\n                var colLength = options.columns.length;\r\n\r\n                $.each(datatable.dataSet, function(rowIndex, row) {\r\n                    var tr = document.createElement('tr');\r\n                    tr.setAttribute('data-row', rowIndex);\r\n                    // keep data object to row\r\n                    $(tr).data('obj', row);\r\n\r\n                    if (typeof rowProps[rowIndex] !== 'undefined') {\r\n                        $.each(rowProps[rowIndex], function() {\r\n                            tr.setAttribute(this.name, this.value);\r\n                        });\r\n                    }\r\n\r\n                    var cellIndex = 0;\r\n                    var tds = [];\r\n                    for (var a = 0; a < colLength; a += 1) {\r\n                        var column = options.columns[a];\r\n                        var classes = [];\r\n                        // add sorted class to cells\r\n                        if (Plugin.getObject('sort.field', params) === column.field) {\r\n                            classes.push('m-datatable__cell--sorted');\r\n                        }\r\n\r\n                        // apply text align\r\n                        if (typeof column.textAlign !== 'undefined') {\r\n                            var align = typeof datatable.textAlign[column.textAlign] !==\r\n                                'undefined' ? datatable.textAlign[column.textAlign] : '';\r\n                            classes.push(align);\r\n                        }\r\n\r\n                        // var classAttr = '';\r\n                        if (typeof column.class !== 'undefined') {\r\n                            classes.push(column.class);\r\n                        }\r\n\r\n                        var td = document.createElement('td');\r\n                        mUtil.addClass(td, classes.join(' '));\r\n                        td.setAttribute('data-field', column.field);\r\n                        td.innerHTML = Plugin.getObject(column.field, row);\r\n                        tr.appendChild(td);\r\n                    }\r\n\r\n                    tableBody.appendChild(tr);\r\n                });\r\n\r\n                // display no records message\r\n                if (datatable.dataSet.length === 0) {\r\n                    var errorSpan = document.createElement('span');\r\n                    mUtil.addClass(errorSpan, 'm-datatable--error');\r\n                    errorSpan.innerHTML = Plugin.getOption('translate.records.noRecords');\r\n                    tableBody.appendChild(errorSpan);\r\n                    $(datatable.wrap).addClass('m-datatable--error m-datatable--loaded');\r\n                    Plugin.spinnerCallback(false);\r\n                }\r\n\r\n                // replace existing table body\r\n                $(datatable.tableBody).replaceWith(tableBody);\r\n                datatable.tableBody = tableBody;\r\n\r\n                // layout update\r\n                Plugin.setupDOM(datatable.table);\r\n                Plugin.setupCellField([datatable.tableBody]);\r\n                Plugin.setupTemplateCell(datatable.tableBody);\r\n                Plugin.layoutUpdate();\r\n            },\r\n\r\n            updateTableComponents: function() {\r\n                datatable.tableHead = $(datatable.table).children('thead');\r\n                datatable.tableBody = $(datatable.table).children('tbody');\r\n                datatable.tableFoot = $(datatable.table).children('tfoot');\r\n            },\r\n\r\n            /**\r\n             * Call ajax for raw JSON data\r\n             */\r\n            getData: function() {\r\n                Plugin.spinnerCallback(true);\r\n\r\n                var ajaxParams = {\r\n                    dataType: 'json',\r\n                    method: 'GET',\r\n                    data: {},\r\n                    timeout: Plugin.getOption('data.source.read.timeout') || 30000,\r\n                };\r\n\r\n                if (options.data.type === 'local') {\r\n                    ajaxParams.url = options.data.source;\r\n                }\r\n\r\n                if (options.data.type === 'remote') {\r\n                    ajaxParams.url = Plugin.getOption('data.source.read.url');\r\n                    if (typeof ajaxParams.url !== 'string') ajaxParams.url = Plugin.getOption('data.source.read');\r\n                    if (typeof ajaxParams.url !== 'string') ajaxParams.url = Plugin.getOption('data.source');\r\n                    ajaxParams.headers = Plugin.getOption('data.source.read.headers');\r\n                    ajaxParams.method = Plugin.getOption('data.source.read.method') || 'POST';\r\n\r\n                    var data = Plugin.getDataSourceParam();\r\n                    // remove if server params is not enabled\r\n                    if (!Plugin.getOption('data.serverPaging')) {\r\n                        delete data['pagination'];\r\n                    }\r\n                    if (!Plugin.getOption('data.serverSorting')) {\r\n                        delete data['sort'];\r\n                    }\r\n                    ajaxParams.data = $.extend(true, ajaxParams.data, data, Plugin.getOption('data.source.read.params'));\r\n                }\r\n\r\n                return $.ajax(ajaxParams).done(function(response, textStatus, jqXHR) {\r\n                    datatable.lastResponse = response;\r\n                    // extendible data map callback for custom datasource\r\n                    datatable.dataSet = datatable.originalDataSet = Plugin.dataMapCallback(response);\r\n                    Plugin.setAutoColumns();\r\n                    $(datatable).trigger('m-datatable--on-ajax-done', [datatable.dataSet]);\r\n                }).fail(function(jqXHR, textStatus, errorThrown) {\r\n                    $(datatable).trigger('m-datatable--on-ajax-fail', [jqXHR]);\r\n                    $(datatable.tableBody).html($('<span/>').addClass('m-datatable--error').html(Plugin.getOption('translate.records.noRecords')));\r\n                    $(datatable.wrap).addClass('m-datatable--error m-datatable--loaded');\r\n                    Plugin.spinnerCallback(false);\r\n                }).always(function() {});\r\n            },\r\n\r\n            /**\r\n             * Pagination object\r\n             * @param meta if null, local pagination, otherwise remote pagination\r\n             * @param callback for update data when navigating page\r\n             */\r\n            paging: function(meta, callback) {\r\n                var pg = {\r\n                    meta: null,\r\n                    pager: null,\r\n                    paginateEvent: null,\r\n                    pagerLayout: { pagination: null, info: null },\r\n                    callback: null,\r\n                    init: function(meta) {\r\n                        pg.meta = meta;\r\n\r\n                        // parse pagination meta to integer\r\n                        pg.meta.page = parseInt(pg.meta.page);\r\n                        pg.meta.pages = parseInt(pg.meta.pages);\r\n                        pg.meta.perpage = parseInt(pg.meta.perpage);\r\n                        pg.meta.total = parseInt(pg.meta.total);\r\n\r\n                        // todo; if meta object not exist will cause error\r\n                        // always recount total pages\r\n                        pg.meta.pages = Math.max(Math.ceil(pg.meta.total / pg.meta.perpage), 1);\r\n\r\n                        // current page must be not over than total pages\r\n                        if (pg.meta.page > pg.meta.pages) pg.meta.page = pg.meta.pages;\r\n\r\n                        // set unique event name between tables\r\n                        pg.paginateEvent = Plugin.getTablePrefix();\r\n\r\n                        pg.pager = $(datatable.table).siblings('.m-datatable__pager');\r\n                        if ($(pg.pager).hasClass('m-datatable--paging-loaded')) return;\r\n\r\n                        // if class .m-datatable--paging-loaded not exist, recreate pagination\r\n                        $(pg.pager).remove();\r\n\r\n                        // if no pages available\r\n                        if (pg.meta.pages === 0) return;\r\n\r\n                        // update datasource params\r\n                        Plugin.setDataSourceParam('pagination', {\r\n                            page: pg.meta.page,\r\n                            pages: pg.meta.pages,\r\n                            perpage: pg.meta.perpage,\r\n                            total: pg.meta.total,\r\n                        });\r\n\r\n                        // default callback function, contains remote pagination handler\r\n                        pg.callback = pg.serverCallback;\r\n                        // custom callback function\r\n                        if (typeof callback === 'function') pg.callback = callback;\r\n\r\n                        pg.addPaginateEvent();\r\n                        pg.populate();\r\n\r\n                        pg.meta.page = Math.max(pg.meta.page || 1, pg.meta.page);\r\n\r\n                        $(datatable).trigger(pg.paginateEvent, pg.meta);\r\n\r\n                        pg.pagingBreakpoint.call();\r\n                        $(window).resize(pg.pagingBreakpoint);\r\n                    },\r\n                    serverCallback: function(ctx, meta) {\r\n                        Plugin.dataRender();\r\n                    },\r\n                    populate: function() {\r\n                        var icons = Plugin.getOption('layout.icons.pagination');\r\n                        var title = Plugin.getOption('translate.toolbar.pagination.items.default');\r\n                        // pager root element\r\n                        pg.pager = $('<div/>').addClass('m-datatable__pager m-datatable--paging-loaded clearfix');\r\n                        // numbering links\r\n                        var pagerNumber = $('<ul/>').addClass('m-datatable__pager-nav');\r\n                        pg.pagerLayout['pagination'] = pagerNumber;\r\n\r\n                        // pager first/previous button\r\n                        $('<li/>').append($('<a/>').attr('title', title.first).addClass('m-datatable__pager-link m-datatable__pager-link--first').append($('<i/>').addClass(icons.first)).on('click', pg.gotoMorePage).attr('data-page', 1)).appendTo(pagerNumber);\r\n                        $('<li/>').append($('<a/>').attr('title', title.prev).addClass('m-datatable__pager-link m-datatable__pager-link--prev').append($('<i/>').addClass(icons.prev)).on('click', pg.gotoMorePage)).appendTo(pagerNumber);\r\n\r\n                        // more previous pages\r\n                        $('<li/>').append($('<a/>').attr('title', title.more).addClass('m-datatable__pager-link m-datatable__pager-link--more-prev').html($('<i/>').addClass(icons.more)).on('click', pg.gotoMorePage)).appendTo(pagerNumber);\r\n\r\n                        $('<li/>').append($('<input/>').attr('type', 'text').addClass('m-pager-input form-control').attr('title', title.input).on('keyup', function() {\r\n                            // on keyup update [data-page]\r\n                            $(this).attr('data-page', Math.abs($(this).val()));\r\n                        }).on('keypress', function(e) {\r\n                            // on keypressed enter button\r\n                            if (e.which === 13) pg.gotoMorePage(e);\r\n                        })).appendTo(pagerNumber);\r\n\r\n                        var pagesNumber = Plugin.getOption('toolbar.items.pagination.pages.desktop.pagesNumber');\r\n                        var end = Math.ceil(pg.meta.page / pagesNumber) * pagesNumber;\r\n                        var start = end - pagesNumber;\r\n                        if (end > pg.meta.pages) {\r\n                            end = pg.meta.pages;\r\n                        }\r\n                        for (var x = start; x < end; x++) {\r\n                            var pageNumber = x + 1;\r\n                            $('<li/>').append($('<a/>').addClass('m-datatable__pager-link m-datatable__pager-link-number').text(pageNumber).attr('data-page', pageNumber).attr('title', pageNumber).on('click', pg.gotoPage)).appendTo(pagerNumber);\r\n                        }\r\n\r\n                        // more next pages\r\n                        $('<li/>').append($('<a/>').attr('title', title.more).addClass('m-datatable__pager-link m-datatable__pager-link--more-next').html($('<i/>').addClass(icons.more)).on('click', pg.gotoMorePage)).appendTo(pagerNumber);\r\n\r\n                        // pager next/last button\r\n                        $('<li/>').append($('<a/>').attr('title', title.next).addClass('m-datatable__pager-link m-datatable__pager-link--next').append($('<i/>').addClass(icons.next)).on('click', pg.gotoMorePage)).appendTo(pagerNumber);\r\n                        $('<li/>').append($('<a/>').attr('title', title.last).addClass('m-datatable__pager-link m-datatable__pager-link--last').append($('<i/>').addClass(icons.last)).on('click', pg.gotoMorePage).attr('data-page', pg.meta.pages)).appendTo(pagerNumber);\r\n\r\n                        // page info\r\n                        if (Plugin.getOption('toolbar.items.info')) {\r\n                            pg.pagerLayout['info'] = $('<div/>').addClass('m-datatable__pager-info').append($('<span/>').addClass('m-datatable__pager-detail'));\r\n                        }\r\n\r\n                        $.each(Plugin.getOption('toolbar.layout'), function(i, layout) {\r\n                            $(pg.pagerLayout[layout]).appendTo(pg.pager);\r\n                        });\r\n\r\n                        // page size select\r\n                        var pageSizeSelect = $('<select/>').addClass('selectpicker m-datatable__pager-size').attr('title', Plugin.getOption('translate.toolbar.pagination.items.default.select')).attr('data-width', '70px').val(pg.meta.perpage).on('change', pg.updatePerpage).prependTo(pg.pagerLayout['info']);\r\n\r\n                        var pageSizes = Plugin.getOption('toolbar.items.pagination.pageSizeSelect');\r\n                        // default value here, to fix override option by user\r\n                        if (pageSizes.length == 0) pageSizes = [10, 20, 30, 50, 100];\r\n                        $.each(pageSizes, function(i, size) {\r\n                            var display = size;\r\n                            if (size === -1) display = 'All';\r\n                            $('<option/>').attr('value', size).html(display).appendTo(pageSizeSelect);\r\n                        });\r\n\r\n                        // init selectpicker to dropdown\r\n                        $(datatable).ready(function() {\r\n                            $('.selectpicker').selectpicker().siblings('.dropdown-toggle').attr('title', Plugin.getOption(\r\n                                'translate.toolbar.pagination.items.default.select'));\r\n                        });\r\n\r\n                        pg.paste();\r\n                    },\r\n                    paste: function() {\r\n                        // insert pagination based on placement position, top|bottom\r\n                        $.each($.unique(Plugin.getOption('toolbar.placement')),\r\n                            function(i, position) {\r\n                                if (position === 'bottom') {\r\n                                    $(pg.pager).clone(true).insertAfter(datatable.table);\r\n                                }\r\n                                if (position === 'top') {\r\n                                    // pager top need some extra space\r\n                                    $(pg.pager).clone(true).addClass('m-datatable__pager--top').insertBefore(datatable.table);\r\n                                }\r\n                            });\r\n                    },\r\n                    gotoMorePage: function(e) {\r\n                        e.preventDefault();\r\n                        // $(this) is a link of .m-datatable__pager-link\r\n\r\n                        if ($(this).attr('disabled') === 'disabled') return false;\r\n\r\n                        var page = $(this).attr('data-page');\r\n\r\n                        // event from text input\r\n                        if (typeof page === 'undefined') {\r\n                            page = $(e.target).attr('data-page');\r\n                        }\r\n\r\n                        pg.openPage(parseInt(page));\r\n                        return false;\r\n                    },\r\n                    gotoPage: function(e) {\r\n                        e.preventDefault();\r\n                        // prevent from click same page number\r\n                        if ($(this).hasClass('m-datatable__pager-link--active')) return;\r\n\r\n                        pg.openPage(parseInt($(this).data('page')));\r\n                    },\r\n                    openPage: function(page) {\r\n                        // currentPage is 1-based index\r\n                        pg.meta.page = parseInt(page);\r\n\r\n                        $(datatable).trigger(pg.paginateEvent, pg.meta);\r\n                        pg.callback(pg, pg.meta);\r\n\r\n                        // update page callback function\r\n                        $(pg.pager).trigger('m-datatable--on-goto-page', pg.meta);\r\n                    },\r\n                    updatePerpage: function(e) {\r\n                        e.preventDefault();\r\n                        // if (Plugin.getOption('layout.height') === null) {\r\n                        // fix white space, when perpage is set from many records to less records\r\n                        // $('html, body').animate({scrollTop: $(datatable).position().top});\r\n                        // }\r\n\r\n                        pg.pager = $(datatable.table).siblings('.m-datatable__pager').removeClass('m-datatable--paging-loaded');\r\n\r\n                        // on change select page size\r\n                        if (e.originalEvent) {\r\n                            pg.meta.perpage = parseInt($(this).val());\r\n                        }\r\n\r\n                        $(pg.pager).find('select.m-datatable__pager-size').val(pg.meta.perpage).attr('data-selected', pg.meta.perpage);\r\n\r\n                        // update datasource params\r\n                        Plugin.setDataSourceParam('pagination', {\r\n                            page: pg.meta.page,\r\n                            pages: pg.meta.pages,\r\n                            perpage: pg.meta.perpage,\r\n                            total: pg.meta.total,\r\n                        });\r\n\r\n                        // update page callback function\r\n                        $(pg.pager).trigger('m-datatable--on-update-perpage', pg.meta);\r\n                        $(datatable).trigger(pg.paginateEvent, pg.meta);\r\n                        pg.callback(pg, pg.meta);\r\n\r\n                        // update pagination info\r\n                        pg.updateInfo.call();\r\n                    },\r\n                    addPaginateEvent: function(e) {\r\n                        // pagination event\r\n                        $(datatable).off(pg.paginateEvent).on(pg.paginateEvent, function(e, meta) {\r\n                            Plugin.spinnerCallback(true);\r\n\r\n                            pg.pager = $(datatable.table).siblings('.m-datatable__pager');\r\n                            var pagerNumber = $(pg.pager).find('.m-datatable__pager-nav');\r\n\r\n                            // set sync active page class\r\n                            $(pagerNumber).find('.m-datatable__pager-link--active').removeClass('m-datatable__pager-link--active');\r\n                            $(pagerNumber).find('.m-datatable__pager-link-number[data-page=\"' + meta.page + '\"]').addClass('m-datatable__pager-link--active');\r\n\r\n                            // set next and previous link page number\r\n                            $(pagerNumber).find('.m-datatable__pager-link--prev').attr('data-page', Math.max(meta.page - 1, 1));\r\n                            $(pagerNumber).find('.m-datatable__pager-link--next').attr('data-page', Math.min(meta.page + 1, meta.pages));\r\n\r\n                            // current page input value sync\r\n                            $(pg.pager).each(function() {\r\n                                $(this).find('.m-pager-input[type=\"text\"]').prop('value', meta.page);\r\n                            });\r\n\r\n                            $(pg.pager).find('.m-datatable__pager-nav').show();\r\n                            if (meta.pages <= 1) {\r\n                                // hide pager if has 1 page\r\n                                $(pg.pager).find('.m-datatable__pager-nav').hide();\r\n                            }\r\n\r\n                            // update datasource params\r\n                            Plugin.setDataSourceParam('pagination', {\r\n                                page: pg.meta.page,\r\n                                pages: pg.meta.pages,\r\n                                perpage: pg.meta.perpage,\r\n                                total: pg.meta.total,\r\n                            });\r\n\r\n                            $(pg.pager).find('select.m-datatable__pager-size').val(meta.perpage).attr('data-selected', meta.perpage);\r\n\r\n                            // clear active rows\r\n                            $(datatable.table).find('.m-checkbox > [type=\"checkbox\"]').prop('checked', false);\r\n                            $(datatable.table).find('.m-datatable__row--active').removeClass('m-datatable__row--active');\r\n\r\n                            pg.updateInfo.call();\r\n                            pg.pagingBreakpoint.call();\r\n                            // Plugin.resetScroll();\r\n                        });\r\n                    },\r\n                    updateInfo: function() {\r\n                        var start = Math.max(pg.meta.perpage * (pg.meta.page - 1) + 1, 1);\r\n                        var end = Math.min(start + pg.meta.perpage - 1, pg.meta.total);\r\n                        // page info update\r\n                        $(pg.pager).find('.m-datatable__pager-info').find('.m-datatable__pager-detail').html(Plugin.dataPlaceholder(\r\n                            Plugin.getOption('translate.toolbar.pagination.items.info'), {\r\n                                start: start,\r\n                                end: pg.meta.perpage === -1 ? pg.meta.total : end,\r\n                                pageSize: pg.meta.perpage === -1 ||\r\n                                    pg.meta.perpage >= pg.meta.total ?\r\n                                    pg.meta.total : pg.meta.perpage,\r\n                                total: pg.meta.total,\r\n                            }));\r\n                    },\r\n\r\n                    /**\r\n                     * Update pagination layout breakpoint\r\n                     */\r\n                    pagingBreakpoint: function() {\r\n                        // keep page links reference\r\n                        var pagerNumber = $(datatable.table).siblings('.m-datatable__pager').find('.m-datatable__pager-nav');\r\n                        if ($(pagerNumber).length === 0) return;\r\n\r\n                        var currentPage = Plugin.getCurrentPage();\r\n                        var pagerInput = $(pagerNumber).find('.m-pager-input').closest('li');\r\n\r\n                        // reset\r\n                        $(pagerNumber).find('li').show();\r\n\r\n                        // pagination update\r\n                        $.each(Plugin.getOption('toolbar.items.pagination.pages'),\r\n                            function(mode, option) {\r\n                                if (mUtil.isInResponsiveRange(mode)) {\r\n                                    switch (mode) {\r\n                                        case 'desktop':\r\n                                        case 'tablet':\r\n                                            var end = Math.ceil(currentPage / option.pagesNumber) *\r\n                                                option.pagesNumber;\r\n                                            var start = end - option.pagesNumber;\r\n                                            $(pagerInput).hide();\r\n                                            pg.meta = Plugin.getDataSourceParam('pagination');\r\n                                            pg.paginationUpdate();\r\n                                            break;\r\n\r\n                                        case 'mobile':\r\n                                            $(pagerInput).show();\r\n                                            $(pagerNumber).find('.m-datatable__pager-link--more-prev').closest('li').hide();\r\n                                            $(pagerNumber).find('.m-datatable__pager-link--more-next').closest('li').hide();\r\n                                            $(pagerNumber).find('.m-datatable__pager-link-number').closest('li').hide();\r\n                                            break;\r\n                                    }\r\n\r\n                                    return false;\r\n                                }\r\n                            });\r\n                    },\r\n\r\n                    /**\r\n                     * Update pagination number and button display\r\n                     */\r\n                    paginationUpdate: function() {\r\n                        var pager = $(datatable.table).siblings('.m-datatable__pager').find('.m-datatable__pager-nav'),\r\n                            pagerMorePrev = $(pager).find('.m-datatable__pager-link--more-prev'),\r\n                            pagerMoreNext = $(pager).find('.m-datatable__pager-link--more-next'),\r\n                            pagerFirst = $(pager).find('.m-datatable__pager-link--first'),\r\n                            pagerPrev = $(pager).find('.m-datatable__pager-link--prev'),\r\n                            pagerNext = $(pager).find('.m-datatable__pager-link--next'),\r\n                            pagerLast = $(pager).find('.m-datatable__pager-link--last');\r\n\r\n                        // get visible page\r\n                        var pagerNumber = $(pager).find('.m-datatable__pager-link-number');\r\n                        // get page before of first visible\r\n                        var morePrevPage = Math.max($(pagerNumber).first().data('page') - 1,\r\n                            1);\r\n                        $(pagerMorePrev).each(function(i, prev) {\r\n                            $(prev).attr('data-page', morePrevPage);\r\n                        });\r\n                        // show/hide <li>\r\n                        if (morePrevPage === 1) {\r\n                            $(pagerMorePrev).parent().hide();\r\n                        } else {\r\n                            $(pagerMorePrev).parent().show();\r\n                        }\r\n\r\n                        // get page after of last visible\r\n                        var moreNextPage = Math.min($(pagerNumber).last().data('page') + 1,\r\n                            pg.meta.pages);\r\n                        $(pagerMoreNext).each(function(i, prev) {\r\n                            $(pagerMoreNext).attr('data-page', moreNextPage).show();\r\n                        });\r\n\r\n                        // show/hide <li>\r\n                        if (moreNextPage === pg.meta.pages\r\n                            // missing dot fix when last hidden page is one left\r\n                            &&\r\n                            moreNextPage === $(pagerNumber).last().data('page')) {\r\n                            $(pagerMoreNext).parent().hide();\r\n                        } else {\r\n                            $(pagerMoreNext).parent().show();\r\n                        }\r\n\r\n                        // begin/end of pages\r\n                        if (pg.meta.page === 1) {\r\n                            $(pagerFirst).attr('disabled', true).addClass('m-datatable__pager-link--disabled');\r\n                            $(pagerPrev).attr('disabled', true).addClass('m-datatable__pager-link--disabled');\r\n                        } else {\r\n                            $(pagerFirst).removeAttr('disabled').removeClass('m-datatable__pager-link--disabled');\r\n                            $(pagerPrev).removeAttr('disabled').removeClass('m-datatable__pager-link--disabled');\r\n                        }\r\n                        if (pg.meta.page === pg.meta.pages) {\r\n                            $(pagerNext).attr('disabled', true).addClass('m-datatable__pager-link--disabled');\r\n                            $(pagerLast).attr('disabled', true).addClass('m-datatable__pager-link--disabled');\r\n                        } else {\r\n                            $(pagerNext).removeAttr('disabled').removeClass('m-datatable__pager-link--disabled');\r\n                            $(pagerLast).removeAttr('disabled').removeClass('m-datatable__pager-link--disabled');\r\n                        }\r\n\r\n                        // display more buttons\r\n                        var nav = Plugin.getOption('toolbar.items.pagination.navigation');\r\n                        if (!nav.first) $(pagerFirst).remove();\r\n                        if (!nav.prev) $(pagerPrev).remove();\r\n                        if (!nav.next) $(pagerNext).remove();\r\n                        if (!nav.last) $(pagerLast).remove();\r\n                    },\r\n                };\r\n                pg.init(meta);\r\n                return pg;\r\n            },\r\n\r\n            /**\r\n             * Hide/show table cell defined by\r\n             * options[columns][i][responsive][visible/hidden]\r\n             */\r\n            columnHide: function() {\r\n                var screen = mUtil.getViewPort().width;\r\n                // foreach columns setting\r\n                $.each(options.columns, function(i, column) {\r\n                    if (typeof column.responsive !== 'undefined') {\r\n                        var field = column.field;\r\n                        var tds = $.grep($(datatable.table).find('.m-datatable__cell'), function(n, i) {\r\n                            return field === $(n).data('field');\r\n                        });\r\n                        if (mUtil.getBreakpoint(column.responsive.hidden) >= screen) {\r\n                            $(tds).hide();\r\n                        } else {\r\n                            $(tds).show();\r\n                        }\r\n                        if (mUtil.getBreakpoint(column.responsive.visible) <= screen) {\r\n                            $(tds).show();\r\n                        } else {\r\n                            $(tds).hide();\r\n                        }\r\n                    }\r\n                });\r\n            },\r\n\r\n            /**\r\n             * Setup sub datatable\r\n             */\r\n            setupSubDatatable: function() {\r\n                var subTableCallback = Plugin.getOption('detail.content');\r\n                if (typeof subTableCallback !== 'function') return;\r\n\r\n                // subtable already exist\r\n                if ($(datatable.table).find('.m-datatable__subtable').length > 0) return;\r\n\r\n                $(datatable.wrap).addClass('m-datatable--subtable');\r\n\r\n                options.columns[0]['subtable'] = true;\r\n\r\n                // toggle on open sub table\r\n                var toggleSubTable = function(e) {\r\n                    e.preventDefault();\r\n                    // get parent row of this subtable\r\n                    var parentRow = $(this).closest('.m-datatable__row');\r\n\r\n                    // get subtable row for sub table\r\n                    var subTableRow = $(parentRow).next('.m-datatable__row-subtable');\r\n                    if ($(subTableRow).length === 0) {\r\n                        // prepare DOM for sub table, each <tr> as parent and add <tr> as child table\r\n                        subTableRow = $('<tr/>').addClass('m-datatable__row-subtable m-datatable__row-loading').hide().append($('<td/>').addClass('m-datatable__subtable').attr('colspan', Plugin.getTotalColumns()));\r\n                        $(parentRow).after(subTableRow);\r\n                        // add class to even row\r\n                        if ($(parentRow).hasClass('m-datatable__row--even')) {\r\n                            $(subTableRow).addClass('m-datatable__row-subtable--even');\r\n                        }\r\n                    }\r\n\r\n                    $(subTableRow).toggle();\r\n\r\n                    var subTable = $(subTableRow).find('.m-datatable__subtable');\r\n\r\n                    // get id from first column of parent row\r\n                    var primaryKey = String($(this).closest('[data-field]:first-child').find('.m-datatable__toggle-subtable').data('value'));\r\n                    console.log(typeof primaryKey);\r\n\r\n                    var icon = $(this).find('i').removeAttr('class');\r\n\r\n                    // prevent duplicate datatable init\r\n                    if ($(parentRow).hasClass('m-datatable__row--subtable-expanded')) {\r\n                        $(icon).addClass(Plugin.getOption('layout.icons.rowDetail.collapse'));\r\n                        // remove expand class from parent row\r\n                        $(parentRow).removeClass('m-datatable__row--subtable-expanded');\r\n                        // trigger event on collapse\r\n                        $(datatable).trigger('m-datatable--on-collapse-subtable', [parentRow]);\r\n                    } else {\r\n                        // expand and run callback function\r\n                        $(icon).addClass(Plugin.getOption('layout.icons.rowDetail.expand'));\r\n                        // add expand class to parent row\r\n                        $(parentRow).addClass('m-datatable__row--subtable-expanded');\r\n                        // trigger event on expand\r\n                        $(datatable).trigger('m-datatable--on-expand-subtable', [parentRow]);\r\n                    }\r\n\r\n                    // prevent duplicate datatable init\r\n                    if ($(subTable).find('.m-datatable').length === 0) {\r\n\r\n                        // get data by primary id\r\n                        $.map(datatable.dataSet, function(n, i) {\r\n                            // primary id must be at the first column, otherwise e.data will be undefined\r\n                            // bug: if n[options.columns[0].field] is a number e.g 1===\"1\", then data \r\n                            // will be set as undefined, eg. OrderID is a number intead of string\r\n                            if (primaryKey === n[options.columns[0].field]) {\r\n                                e.data = n;\r\n                                return true;\r\n                            }\r\n                            if ((!isNaN(primaryKey) && !isNaN(n[options.columns[0].field])) && +primaryKey === +n[options.columns[0].field]) {\r\n                                e.data = n;\r\n                                return true;\r\n                            }\r\n                            return false;\r\n                        });\r\n\r\n                        // deprecated in v5.0.6\r\n                        e.detailCell = subTable;\r\n\r\n                        e.parentRow = parentRow;\r\n                        e.subTable = subTable;\r\n\r\n                        // run callback with event\r\n                        subTableCallback(e);\r\n\r\n                        $(subTable).children('.m-datatable').on('m-datatable--on-init', function(e) {\r\n                            $(subTableRow).removeClass('m-datatable__row-loading');\r\n                        });\r\n                        if (Plugin.getOption('data.type') === 'local') {\r\n                            $(subTableRow).removeClass('m-datatable__row-loading');\r\n                        }\r\n                    }\r\n                };\r\n\r\n                var columns = options.columns;\r\n                $(datatable.tableBody).find('.m-datatable__row').each(function(tri, tr) {\r\n                    $(tr).find('.m-datatable__cell').each(function(tdi, td) {\r\n                        // get column settings by field\r\n                        var column = $.grep(columns, function(n, i) {\r\n                            return $(td).data('field') === n.field;\r\n                        })[0];\r\n                        if (typeof column !== 'undefined') {\r\n                            var value = $(td).text();\r\n                            // enable column subtable toggle\r\n                            if (typeof column.subtable !== 'undefined' && column.subtable) {\r\n                                // check if subtable toggle exist\r\n                                if ($(td).find('.m-datatable__toggle-subtable').length > 0) return;\r\n                                // append subtable toggle\r\n                                $(td).html($('<a/>').addClass('m-datatable__toggle-subtable').attr('href', '#').attr('data-value', value).attr('title', Plugin.getOption('detail.title')).on('click', toggleSubTable).append($('<i/>').css('width', $(td).data('width')).addClass(Plugin.getOption('layout.icons.rowDetail.collapse'))));\r\n                            }\r\n                        }\r\n                    });\r\n                });\r\n\r\n                // $(datatable.tableHead).find('.m-datatable__row').first()\r\n            },\r\n\r\n            /**\r\n             * Datasource mapping callback\r\n             */\r\n            dataMapCallback: function(raw) {\r\n                // static dataset array\r\n                var dataSet = raw;\r\n                // dataset mapping callback\r\n                if (typeof Plugin.getOption('data.source.read.map') === 'function') {\r\n                    return Plugin.getOption('data.source.read.map')(raw);\r\n                } else {\r\n                    // default data mapping fallback\r\n                    if (typeof raw !== 'undefined' && typeof raw.data !== 'undefined') {\r\n                        dataSet = raw.data;\r\n                    }\r\n                }\r\n                return dataSet;\r\n            },\r\n\r\n            isSpinning: false,\r\n            /**\r\n             * BlockUI spinner callback\r\n             * @param block\r\n             */\r\n            spinnerCallback: function(block) {\r\n                if (block) {\r\n                    if (!Plugin.isSpinning) {\r\n                        // get spinner options\r\n                        var spinnerOptions = Plugin.getOption('layout.spinner');\r\n                        if (spinnerOptions.message === true) {\r\n                            // use default spinner message from translation\r\n                            spinnerOptions.message = Plugin.getOption('translate.records.processing');\r\n                        }\r\n                        Plugin.isSpinning = true;\r\n                        if (typeof mApp !== 'undefined') {\r\n                            mApp.block(datatable, spinnerOptions);\r\n                        }\r\n                    }\r\n                } else {\r\n                    Plugin.isSpinning = false;\r\n                    if (typeof mApp !== 'undefined') {\r\n                        mApp.unblock(datatable);\r\n                    }\r\n                }\r\n            },\r\n\r\n            /**\r\n             * Default sort callback function\r\n             * @param data\r\n             * @param sort\r\n             * @param column\r\n             * @returns {*|Array.<T>|{sort, field}|{asc, desc}}\r\n             */\r\n            sortCallback: function(data, sort, column) {\r\n                var type = column['type'] || 'string';\r\n                var format = column['format'] || '';\r\n                var field = column['field'];\r\n\r\n                return $(data).sort(function(a, b) {\r\n                    var aField = a[field];\r\n                    var bField = b[field];\r\n\r\n                    switch (type) {\r\n                        case 'date':\r\n                            if (typeof moment === 'undefined') {\r\n                                throw new Error('Moment.js is required.');\r\n                            }\r\n                            var diff = moment(aField, format).diff(moment(bField, format));\r\n                            if (sort === 'asc') {\r\n                                return diff > 0 ? 1 : diff < 0 ? -1 : 0;\r\n                            } else {\r\n                                return diff < 0 ? 1 : diff > 0 ? -1 : 0;\r\n                            }\r\n                            break;\r\n\r\n                        case 'number':\r\n                            if (isNaN(parseFloat(aField)) && aField != null) {\r\n                                aField = Number(aField.replace(/[^0-9\\.-]+/g, ''));\r\n                            }\r\n                            if (isNaN(parseFloat(bField)) && bField != null) {\r\n                                bField = Number(bField.replace(/[^0-9\\.-]+/g, ''));\r\n                            }\r\n                            aField = parseFloat(aField);\r\n                            bField = parseFloat(bField);\r\n                            if (sort === 'asc') {\r\n                                return aField > bField ? 1 : aField < bField ? -1 : 0;\r\n                            } else {\r\n                                return aField < bField ? 1 : aField > bField ? -1 : 0;\r\n                            }\r\n                            break;\r\n\r\n                        case 'string':\r\n                        default:\r\n                            if (sort === 'asc') {\r\n                                return aField > bField ? 1 : aField < bField ? -1 : 0;\r\n                            } else {\r\n                                return aField < bField ? 1 : aField > bField ? -1 : 0;\r\n                            }\r\n                            break;\r\n                    }\r\n                });\r\n            },\r\n\r\n            /**\r\n             * Custom debug log\r\n             * @param text\r\n             * @param obj\r\n             */\r\n            log: function(text, obj) {\r\n                if (typeof obj === 'undefined') obj = '';\r\n                if (datatable.debug) {\r\n                    console.log(text, obj);\r\n                }\r\n            },\r\n\r\n            /**\r\n             * Auto hide columnds overflow in row\r\n             */\r\n            autoHide: function() {\r\n                $(datatable.table).find('.m-datatable__cell').show();\r\n                $(datatable.tableBody).each(function() {\r\n                    while ($(this)[0].offsetWidth < $(this)[0].scrollWidth) {\r\n                        $(datatable.table).find('.m-datatable__row').each(function(i) {\r\n                            var cell = $(this).find('.m-datatable__cell').not(':hidden').last();\r\n                            $(cell).hide();\r\n                        });\r\n                        Plugin.adjustCellsWidth.call();\r\n                    }\r\n                });\r\n\r\n                var toggleHiddenColumns = function(e) {\r\n                    e.preventDefault();\r\n\r\n                    var row = $(this).closest('.m-datatable__row');\r\n                    var detailRow = $(row).next();\r\n\r\n                    if (!$(detailRow).hasClass('m-datatable__row-detail')) {\r\n                        $(this).find('i').removeClass(Plugin.getOption('layout.icons.rowDetail.collapse')).addClass(Plugin.getOption('layout.icons.rowDetail.expand'));\r\n\r\n                        var hidden = $(row).find('.m-datatable__cell:hidden').clone().show();\r\n\r\n                        detailRow = $('<tr/>').addClass('m-datatable__row-detail').insertAfter(row);\r\n                        var detailRowTd = $('<td/>').addClass('m-datatable__detail').attr('colspan', Plugin.getTotalColumns()).appendTo(detailRow);\r\n\r\n                        var detailSubTable = $('<table/>');\r\n                        $(hidden).each(function() {\r\n                            var field = $(this).data('field');\r\n                            var column = $.grep(options.columns, function(n, i) {\r\n                                return field === n.field;\r\n                            })[0];\r\n                            $(detailSubTable).append($('<tr class=\"m-datatable__row\"></tr>').append($('<td class=\"m-datatable__cell\"></td>').append($('<span/>').css('width', Plugin.offset).append(column.title))).append(this));\r\n                        });\r\n                        $(detailRowTd).append(detailSubTable);\r\n\r\n                    } else {\r\n                        $(this).find('i').removeClass(Plugin.getOption('layout.icons.rowDetail.expand')).addClass(Plugin.getOption('layout.icons.rowDetail.collapse'));\r\n                        $(detailRow).remove();\r\n                    }\r\n                };\r\n\r\n                // toggle show hidden columns\r\n                $(datatable.tableBody).find('.m-datatable__row').each(function() {\r\n                    $(this).prepend($('<td/>').addClass('m-datatable__cell m-datatable__toggle--detail').append($('<a/>').addClass('m-datatable__toggle-detail').attr('href', '').on('click', toggleHiddenColumns).append($('<i/>').css('width', '21px'). // maintain width for both icons expand and collapse\r\n                        addClass(Plugin.getOption('layout.icons.rowDetail.collapse')))));\r\n\r\n                    // check if subtable toggle exist\r\n                    if ($(datatable.tableHead).find('.m-datatable__toggle-detail').length === 0) {\r\n                        $(datatable.tableHead).find('.m-datatable__row').first().prepend('<th class=\"m-datatable__cell m-datatable__toggle-detail\"><span style=\"width: 21px\"></span></th>');\r\n                        $(datatable.tableFoot).find('.m-datatable__row').first().prepend('<th class=\"m-datatable__cell m-datatable__toggle-detail\"><span style=\"width: 21px\"></span></th>');\r\n                    } else {\r\n                        $(datatable.tableHead).find('.m-datatable__toggle-detail').find('span').css('width', '21px');\r\n                    }\r\n                });\r\n            },\r\n\r\n            /**\r\n             * todo; implement hover column\r\n             */\r\n            hoverColumn: function() {\r\n                $(datatable.tableBody).on('mouseenter', '.m-datatable__cell', function() {\r\n                    var colIdx = $(Plugin.cell(this).nodes()).index();\r\n                    $(Plugin.cells().nodes()).removeClass('m-datatable__cell--hover');\r\n                    $(Plugin.column(colIdx).nodes()).addClass('m-datatable__cell--hover');\r\n                });\r\n            },\r\n\r\n            /**\r\n             * To enable auto columns features for remote data source\r\n             */\r\n            setAutoColumns: function() {\r\n                if (Plugin.getOption('data.autoColumns')) {\r\n                    $.each(datatable.dataSet[0], function(k, v) {\r\n                        var found = $.grep(options.columns, function(n, i) {\r\n                            return k === n.field;\r\n                        });\r\n                        if (found.length === 0) {\r\n                            options.columns.push({ field: k, title: k });\r\n                        }\r\n                    });\r\n                    $(datatable.tableHead).find('.m-datatable__row').remove();\r\n                    Plugin.setHeadTitle();\r\n                    if (Plugin.getOption('layout.footer')) {\r\n                        $(datatable.tableFoot).find('.m-datatable__row').remove();\r\n                        Plugin.setHeadTitle(datatable.tableFoot);\r\n                    }\r\n                }\r\n            },\r\n\r\n            /********************\r\n             ** HELPERS\r\n             ********************/\r\n\r\n            /**\r\n             * Check if table is a locked colums table\r\n             */\r\n            isLocked: function() {\r\n                return mUtil.hasClass(datatable.wrap[0], 'm-datatable--lock') || false;\r\n            },\r\n\r\n            /**\r\n             * Get total extra space of an element for width calculation, including\r\n             * padding, margin, border\r\n             * @param element\r\n             * @returns {number}\r\n             */\r\n            getExtraSpace: function(element) {\r\n                var padding = parseInt($(element).css('paddingRight')) +\r\n                    parseInt($(element).css('paddingLeft'));\r\n                var margin = parseInt($(element).css('marginRight')) +\r\n                    parseInt($(element).css('marginLeft'));\r\n                var border = Math.ceil(\r\n                    $(element).css('border-right-width').replace('px', ''));\r\n                return padding + margin + border;\r\n            },\r\n\r\n            /**\r\n             * Insert data of array into {{ }} template placeholder\r\n             * @param template\r\n             * @param data\r\n             * @returns {*}\r\n             */\r\n            dataPlaceholder: function(template, data) {\r\n                var result = template;\r\n                $.each(data, function(key, val) {\r\n                    result = result.replace('{{' + key + '}}', val);\r\n                });\r\n                return result;\r\n            },\r\n\r\n            /**\r\n             * Get table unique ID\r\n             * Note: table unique change each time refreshed\r\n             * @param suffix\r\n             * @returns {*}\r\n             */\r\n            getTableId: function(suffix) {\r\n                if (typeof suffix === 'undefined') suffix = '';\r\n                var id = $(datatable).attr('id');\r\n                if (typeof id === 'undefined') {\r\n                    id = $(datatable).attr('class').split(' ')[0];\r\n                }\r\n                return id + suffix;\r\n            },\r\n\r\n            /**\r\n             * Get table prefix with depth number\r\n             */\r\n            getTablePrefix: function(suffix) {\r\n                if (typeof suffix !== 'undefined') suffix = '-' + suffix;\r\n                return Plugin.getTableId() + '-' + Plugin.getDepth() + suffix;\r\n            },\r\n\r\n            /**\r\n             * Get current table depth of sub table\r\n             * @returns {number}\r\n             */\r\n            getDepth: function() {\r\n                var depth = 0;\r\n                var table = datatable.table;\r\n                do {\r\n                    table = $(table).parents('.m-datatable__table');\r\n                    depth++;\r\n                } while ($(table).length > 0);\r\n                return depth;\r\n            },\r\n\r\n            /**\r\n             * Keep state item\r\n             * @param key\r\n             * @param value\r\n             */\r\n            stateKeep: function(key, value) {\r\n                key = Plugin.getTablePrefix(key);\r\n                if (Plugin.getOption('data.saveState') === false) return;\r\n                if (Plugin.getOption('data.saveState.webstorage') && localStorage) {\r\n                    localStorage.setItem(key, JSON.stringify(value));\r\n                }\r\n                if (Plugin.getOption('data.saveState.cookie')) {\r\n                    Cookies.set(key, JSON.stringify(value));\r\n                }\r\n            },\r\n\r\n            /**\r\n             * Get state item\r\n             * @param key\r\n             * @param defValue\r\n             */\r\n            stateGet: function(key, defValue) {\r\n                key = Plugin.getTablePrefix(key);\r\n                if (Plugin.getOption('data.saveState') === false) return;\r\n                var value = null;\r\n                if (Plugin.getOption('data.saveState.webstorage') && localStorage) {\r\n                    value = localStorage.getItem(key);\r\n                } else {\r\n                    value = Cookies.get(key);\r\n                }\r\n                if (typeof value !== 'undefined' && value !== null) {\r\n                    return JSON.parse(value);\r\n                }\r\n            },\r\n\r\n            /**\r\n             * Update data in state without clear existing\r\n             * @param key\r\n             * @param value\r\n             */\r\n            stateUpdate: function(key, value) {\r\n                var ori = Plugin.stateGet(key);\r\n                if (typeof ori === 'undefined' || ori === null) ori = {};\r\n                Plugin.stateKeep(key, $.extend({}, ori, value));\r\n            },\r\n\r\n            /**\r\n             * Remove state item\r\n             * @param key\r\n             */\r\n            stateRemove: function(key) {\r\n                key = Plugin.getTablePrefix(key);\r\n                if (localStorage) {\r\n                    localStorage.removeItem(key);\r\n                }\r\n                Cookies.remove(key);\r\n            },\r\n\r\n            /**\r\n             * Get total columns.\r\n             */\r\n            getTotalColumns: function(tablePart) {\r\n                if (typeof tablePart === 'undefined') tablePart = datatable.tableBody;\r\n                return $(tablePart).find('.m-datatable__row').first().find('.m-datatable__cell').length;\r\n            },\r\n\r\n            /**\r\n             * Get table row. Useful to get row when current table is in lock mode.\r\n             * Can be used for both lock and normal table mode.\r\n             * By default, returning result will be in a list of <td>.\r\n             * @param tablePart\r\n             * @param row 1-based index\r\n             * @param tdOnly Optional. Default true\r\n             * @returns {*}\r\n             */\r\n            getOneRow: function(tablePart, row, tdOnly) {\r\n                if (typeof tdOnly === 'undefined') tdOnly = true;\r\n                // get list of <tr>\r\n                var result = $(tablePart).find('.m-datatable__row:not(.m-datatable__row-detail):nth-child(' + row + ')');\r\n                if (tdOnly) {\r\n                    // get list of <td> or <th>\r\n                    result = result.find('.m-datatable__cell');\r\n                }\r\n                return result;\r\n            },\r\n\r\n            /**\r\n             * Check if element has vertical overflow\r\n             * @param element\r\n             * @returns {boolean}\r\n             */\r\n            hasOverflowY: function(element) {\r\n                var children = $(element).find('.m-datatable__row');\r\n                var maxHeight = 0;\r\n\r\n                if (children.length > 0) {\r\n                    $(children).each(function(tdi, td) {\r\n                        maxHeight += Math.floor($(td).innerHeight());\r\n                    });\r\n\r\n                    return maxHeight > $(element).innerHeight();\r\n                }\r\n\r\n                return false;\r\n            },\r\n\r\n            /**\r\n             * Sort table row at HTML level by column index.\r\n             * todo; Not in use.\r\n             * @param header Header sort clicked\r\n             * @param sort asc|desc. Optional. Default asc\r\n             * @param int Boolean. Optional. Comparison value parse to integer.\r\n             *     Default false\r\n             */\r\n            sortColumn: function(header, sort, int) {\r\n                if (typeof sort === 'undefined') sort = 'asc'; // desc\r\n                if (typeof int === 'undefined') int = false;\r\n\r\n                var column = $(header).index();\r\n                var rows = $(datatable.tableBody).find('.m-datatable__row');\r\n                var hIndex = $(header).closest('.m-datatable__lock').index();\r\n                if (hIndex !== -1) {\r\n                    rows = $(datatable.tableBody).find('.m-datatable__lock:nth-child(' + (hIndex + 1) + ')').find('.m-datatable__row');\r\n                }\r\n\r\n                var container = $(rows).parent();\r\n                $(rows).sort(function(a, b) {\r\n                    var tda = $(a).find('td:nth-child(' + column + ')').text();\r\n                    var tdb = $(b).find('td:nth-child(' + column + ')').text();\r\n\r\n                    if (int) {\r\n                        // useful for integer type sorting\r\n                        tda = parseInt(tda);\r\n                        tdb = parseInt(tdb);\r\n                    }\r\n\r\n                    if (sort === 'asc') {\r\n                        return tda > tdb ? 1 : tda < tdb ? -1 : 0;\r\n                    } else {\r\n                        return tda < tdb ? 1 : tda > tdb ? -1 : 0;\r\n                    }\r\n                }).appendTo(container);\r\n            },\r\n\r\n            /**\r\n             * Perform sort remote and local\r\n             */\r\n            sorting: function() {\r\n                var sortObj = {\r\n                    init: function() {\r\n                        if (options.sortable) {\r\n                            $(datatable.tableHead).find('.m-datatable__cell:not(.m-datatable__cell--check)').addClass('m-datatable__cell--sort').off('click').on('click', sortObj.sortClick);\r\n                            // first init\r\n                            sortObj.setIcon();\r\n                        }\r\n                    },\r\n                    setIcon: function() {\r\n                        var meta = Plugin.getDataSourceParam('sort');\r\n                        if ($.isEmptyObject(meta)) return;\r\n\r\n                        // sort icon beside column header\r\n                        var td = $(datatable.tableHead).find('.m-datatable__cell[data-field=\"' + meta.field + '\"]').attr('data-sort', meta.sort);\r\n                        var sorting = $(td).find('span');\r\n                        var icon = $(sorting).find('i');\r\n\r\n                        var icons = Plugin.getOption('layout.icons.sort');\r\n                        // update sort icon; desc & asc\r\n                        if ($(icon).length > 0) {\r\n                            $(icon).removeAttr('class').addClass(icons[meta.sort]);\r\n                        } else {\r\n                            $(sorting).append($('<i/>').addClass(icons[meta.sort]));\r\n                        }\r\n                    },\r\n                    sortClick: function(e) {\r\n                        var meta = Plugin.getDataSourceParam('sort');\r\n                        var field = $(this).data('field');\r\n                        var column = Plugin.getColumnByField(field);\r\n                        // sort is disabled for this column\r\n                        if (typeof column.sortable !== 'undefined' &&\r\n                            column.sortable === false) return;\r\n\r\n                        $(datatable.tableHead).find('.m-datatable__cell > span > i').remove();\r\n\r\n                        if (options.sortable) {\r\n                            Plugin.spinnerCallback(true);\r\n\r\n                            var sort = 'desc';\r\n                            if (Plugin.getObject('field', meta) === field) {\r\n                                sort = Plugin.getObject('sort', meta);\r\n                            }\r\n\r\n                            // toggle sort\r\n                            sort = typeof sort === 'undefined' || sort === 'desc' ?\r\n                                'asc' :\r\n                                'desc';\r\n\r\n                            // update field and sort params\r\n                            meta = { field: field, sort: sort };\r\n                            Plugin.setDataSourceParam('sort', meta);\r\n\r\n                            sortObj.setIcon();\r\n\r\n                            setTimeout(function() {\r\n                                Plugin.dataRender('sort');\r\n                                $(datatable).trigger('m-datatable--on-sort', meta);\r\n                            }, 300);\r\n                        }\r\n                    },\r\n                };\r\n                sortObj.init();\r\n            },\r\n\r\n            /**\r\n             * Update JSON data list linked with sort, filter and pagination.\r\n             * Call this method, before using dataSet variable.\r\n             * @returns {*|null}\r\n             */\r\n            localDataUpdate: function() {\r\n                // todo; fix twice execution\r\n                var params = Plugin.getDataSourceParam();\r\n                if (typeof datatable.originalDataSet === 'undefined') {\r\n                    datatable.originalDataSet = datatable.dataSet;\r\n                }\r\n\r\n                var field = Plugin.getObject('sort.field', params);\r\n                var sort = Plugin.getObject('sort.sort', params);\r\n                var column = Plugin.getColumnByField(field);\r\n                if (typeof column !== 'undefined' && Plugin.getOption('data.serverSorting') !== true) {\r\n                    if (typeof column.sortCallback === 'function') {\r\n                        datatable.dataSet = column.sortCallback(datatable.originalDataSet, sort, column);\r\n                    } else {\r\n                        datatable.dataSet = Plugin.sortCallback(datatable.originalDataSet, sort, column);\r\n                    }\r\n                } else {\r\n                    datatable.dataSet = datatable.originalDataSet;\r\n                }\r\n\r\n                // if server filter enable, don't pass local filter\r\n                if (typeof params.query === 'object' && !Plugin.getOption('data.serverFiltering')) {\r\n                    params.query = params.query || {};\r\n\r\n                    var nestedSearch = function(obj) {\r\n                        for (var field in obj) {\r\n                            if (!obj.hasOwnProperty(field)) continue;\r\n                            if (typeof obj[field] === 'string') {\r\n                                if (obj[field].toLowerCase() == search || obj[field].toLowerCase().indexOf(search) !== -1) {\r\n                                    return true;\r\n                                }\r\n                            } else if (typeof obj[field] === 'number') {\r\n                                if (obj[field] === search) {\r\n                                    return true;\r\n                                }\r\n                            } else if (typeof obj[field] === 'object') {\r\n                                return nestedSearch(obj[field]);\r\n                            }\r\n                        }\r\n                        return false;\r\n                    };\r\n\r\n                    var search = $(Plugin.getOption('search.input')).val();\r\n                    if (typeof search !== 'undefined' && search !== '') {\r\n                        search = search.toLowerCase();\r\n                        datatable.dataSet = $.grep(datatable.dataSet, nestedSearch);\r\n                        // remove generalSearch as we don't need this for next columns filter\r\n                        delete params.query[Plugin.getGeneralSearchKey()];\r\n                    }\r\n\r\n                    // remove empty element from array\r\n                    $.each(params.query, function(k, v) {\r\n                        if (v === '') {\r\n                            delete params.query[k];\r\n                        }\r\n                    });\r\n\r\n                    // filter array by query\r\n                    datatable.dataSet = Plugin.filterArray(datatable.dataSet, params.query);\r\n\r\n                    // reset array index\r\n                    datatable.dataSet = datatable.dataSet.filter(function() {\r\n                        return true;\r\n                    });\r\n                }\r\n\r\n                return datatable.dataSet;\r\n            },\r\n\r\n            /**\r\n             * Utility helper to filter array by object pair of {key:value}\r\n             * @param list\r\n             * @param args\r\n             * @param operator\r\n             * @returns {*}\r\n             */\r\n            filterArray: function(list, args, operator) {\r\n                if (typeof list !== 'object') {\r\n                    return [];\r\n                }\r\n\r\n                if (typeof operator === 'undefined') operator = 'AND';\r\n\r\n                if (typeof args !== 'object') {\r\n                    return list;\r\n                }\r\n\r\n                operator = operator.toUpperCase();\r\n\r\n                if ($.inArray(operator, ['AND', 'OR', 'NOT']) === -1) {\r\n                    return [];\r\n                }\r\n\r\n                var count = Object.keys(args).length;\r\n                var filtered = [];\r\n\r\n                $.each(list, function(key, obj) {\r\n                    var to_match = obj;\r\n\r\n                    var matched = 0;\r\n                    $.each(args, function(m_key, m_value) {\r\n                        m_value = m_value instanceof Array ? m_value : [m_value];\r\n                        if (to_match.hasOwnProperty(m_key)) {\r\n                            var lhs = to_match[m_key].toString().toLowerCase();\r\n                            m_value.forEach(function(item, index) {\r\n                                if (item.toString().toLowerCase() == lhs || lhs.indexOf(item.toString().toLowerCase()) !== -1) {\r\n                                    matched++;\r\n                                }\r\n                            });\r\n                        }\r\n                    });\r\n\r\n                    if (('AND' == operator && matched == count) ||\r\n                        ('OR' == operator && matched > 0) ||\r\n                        ('NOT' == operator && 0 == matched)) {\r\n                        filtered[key] = obj;\r\n                    }\r\n                });\r\n\r\n                list = filtered;\r\n\r\n                return list;\r\n            },\r\n\r\n            /**\r\n             * Reset lock column scroll to 0 when resize\r\n             */\r\n            resetScroll: function() {\r\n                if (typeof options.detail === 'undefined' && Plugin.getDepth() === 1) {\r\n                    if (mUtil.isRTL()) {\r\n                        $(datatable.table).find('.m-datatable__row').css('right', 0);\r\n                    } else {\r\n                        $(datatable.table).find('.m-datatable__row').css('left', 0);\r\n                    }\r\n                    $(datatable.table).find('.m-datatable__lock').css('top', 0);\r\n                    $(datatable.tableBody).scrollTop(0);\r\n                }\r\n            },\r\n\r\n            /**\r\n             * Get column options by field\r\n             * @param field\r\n             * @returns {boolean}\r\n             */\r\n            getColumnByField: function(field) {\r\n                if (typeof field === 'undefined') return;\r\n                var result;\r\n                $.each(options.columns, function(i, column) {\r\n                    if (field === column.field) {\r\n                        result = column;\r\n                        return false;\r\n                    }\r\n                });\r\n                return result;\r\n            },\r\n\r\n            /**\r\n             * Get default sort column\r\n             */\r\n            getDefaultSortColumn: function() {\r\n                var result;\r\n                $.each(options.columns, function(i, column) {\r\n                    if (typeof column.sortable !== 'undefined' &&\r\n                        $.inArray(column.sortable, ['asc', 'desc']) !== -1) {\r\n                        result = { sort: column.sortable, field: column.field };\r\n                        return false;\r\n                    }\r\n                });\r\n                return result;\r\n            },\r\n\r\n            /**\r\n             * Helper to get element dimensions, when the element is hidden\r\n             * @param element\r\n             * @param includeMargin\r\n             * @returns {{width: number, height: number, innerWidth: number,\r\n             *     innerHeight: number, outerWidth: number, outerHeight: number}}\r\n             */\r\n            getHiddenDimensions: function(element, includeMargin) {\r\n                var props = {\r\n                        position: 'absolute',\r\n                        visibility: 'hidden',\r\n                        display: 'block',\r\n                    },\r\n                    dim = {\r\n                        width: 0,\r\n                        height: 0,\r\n                        innerWidth: 0,\r\n                        innerHeight: 0,\r\n                        outerWidth: 0,\r\n                        outerHeight: 0,\r\n                    },\r\n                    hiddenParents = $(element).parents().addBack().not(':visible');\r\n                includeMargin = (typeof includeMargin === 'boolean') ?\r\n                    includeMargin :\r\n                    false;\r\n\r\n                var oldProps = [];\r\n                hiddenParents.each(function() {\r\n                    var old = {};\r\n\r\n                    for (var name in props) {\r\n                        old[name] = this.style[name];\r\n                        this.style[name] = props[name];\r\n                    }\r\n\r\n                    oldProps.push(old);\r\n                });\r\n\r\n                dim.width = $(element).width();\r\n                dim.outerWidth = $(element).outerWidth(includeMargin);\r\n                dim.innerWidth = $(element).innerWidth();\r\n                dim.height = $(element).height();\r\n                dim.innerHeight = $(element).innerHeight();\r\n                dim.outerHeight = $(element).outerHeight(includeMargin);\r\n\r\n                hiddenParents.each(function(i) {\r\n                    var old = oldProps[i];\r\n                    for (var name in props) {\r\n                        this.style[name] = old[name];\r\n                    }\r\n                });\r\n\r\n                return dim;\r\n            },\r\n\r\n            getGeneralSearchKey: function() {\r\n                var searchInput = $(Plugin.getOption('search.input'));\r\n                return $(searchInput).prop('name') || $(searchInput).prop('id');\r\n            },\r\n\r\n            /**\r\n             * Get value by dot notation path string and to prevent undefined errors\r\n             * @param path String Dot notation path in string\r\n             * @param object Object to iterate\r\n             * @returns {*}\r\n             */\r\n            getObject: function(path, object) {\r\n                return path.split('.').reduce(function(obj, i) {\r\n                    return obj !== null && typeof obj[i] !== 'undefined' ? obj[i] : null;\r\n                }, object);\r\n            },\r\n\r\n            /**\r\n             * Extend object\r\n             * @param obj\r\n             * @param path\r\n             * @param value\r\n             * @returns {*}\r\n             */\r\n            extendObj: function(obj, path, value) {\r\n                var levels = path.split('.'),\r\n                    i = 0;\r\n\r\n                function createLevel(child) {\r\n                    var name = levels[i++];\r\n                    if (typeof child[name] !== 'undefined' && child[name] !== null) {\r\n                        if (typeof child[name] !== 'object' &&\r\n                            typeof child[name] !== 'function') {\r\n                            child[name] = {};\r\n                        }\r\n                    } else {\r\n                        child[name] = {};\r\n                    }\r\n                    if (i === levels.length) {\r\n                        child[name] = value;\r\n                    } else {\r\n                        createLevel(child[name]);\r\n                    }\r\n                }\r\n\r\n                createLevel(obj);\r\n                return obj;\r\n            },\r\n\r\n            rowEvenOdd: function() {\r\n                // row even class\r\n                $(datatable.tableBody).find('.m-datatable__row').removeClass('m-datatable__row--even');\r\n                if ($(datatable.wrap).hasClass('m-datatable--subtable')) {\r\n                    $(datatable.tableBody).find('.m-datatable__row:not(.m-datatable__row-detail):even').addClass('m-datatable__row--even');\r\n                } else {\r\n                    $(datatable.tableBody).find('.m-datatable__row:nth-child(even)').addClass('m-datatable__row--even');\r\n                }\r\n            },\r\n\r\n            /********************\r\n             ** PUBLIC API METHODS\r\n             ********************/\r\n\r\n            // delay timer\r\n            timer: 0,\r\n\r\n            /**\r\n             * Redraw datatable by recalculating its DOM elements, etc.\r\n             * @returns {jQuery}\r\n             */\r\n            redraw: function() {\r\n                Plugin.adjustCellsWidth.call();\r\n                if (Plugin.isLocked()) {\r\n                    // fix hiding cell width issue\r\n                    Plugin.scrollbar();\r\n                    Plugin.resetScroll();\r\n\r\n                    Plugin.adjustCellsHeight.call();\r\n                }\r\n                Plugin.adjustLockContainer.call();\r\n                Plugin.initHeight.call();\r\n                return datatable;\r\n            },\r\n\r\n            /**\r\n             * Shortcode to reload\r\n             * @returns {jQuery}\r\n             */\r\n            load: function() {\r\n                Plugin.reload();\r\n                return datatable;\r\n            },\r\n\r\n            /**\r\n             * Datasource reload\r\n             * @returns {jQuery}\r\n             */\r\n            reload: function() {\r\n                var delay = (function() {\r\n                    return function(callback, ms) {\r\n                        clearTimeout(Plugin.timer);\r\n                        Plugin.timer = setTimeout(callback, ms);\r\n                    };\r\n                })();\r\n                delay(function() {\r\n                    // local only. remote pagination will skip this block\r\n                    if (!options.data.serverFiltering) {\r\n                        Plugin.localDataUpdate();\r\n                    }\r\n                    Plugin.dataRender();\r\n                    $(datatable).trigger('m-datatable--on-reloaded');\r\n                }, Plugin.getOption('search.delay'));\r\n                return datatable;\r\n            },\r\n\r\n            /**\r\n             * Get record by record ID\r\n             * @param id\r\n             * @returns {jQuery}\r\n             */\r\n            getRecord: function(id) {\r\n                if (typeof datatable.tableBody === 'undefined') datatable.tableBody = $(datatable.table).children('tbody');\r\n                $(datatable.tableBody).find('.m-datatable__cell:first-child').each(function(i, cell) {\r\n                    if (id == $(cell).text()) {\r\n                        var rowNumber = $(cell).closest('.m-datatable__row').index() + 1;\r\n                        datatable.API.record = datatable.API.value = Plugin.getOneRow(datatable.tableBody, rowNumber);\r\n                        return datatable;\r\n                    }\r\n                });\r\n                return datatable;\r\n            },\r\n\r\n            /**\r\n             * @deprecated in v5.0.6\r\n             * Get column of current record ID\r\n             * @param columnName\r\n             * @returns {jQuery}\r\n             */\r\n            getColumn: function(columnName) {\r\n                Plugin.setSelectedRecords();\r\n                datatable.API.value = $(datatable.API.record).find('[data-field=\"' + columnName + '\"]');\r\n                return datatable;\r\n            },\r\n\r\n            /**\r\n             * Destroy datatable to original DOM state before datatable was\r\n             * initialized\r\n             * @returns {jQuery}\r\n             */\r\n            destroy: function() {\r\n                $(datatable).parent().find('.m-datatable__pager').remove();\r\n                var initialDatatable = $(datatable.initialDatatable).addClass('m-datatable--destroyed').show();\r\n                $(datatable).replaceWith(initialDatatable);\r\n                datatable = initialDatatable;\r\n                $(datatable).trigger('m-datatable--on-destroy');\r\n                Plugin.isInit = false;\r\n                initialDatatable = null;\r\n                return initialDatatable;\r\n            },\r\n\r\n            /**\r\n             * Sort by column field\r\n             * @param field\r\n             * @param sort\r\n             */\r\n            sort: function(field, sort) {\r\n                // toggle sort\r\n                sort = typeof sort === 'undefined' ? 'asc' : sort;\r\n\r\n                Plugin.spinnerCallback(true);\r\n\r\n                // update field and sort params\r\n                var meta = { field: field, sort: sort };\r\n                Plugin.setDataSourceParam('sort', meta);\r\n\r\n                setTimeout(function() {\r\n                    Plugin.dataRender('sort');\r\n                    $(datatable).trigger('m-datatable--on-sort', meta);\r\n                    $(datatable.tableHead).find('.m-datatable__cell > span > i').remove();\r\n                }, 300);\r\n\r\n                return datatable;\r\n            },\r\n\r\n            /**\r\n             * @deprecated in v5.0.6\r\n             * Get current selected column value\r\n             * @returns {jQuery}\r\n             */\r\n            getValue: function() {\r\n                return $(datatable.API.value).text();\r\n            },\r\n\r\n            /**\r\n             * Set checkbox active\r\n             * @param cell JQuery selector or checkbox ID\r\n             */\r\n            setActive: function(cell) {\r\n                if (typeof cell === 'string') {\r\n                    // set by checkbox id\r\n                    cell = $(datatable.tableBody).find('.m-checkbox--single > [type=\"checkbox\"][value=\"' + cell + '\"]');\r\n                }\r\n\r\n                $(cell).prop('checked', true);\r\n\r\n                // normal table\r\n                var row = $(cell).closest('.m-datatable__row').addClass('m-datatable__row--active');\r\n\r\n                var index = $(row).index() + 1;\r\n                // lock table\r\n                $(row).closest('.m-datatable__lock').parent().find('.m-datatable__row:nth-child(' + index + ')').addClass('m-datatable__row--active');\r\n\r\n                var ids = [];\r\n                $(row).each(function(i, td) {\r\n                    var id = $(td).find('.m-checkbox--single:not(.m-checkbox--all) > [type=\"checkbox\"]').val();\r\n                    if (typeof id !== 'undefined') {\r\n                        ids.push(id);\r\n                    }\r\n                });\r\n\r\n                $(datatable).trigger('m-datatable--on-check', [ids]);\r\n            },\r\n\r\n            /**\r\n             * Set checkbox inactive\r\n             * @param cell JQuery selector or checkbox ID\r\n             */\r\n            setInactive: function(cell) {\r\n                if (typeof cell === 'string') {\r\n                    // set by checkbox id\r\n                    cell = $(datatable.tableBody).find('.m-checkbox--single > [type=\"checkbox\"][value=\"' + cell + '\"]');\r\n                }\r\n\r\n                $(cell).prop('checked', false);\r\n\r\n                // normal table\r\n                var row = $(cell).closest('.m-datatable__row').removeClass('m-datatable__row--active');\r\n                var index = $(row).index() + 1;\r\n\r\n                // lock table\r\n                $(row).closest('.m-datatable__lock').parent().find('.m-datatable__row:nth-child(' + index + ')').removeClass('m-datatable__row--active');\r\n\r\n                var ids = [];\r\n                $(row).each(function(i, td) {\r\n                    var id = $(td).find('.m-checkbox--single:not(.m-checkbox--all) > [type=\"checkbox\"]').val();\r\n                    if (typeof id !== 'undefined') {\r\n                        ids.push(id);\r\n                    }\r\n                });\r\n\r\n                $(datatable).trigger('m-datatable--on-uncheck', [ids]);\r\n            },\r\n\r\n            /**\r\n             * Set all checkboxes active or inactive\r\n             * @param active\r\n             */\r\n            setActiveAll: function(active) {\r\n                // todo; check if child table also will set active?\r\n                var checkboxes = $(datatable.table).find('.m-datatable__body .m-datatable__row').find('.m-datatable__cell--check .m-checkbox [type=\"checkbox\"]');\r\n                if (active) {\r\n                    Plugin.setActive(checkboxes);\r\n                } else {\r\n                    Plugin.setInactive(checkboxes);\r\n                }\r\n            },\r\n\r\n            /**\r\n             * @deprecated in v5.0.6\r\n             * Get selected rows which are active\r\n             * @returns {jQuery}\r\n             */\r\n            setSelectedRecords: function() {\r\n                datatable.API.record = $(datatable.tableBody).find('.m-datatable__row--active');\r\n                return datatable;\r\n            },\r\n\r\n            /**\r\n             * Get selected records\r\n             * @returns {null}\r\n             */\r\n            getSelectedRecords: function() {\r\n                // support old method\r\n                Plugin.setSelectedRecords();\r\n                datatable.API.record = datatable.rows('.m-datatable__row--active').nodes();\r\n                return datatable.API.record;\r\n            },\r\n\r\n            /**\r\n             * Get options by dots notation path\r\n             * @param path String Dot notation path in string\r\n             * @returns {*}\r\n             */\r\n            getOption: function(path) {\r\n                return Plugin.getObject(path, options);\r\n            },\r\n\r\n            /**\r\n             * Set global options nodes by dots notation path\r\n             * @param path\r\n             * @param object\r\n             */\r\n            setOption: function(path, object) {\r\n                options = Plugin.extendObj(options, path, object);\r\n            },\r\n\r\n            /**\r\n             * Search filter for local & remote\r\n             * @param value\r\n             * @param columns. Optional list of columns to be filtered.\r\n             */\r\n            search: function(value, columns) {\r\n                if (typeof columns !== 'undefined') columns = $.makeArray(columns);\r\n                var delay = (function() {\r\n                    return function(callback, ms) {\r\n                        clearTimeout(Plugin.timer);\r\n                        Plugin.timer = setTimeout(callback, ms);\r\n                    };\r\n                })();\r\n\r\n                delay(function() {\r\n                    // get query parameters\r\n                    var query = Plugin.getDataSourceQuery();\r\n\r\n                    // search not by columns\r\n                    if (typeof columns === 'undefined' && typeof value !== 'undefined') {\r\n                        var key = Plugin.getGeneralSearchKey();\r\n                        query[key] = value;\r\n                    }\r\n\r\n                    // search by columns, support multiple columns\r\n                    if (typeof columns === 'object') {\r\n                        $.each(columns, function(k, column) {\r\n                            query[column] = value;\r\n                        });\r\n                        // remove empty element from arrays\r\n                        $.each(query, function(k, v) {\r\n                            if (v === '' || $.isEmptyObject(v)) {\r\n                                delete query[k];\r\n                            }\r\n                        });\r\n                    }\r\n\r\n                    Plugin.setDataSourceQuery(query);\r\n\r\n                    // local filter only. remote pagination will skip this block\r\n                    if (!options.data.serverFiltering) {\r\n                        Plugin.localDataUpdate();\r\n                    }\r\n                    Plugin.dataRender('search');\r\n                }, Plugin.getOption('search.delay'));\r\n            },\r\n\r\n            /**\r\n             * Set datasource paramsextractextract\r\n             * @param param\r\n             * @param value\r\n             */\r\n            setDataSourceParam: function(param, value) {\r\n                datatable.API.params = $.extend({}, {\r\n                    pagination: { page: 1, perpage: Plugin.getOption('data.pageSize') },\r\n                    sort: Plugin.getDefaultSortColumn(),\r\n                    query: {},\r\n                }, datatable.API.params, Plugin.stateGet(Plugin.stateId));\r\n\r\n                datatable.API.params = Plugin.extendObj(datatable.API.params, param, value);\r\n\r\n                Plugin.stateKeep(Plugin.stateId, datatable.API.params);\r\n            },\r\n\r\n            /**\r\n             * Get datasource params\r\n             * @param param\r\n             */\r\n            getDataSourceParam: function(param) {\r\n                datatable.API.params = $.extend({}, {\r\n                    pagination: { page: 1, perpage: Plugin.getOption('data.pageSize') },\r\n                    sort: Plugin.getDefaultSortColumn(),\r\n                    query: {},\r\n                }, datatable.API.params, Plugin.stateGet(Plugin.stateId));\r\n\r\n                if (typeof param === 'string') {\r\n                    return Plugin.getObject(param, datatable.API.params);\r\n                }\r\n\r\n                return datatable.API.params;\r\n            },\r\n\r\n            /**\r\n             * Shortcode to datatable.getDataSourceParam('query');\r\n             * @returns {*}\r\n             */\r\n            getDataSourceQuery: function() {\r\n                return Plugin.getDataSourceParam('query') || {};\r\n            },\r\n\r\n            /**\r\n             * Shortcode to datatable.setDataSourceParam('query', query);\r\n             * @param query\r\n             */\r\n            setDataSourceQuery: function(query) {\r\n                Plugin.setDataSourceParam('query', query);\r\n            },\r\n\r\n            /**\r\n             * Get current page number\r\n             * @returns {number}\r\n             */\r\n            getCurrentPage: function() {\r\n                return $(datatable.table).siblings('.m-datatable__pager').last().find('.m-datatable__pager-nav').find('.m-datatable__pager-link.m-datatable__pager-link--active').data('page') || 1;\r\n            },\r\n\r\n            /**\r\n             * Get selected dropdown page size\r\n             * @returns {*|number}\r\n             */\r\n            getPageSize: function() {\r\n                return $(datatable.table).siblings('.m-datatable__pager').last().find('select.m-datatable__pager-size').val() || 10;\r\n            },\r\n\r\n            /**\r\n             * Get total rows\r\n             */\r\n            getTotalRows: function() {\r\n                return datatable.API.params.pagination.total;\r\n            },\r\n\r\n            /**\r\n             * Get full dataset in grid\r\n             * @returns {*|null|Array}\r\n             */\r\n            getDataSet: function() {\r\n                return datatable.originalDataSet;\r\n            },\r\n\r\n            /**\r\n             * @deprecated in v5.0.6\r\n             * Hide column by column's field name\r\n             * @param fieldName\r\n             */\r\n            hideColumn: function(fieldName) {\r\n                // add hide option for this column\r\n                $.map(options.columns, function(column) {\r\n                    if (fieldName === column.field) {\r\n                        column.responsive = { hidden: 'xl' };\r\n                    }\r\n                    return column;\r\n                });\r\n                // hide current displayed column\r\n                var tds = $.grep($(datatable.table).find('.m-datatable__cell'), function(n, i) {\r\n                    return fieldName === $(n).data('field');\r\n                });\r\n                $(tds).hide();\r\n            },\r\n\r\n            /**\r\n             * @deprecated in v5.0.6\r\n             * Show column by column's field name\r\n             * @param fieldName\r\n             */\r\n            showColumn: function(fieldName) {\r\n                // add hide option for this column\r\n                $.map(options.columns, function(column) {\r\n                    if (fieldName === column.field) {\r\n                        delete column.responsive;\r\n                    }\r\n                    return column;\r\n                });\r\n                // hide current displayed column\r\n                var tds = $.grep($(datatable.table).find('.m-datatable__cell'), function(n, i) {\r\n                    return fieldName === $(n).data('field');\r\n                });\r\n                $(tds).show();\r\n            },\r\n\r\n            nodeTr: [],\r\n            nodeTd: [],\r\n            nodeCols: [],\r\n            recentNode: [],\r\n\r\n            table: function() {\r\n                return datatable.table;\r\n            },\r\n\r\n            /**\r\n             * Select a single row from the table\r\n             * @param selector\r\n             * @returns {jQuery}\r\n             */\r\n            row: function(selector) {\r\n                Plugin.rows(selector);\r\n                Plugin.nodeTr = Plugin.recentNode = $(Plugin.nodeTr).first();\r\n                return datatable;\r\n            },\r\n\r\n            /**\r\n             * Select multiple rows from the table\r\n             * @param selector\r\n             * @returns {jQuery}\r\n             */\r\n            rows: function(selector) {\r\n                if (Plugin.isLocked()) {\r\n                    Plugin.nodeTr = Plugin.recentNode = $(datatable.tableBody).children().first().find(selector).filter('.m-datatable__row');\r\n                } else {\r\n                    Plugin.nodeTr = Plugin.recentNode = $(datatable.tableBody).find(selector).filter('.m-datatable__row');\r\n                }\r\n                return datatable;\r\n            },\r\n\r\n            /**\r\n             * Select a single column from the table\r\n             * @param index zero-based index\r\n             * @returns {jQuery}\r\n             */\r\n            column: function(index) {\r\n                if (Plugin.isLocked()) {\r\n                    Plugin.nodeCols = Plugin.recentNode = $(datatable.tableBody).children().first().find('.m-datatable__cell:nth-child(' + (index + 1) + ')');\r\n                } else {\r\n                    Plugin.nodeCols = Plugin.recentNode = $(datatable.tableBody).find('.m-datatable__cell:nth-child(' + (index + 1) + ')');\r\n                }\r\n                return datatable;\r\n            },\r\n\r\n            /**\r\n             * Select multiple columns from the table\r\n             * @param selector\r\n             * @returns {jQuery}\r\n             */\r\n            columns: function(selector) {\r\n                var context = datatable.table;\r\n                if (Plugin.nodeTr === Plugin.recentNode) {\r\n                    context = Plugin.nodeTr;\r\n                }\r\n                var columns = $(context).find('.m-datatable__cell[data-field=\"' + selector + '\"]');\r\n                if (columns.length > 0) {\r\n                    Plugin.nodeCols = Plugin.recentNode = columns;\r\n                } else {\r\n                    Plugin.nodeCols = Plugin.recentNode = $(context).find(selector).filter('.m-datatable__cell');\r\n                }\r\n                return datatable;\r\n            },\r\n\r\n            cell: function(selector) {\r\n                Plugin.cells(selector);\r\n                Plugin.nodeTd = Plugin.recentNode = $(Plugin.nodeTd).first();\r\n                return datatable;\r\n            },\r\n\r\n            cells: function(selector) {\r\n                var cells = $(datatable.tableBody).find('.m-datatable__cell');\r\n                if (typeof selector !== 'undefined') {\r\n                    cells = $(cells).filter(selector);\r\n                }\r\n                Plugin.nodeTd = Plugin.recentNode = cells;\r\n                return datatable;\r\n            },\r\n\r\n            /**\r\n             * Delete the selected row from the table\r\n             * @returns {jQuery}\r\n             */\r\n            remove: function() {\r\n                if ($(Plugin.nodeTr.length) && Plugin.nodeTr === Plugin.recentNode) {\r\n                    $(Plugin.nodeTr).remove();\r\n                }\r\n                Plugin.layoutUpdate();\r\n                return datatable;\r\n            },\r\n\r\n            /**\r\n             * Show or hide the columns or rows\r\n             */\r\n            visible: function(bool) {\r\n                if ($(Plugin.recentNode.length)) {\r\n                    var locked = Plugin.lockEnabledColumns();\r\n                    if (Plugin.recentNode === Plugin.nodeCols) {\r\n                        var index = Plugin.recentNode.index();\r\n\r\n                        if (Plugin.isLocked()) {\r\n                            var scrollColumns = $(Plugin.recentNode).closest('.m-datatable__lock--scroll').length;\r\n                            if (scrollColumns) {\r\n                                // is at center of scrollable area\r\n                                index += locked.left.length + 1;\r\n                            } else if ($(Plugin.recentNode).closest('.m-datatable__lock--right').length) {\r\n                                // is at the right locked table\r\n                                index += locked.left.length + scrollColumns + 1;\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    if (bool) {\r\n                        if (Plugin.recentNode === Plugin.nodeCols) {\r\n                            delete options.columns[index].responsive;\r\n                        }\r\n                        $(Plugin.recentNode).show();\r\n                    } else {\r\n                        if (Plugin.recentNode === Plugin.nodeCols) {\r\n                            Plugin.setOption('columns.' + index + '.responsive', { hidden: 'xl' });\r\n                        }\r\n                        $(Plugin.recentNode).hide();\r\n                    }\r\n                    Plugin.redraw();\r\n                }\r\n            },\r\n\r\n            /**\r\n             * Get the the DOM element for the selected rows or columns\r\n             * @returns {Array}\r\n             */\r\n            nodes: function() {\r\n                return Plugin.recentNode;\r\n            },\r\n\r\n            /**\r\n             * will be implemented soon\r\n             * @returns {jQuery}\r\n             */\r\n            dataset: function() {\r\n                return datatable;\r\n            },\r\n\r\n        };\r\n\r\n        /**\r\n         * Public API methods can be used directly by datatable\r\n         */\r\n        $.each(Plugin, function(funcName, func) {\r\n            datatable[funcName] = func;\r\n        });\r\n\r\n        // initialize main datatable plugin\r\n        if (typeof options !== 'undefined') {\r\n            if (typeof options === 'string') {\r\n                var method = options;\r\n                datatable = $(this).data('mDatatable');\r\n                if (typeof datatable !== 'undefined') {\r\n                    options = datatable.options;\r\n                    Plugin[method].apply(this, Array.prototype.slice.call(arguments, 1));\r\n                }\r\n            } else {\r\n                if (!datatable.data('mDatatable') && !$(this).hasClass('m-datatable--loaded')) {\r\n                    datatable.dataSet = null;\r\n                    datatable.textAlign = {\r\n                        left: 'm-datatable__cell--left',\r\n                        center: 'm-datatable__cell--center',\r\n                        right: 'm-datatable__cell--right',\r\n                    };\r\n\r\n                    // merge default and user defined options\r\n                    options = $.extend(true, {}, $.fn.mDatatable.defaults, options);\r\n\r\n                    datatable.options = options;\r\n\r\n                    // init plugin process\r\n                    Plugin.init.apply(this, [options]);\r\n\r\n                    $(datatable.wrap).data('mDatatable', datatable);\r\n                }\r\n            }\r\n        } else {\r\n            // get existing instance datatable\r\n            datatable = $(this).data('mDatatable');\r\n            if (typeof datatable === 'undefined') {\r\n                $.error('mDatatable not initialized');\r\n            }\r\n            options = datatable.options;\r\n        }\r\n\r\n        return datatable;\r\n    };\r\n\r\n    // default options\r\n    $.fn.mDatatable.defaults = {\r\n        // datasource definition\r\n        data: {\r\n            type: 'local',\r\n            source: null,\r\n            pageSize: 10, // display records per page\r\n            saveState: {\r\n                // save datatable state(pagination, filtering, sorting, etc) in cookie or browser webstorage\r\n                cookie: false,\r\n                webstorage: true,\r\n            },\r\n\r\n            serverPaging: false,\r\n            serverFiltering: false,\r\n            serverSorting: false,\r\n\r\n            autoColumns: false,\r\n            attr: {\r\n                rowProps: [],\r\n            },\r\n        },\r\n\r\n        // layout definition\r\n        layout: {\r\n            theme: 'default', // datatable will support multiple themes and designs\r\n            class: 'm-datatable--brand', // custom wrapper class\r\n            scroll: false, // enable/disable datatable scroll both horizontal and vertical when needed.\r\n            height: null, // datatable's body's fixed height\r\n            minHeight: 300,\r\n            footer: false, // display/hide footer\r\n            header: true, // display/hide header\r\n            customScrollbar: true, // set false to disable custom scrollbar\r\n\r\n            // datatable spinner\r\n            spinner: {\r\n                overlayColor: '#000000',\r\n                opacity: 0,\r\n                type: 'loader',\r\n                state: 'brand',\r\n                message: true,\r\n            },\r\n\r\n            // datatable UI icons\r\n            icons: {\r\n                sort: { asc: 'la la-arrow-up', desc: 'la la-arrow-down' },\r\n                pagination: {\r\n                    next: 'la la-angle-right',\r\n                    prev: 'la la-angle-left',\r\n                    first: 'la la-angle-double-left',\r\n                    last: 'la la-angle-double-right',\r\n                    more: 'la la-ellipsis-h',\r\n                },\r\n                rowDetail: { expand: 'fa fa-caret-down', collapse: 'fa fa-caret-right' },\r\n            },\r\n        },\r\n\r\n        // column sorting\r\n        sortable: true,\r\n\r\n        // resize column size with mouse drag coming soon)\r\n        resizable: false,\r\n\r\n        // column based filtering (coming soon)\r\n        filterable: false,\r\n\r\n        pagination: true,\r\n\r\n        // inline and bactch editing (cooming soon)\r\n        editable: false,\r\n\r\n        // columns definition\r\n        columns: [],\r\n\r\n        search: {\r\n            // enable trigger search by keyup enter\r\n            onEnter: false,\r\n            // input text for search\r\n            input: null,\r\n            // search delay in milliseconds\r\n            delay: 400,\r\n        },\r\n\r\n        rows: {\r\n            // deprecated\r\n            callback: function() {},\r\n            // call before row template\r\n            beforeTemplate: function() {},\r\n            // call after row template\r\n            afterTemplate: function() {},\r\n            // auto hide columns, if rows overflow. work on non locked columns\r\n            autoHide: false,\r\n        },\r\n\r\n        // toolbar\r\n        toolbar: {\r\n            // place pagination and displayInfo blocks according to the array order\r\n            layout: ['pagination', 'info'],\r\n\r\n            // toolbar placement can be at top or bottom or both top and bottom repeated\r\n            placement: ['bottom'], //'top', 'bottom'\r\n\r\n            // toolbar items\r\n            items: {\r\n                // pagination\r\n                pagination: {\r\n                    // pagination type(default or scroll)\r\n                    type: 'default',\r\n\r\n                    // number of pages to display by breakpoints\r\n                    pages: {\r\n                        desktop: {\r\n                            layout: 'default',\r\n                            pagesNumber: 6,\r\n                        },\r\n                        tablet: {\r\n                            layout: 'default',\r\n                            pagesNumber: 3,\r\n                        },\r\n                        mobile: {\r\n                            layout: 'compact',\r\n                        },\r\n                    },\r\n\r\n                    // navigation buttons\r\n                    navigation: {\r\n                        prev: true, // display prev link\r\n                        next: true, // display next link\r\n                        first: true, // display first link\r\n                        last: true // display last link\r\n                    },\r\n\r\n                    // page size select\r\n                    pageSizeSelect: [] // display dropdown to select pagination size. -1 is used for \"ALl\" option\r\n                },\r\n\r\n                // records info\r\n                info: true,\r\n            },\r\n        },\r\n\r\n        // here we will keep all strings and message used by datatable UI so developer can easiliy translate to any language.\r\n        // By default the stirngs will be in the plugin source and here can override it\r\n        translate: {\r\n            records: {\r\n                processing: 'Please wait...',\r\n                noRecords: 'No records found',\r\n            },\r\n            toolbar: {\r\n                pagination: {\r\n                    items: {\r\n                        default: {\r\n                            first: 'First',\r\n                            prev: 'Previous',\r\n                            next: 'Next',\r\n                            last: 'Last',\r\n                            more: 'More pages',\r\n                            input: 'Page number',\r\n                            select: 'Select page size',\r\n                        },\r\n                        info: 'Displaying {{start}} - {{end}} of {{total}} records',\r\n                    },\r\n                },\r\n            },\r\n        },\r\n\r\n        extensions: {},\r\n    };\r\n\r\n}(jQuery));\nvar defaults = {\r\n\tlayout: {\r\n\t\ticons: {\r\n\t\t\tpagination: {\r\n\t\t\t\tnext: 'la la-angle-right',\r\n\t\t\t\tprev: 'la la-angle-left',\r\n\t\t\t\tfirst: 'la la-angle-double-left',\r\n\t\t\t\tlast: 'la la-angle-double-right',\r\n\t\t\t\tmore: 'la la-ellipsis-h',\r\n\t\t\t},\r\n\t\t\trowDetail: {expand: 'fa fa-caret-down', collapse: 'fa fa-caret-right'},\r\n\t\t}\r\n\t}\r\n};\r\n\r\nif (mUtil.isRTL()) {\r\n\tdefaults = {\r\n\t\tlayout: {\r\n\t\t\ticons: {\r\n\t\t\t\tpagination: {\r\n\t\t\t\t\tnext: 'la la-angle-left',\r\n\t\t\t\t\tprev: 'la la-angle-right',\r\n\t\t\t\t\tlast: 'la la-angle-double-left',\r\n\t\t\t\t\tfirst: 'la la-angle-double-right',\r\n\t\t\t\t},\r\n\t\t\t\trowDetail: {collapse: 'fa fa-caret-down', expand: 'fa fa-caret-right'},\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n$.extend(true, $.fn.mDatatable.defaults, defaults);\n(function ($) {\r\n\r\n\t$.fn.mDatatable = $.fn.mDatatable || {};\r\n\r\n\t/**\r\n\t * @param datatable Main datatable plugin instance\r\n\t * @param options Extension options\r\n\t * @returns {*}\r\n\t */\r\n\t$.fn.mDatatable.checkbox = function (datatable, options) {\r\n\r\n\t\tvar Extension = {\r\n\t\t\tselectedAllRows: false,\r\n\t\t\tselectedRows: [],\r\n\t\t\tunselectedRows: [],\r\n\r\n\t\t\tinit: function () {\r\n\t\t\t\tif (Extension.selectorEnabled()) {\r\n\t\t\t\t\t// reset\r\n\t\t\t\t\tdatatable.setDataSourceParam(options.vars.selectedAllRows, false);\r\n\t\t\t\t\tdatatable.stateRemove('checkbox');\r\n\r\n\t\t\t\t\t// requestIds is not null\r\n\t\t\t\t\tif (options.vars.requestIds) {\r\n\t\t\t\t\t\t// request ids in response\r\n\t\t\t\t\t\tdatatable.setDataSourceParam(options.vars.requestIds, true);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// remove selected checkbox on datatable reload\r\n\t\t\t\t\t$(datatable).on('m-datatable--on-reloaded', function () {\r\n\t\t\t\t\t\tdatatable.stateRemove('checkbox');\r\n\t\t\t\t\t\tdatatable.setDataSourceParam(options.vars.selectedAllRows, false);\r\n\t\t\t\t\t\tExtension.selectedAllRows = false;\r\n\t\t\t\t\t\tExtension.selectedRows = [];\r\n\t\t\t\t\t\tExtension.unselectedRows = [];\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// select all on extension init\r\n\t\t\t\t\tExtension.selectedAllRows = datatable.getDataSourceParam(options.vars.selectedAllRows);\r\n\r\n\t\t\t\t\t$(datatable).on('m-datatable--on-layout-updated', function (e, args) {\r\n\t\t\t\t\t\tif (args.table != $(datatable.wrap).attr('id')) return;\r\n\t\t\t\t\t\tdatatable.ready(function () {\r\n\t\t\t\t\t\t\tExtension.initVars();\r\n\t\t\t\t\t\t\tExtension.initEvent();\r\n\t\t\t\t\t\t\tExtension.initSelect();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t$(datatable).on('m-datatable--on-check', function (e, ids) {\r\n\t\t\t\t\t\tids.forEach(function (id) {\r\n\t\t\t\t\t\t\tExtension.selectedRows.push(id);\r\n\t\t\t\t\t\t\t// // remove from unselected rows\r\n\t\t\t\t\t\t\tExtension.unselectedRows = Extension.remove(Extension.unselectedRows, id);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tvar storage = {};\r\n\t\t\t\t\t\tstorage['selectedRows'] = $.unique(Extension.selectedRows);\r\n\t\t\t\t\t\tstorage['unselectedRows'] = $.unique(Extension.unselectedRows);\r\n\t\t\t\t\t\tdatatable.stateKeep('checkbox', storage);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t$(datatable).on('m-datatable--on-uncheck', function (e, ids) {\r\n\t\t\t\t\t\tids.forEach(function (id) {\r\n\t\t\t\t\t\t\tExtension.unselectedRows.push(id);\r\n\t\t\t\t\t\t\t// // remove from selected rows\r\n\t\t\t\t\t\t\tExtension.selectedRows = Extension.remove(Extension.selectedRows, id);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tvar storage = {};\r\n\t\t\t\t\t\tstorage['selectedRows'] = $.unique(Extension.selectedRows);\r\n\t\t\t\t\t\tstorage['unselectedRows'] = $.unique(Extension.unselectedRows);\r\n\t\t\t\t\t\tdatatable.stateKeep('checkbox', storage);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * Init checkbox clicks event\r\n\t\t\t */\r\n\t\t\tinitEvent: function () {\r\n\t\t\t\t// select all checkbox click\r\n\t\t\t\t$(datatable.tableHead).find('.m-checkbox--all > [type=\"checkbox\"]').click(function (e) {\r\n\t\t\t\t\t// clear selected and unselected rows\r\n\t\t\t\t\tExtension.selectedRows = Extension.unselectedRows = [];\r\n\t\t\t\t\tdatatable.stateRemove('checkbox');\r\n\r\n\t\t\t\t\t// select all rows\r\n\t\t\t\t\tif ($(this).is(':checked')) {\r\n\t\t\t\t\t\tExtension.selectedAllRows = true;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tExtension.selectedAllRows = false;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// local select all current page rows\r\n\t\t\t\t\tif (!options.vars.requestIds) {\r\n\t\t\t\t\t\tif ($(this).is(':checked')) {\r\n\t\t\t\t\t\t\tExtension.selectedRows = $.makeArray($(datatable.tableBody).find('.m-checkbox--single > [type=\"checkbox\"]').map(function (i, chk) {\r\n\t\t\t\t\t\t\t\treturn $(chk).val();\r\n\t\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar storage = {};\r\n\t\t\t\t\t\tstorage['selectedRows'] = $.unique(Extension.selectedRows);\r\n\t\t\t\t\t\tdatatable.stateKeep('checkbox', storage);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// keep selectedAllRows in datasource params\r\n\t\t\t\t\tdatatable.setDataSourceParam(options.vars.selectedAllRows, Extension.selectedAllRows);\r\n\r\n\t\t\t\t\t$(datatable).trigger('m-datatable--on-click-checkbox', [$(this)]);\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// single row checkbox click\r\n\t\t\t\t$(datatable.tableBody).find('.m-checkbox--single > [type=\"checkbox\"]').click(function (e) {\r\n\t\t\t\t\tvar id = $(this).val();\r\n\t\t\t\t\tif ($(this).is(':checked')) {\r\n\t\t\t\t\t\tExtension.selectedRows.push(id);\r\n\t\t\t\t\t\t// remove from unselected rows\r\n\t\t\t\t\t\tExtension.unselectedRows = Extension.remove(Extension.unselectedRows, id);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tExtension.unselectedRows.push(id);\r\n\t\t\t\t\t\t// remove from selected rows\r\n\t\t\t\t\t\tExtension.selectedRows = Extension.remove(Extension.selectedRows, id);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// local checkbox header check\r\n\t\t\t\t\tif (!options.vars.requestIds && Extension.selectedRows.length < 1) {\r\n\t\t\t\t\t\t// remove select all checkbox, if there is no checked checkbox left\r\n\t\t\t\t\t\t$(datatable.tableHead).find('.m-checkbox--all > [type=\"checkbox\"]').prop('checked', false);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar storage = {};\r\n\t\t\t\t\tstorage['selectedRows'] = $.unique(Extension.selectedRows);\r\n\t\t\t\t\tstorage['unselectedRows'] = $.unique(Extension.unselectedRows);\r\n\t\t\t\t\tdatatable.stateKeep('checkbox', storage);\r\n\r\n\t\t\t\t\t$(datatable).trigger('m-datatable--on-click-checkbox', [$(this)]);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\tinitSelect: function () {\r\n\t\t\t\t// selected all rows from server\r\n\t\t\t\tif (Extension.selectedAllRows && options.vars.requestIds) {\r\n\t\t\t\t\tif (!datatable.hasClass('m-datatable--error')) {\r\n\t\t\t\t\t\t// set header select all checkbox checked\r\n\t\t\t\t\t\t$(datatable.tableHead).find('.m-checkbox--all > [type=\"checkbox\"]').prop('checked', true);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// set all checkbox in table body\r\n\t\t\t\t\tdatatable.setActiveAll(true);\r\n\r\n\t\t\t\t\t// remove unselected rows\r\n\t\t\t\t\tExtension.unselectedRows.forEach(function (id) {\r\n\t\t\t\t\t\tdatatable.setInactive(id);\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// single check for server and local\r\n\t\t\t\t\tExtension.selectedRows.forEach(function (id) {\r\n\t\t\t\t\t\tdatatable.setActive(id);\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// local checkbox; check if all checkboxes of currect page are checked\r\n\t\t\t\t\tif (!datatable.hasClass('m-datatable--error') && $(datatable.tableBody).find('.m-checkbox--single > [type=\"checkbox\"]').not(':checked').length < 1) {\r\n\t\t\t\t\t\t// set header select all checkbox checked\r\n\t\t\t\t\t\t$(datatable.tableHead).find('.m-checkbox--all > [type=\"checkbox\"]').prop('checked', true);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * Check if selector is enabled from options\r\n\t\t\t */\r\n\t\t\tselectorEnabled: function () {\r\n\t\t\t\treturn $.grep(datatable.options.columns, function (n, i) {\r\n\t\t\t\t\treturn n.selector || false;\r\n\t\t\t\t})[0];\r\n\t\t\t},\r\n\r\n\t\t\tinitVars: function () {\r\n\t\t\t\t// get single select/unselect from localstorage\r\n\t\t\t\tvar storage = datatable.stateGet('checkbox');\r\n\t\t\t\tif (typeof storage !== 'undefined') {\r\n\t\t\t\t\tExtension.selectedRows = storage['selectedRows'] || [];\r\n\t\t\t\t\tExtension.unselectedRows = storage['unselectedRows'] || [];\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tgetSelectedId: function (path) {\r\n\t\t\t\tExtension.initVars();\r\n\r\n\t\t\t\t// server selected all rows\r\n\t\t\t\tif (Extension.selectedAllRows && options.vars.requestIds) {\r\n\t\t\t\t\tif (typeof path === 'undefined') path = options.vars.rowIds;\r\n\r\n\t\t\t\t\t// if selected all rows, return id from response meta\r\n\t\t\t\t\tvar selectedAllRows = datatable.getObject(path, datatable.lastResponse) || [];\r\n\r\n\t\t\t\t\tif (selectedAllRows.length > 0) {\r\n\t\t\t\t\t\t// remove single unselected rows from selectedAllRows ids from server response emta\r\n\t\t\t\t\t\tExtension.unselectedRows.forEach(function (id) {\r\n\t\t\t\t\t\t\tselectedAllRows = Extension.remove(selectedAllRows, parseInt(id));\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn selectedAllRows;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// else return single checked selected rows\r\n\t\t\t\treturn Extension.selectedRows;\r\n\t\t\t},\r\n\r\n\t\t\tremove: function (array, element) {\r\n\t\t\t\treturn array.filter(function (e) {\r\n\t\t\t\t\treturn e !== element;\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t};\r\n\r\n\t\t// make the extension accessible from datatable init\r\n\t\tdatatable.checkbox = function () {\r\n\t\t\treturn Extension;\r\n\t\t};\r\n\r\n\t\tif (typeof options === 'object') {\r\n\t\t\toptions = $.extend(true, {}, $.fn.mDatatable.checkbox.default, options);\r\n\t\t\tExtension.init.apply(this, [options]);\r\n\t\t}\r\n\r\n\t\treturn datatable;\r\n\t};\r\n\r\n\t$.fn.mDatatable.checkbox.default = {\r\n\t\tvars: {\r\n\t\t\t// select all rows flag to be sent to the server\r\n\t\t\tselectedAllRows: 'selectedAllRows',\r\n\t\t\t// request id parameter's name\r\n\t\t\trequestIds: 'requestIds',\r\n\t\t\t// response path to all rows id\r\n\t\t\trowIds: 'meta.rowIds',\r\n\t\t},\r\n\t};\r\n\r\n}(jQuery));\nvar mDropdown = function(elementId, options) {\r\n    //== Main object\r\n    var the = this;\r\n    var init = false;\r\n\r\n    //== Get element object\r\n    var element = mUtil.get(elementId);\r\n    var body = mUtil.get('body');\r\n\r\n    if (!element) {\r\n        return;\r\n    }\r\n\r\n    //== Default options\r\n    var defaultOptions = {\r\n        toggle: 'click',\r\n        hoverTimeout: 300,\r\n        skin: 'light',\r\n        height: 'auto',\r\n        maxHeight: false,\r\n        minHeight: false,\r\n        persistent: false,\r\n        mobileOverlay: true\r\n    };\r\n\r\n    ////////////////////////////\r\n    // ** Private Methods  ** //\r\n    ////////////////////////////\r\n\r\n    var Plugin = {\r\n        /**\r\n         * Run plugin\r\n         * @returns {mdropdown}\r\n         */\r\n        construct: function(options) {\r\n            if (mUtil.data(element).has('dropdown')) {\r\n                the = mUtil.data(element).get('dropdown');\r\n            } else {\r\n                // reset dropdown\r\n                Plugin.init(options);\r\n\r\n                Plugin.setup();\r\n\r\n                mUtil.data(element).set('dropdown', the);\r\n            }\r\n\r\n            return the;\r\n        },\r\n\r\n        /**\r\n         * Handles subdropdown click toggle\r\n         * @returns {mdropdown}\r\n         */\r\n        init: function(options) {\r\n            // merge default and user defined options\r\n            the.options = mUtil.deepExtend({}, defaultOptions, options);\r\n            the.events = [];\r\n            the.eventHandlers = {};\r\n            the.open = false;\r\n            \r\n            the.layout = {};\r\n            the.layout.close = mUtil.find(element, '.m-dropdown__close');\r\n            the.layout.toggle = mUtil.find(element, '.m-dropdown__toggle');\r\n            the.layout.arrow = mUtil.find(element, '.m-dropdown__arrow');\r\n            the.layout.wrapper = mUtil.find(element, '.m-dropdown__wrapper');\r\n            the.layout.defaultDropPos = mUtil.hasClass(element, 'm-dropdown--up') ? 'up' : 'down';\r\n            the.layout.currentDropPos = the.layout.defaultDropPos;\r\n\r\n            if (mUtil.attr(element, 'm-dropdown-toggle') == \"hover\") {\r\n                the.options.toggle = 'hover';\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Setup dropdown\r\n         */\r\n        setup: function() {\r\n            if (the.options.placement) {\r\n                mUtil.addClass(element, 'm-dropdown--' + the.options.placement);\r\n            }\r\n\r\n            if (the.options.align) {\r\n                mUtil.addClass(element, 'm-dropdown--align-' + the.options.align);\r\n            }\r\n\r\n            if (the.options.width) {\r\n                mUtil.css(the.layout.wrapper, 'width', the.options.width + 'px');\r\n            }\r\n\r\n            if (mUtil.attr(element, 'm-dropdown-persistent') == '1') {\r\n                the.options.persistent = true;\r\n            }\r\n\r\n            if (the.options.toggle == 'hover') {    \r\n                mUtil.addEvent(element, 'mouseout', Plugin.hideMouseout);\r\n            } \r\n\r\n            // set zindex\r\n            Plugin.setZindex();\r\n        },\r\n\r\n        /**\r\n         * Toggle dropdown\r\n         */\r\n        toggle: function() {\r\n            if (the.open) {\r\n                return Plugin.hide();\r\n            } else {\r\n                return Plugin.show();\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Set content\r\n         */\r\n        setContent: function(content) {\r\n            var content = mUtil.find(element, '.m-dropdown__content').innerHTML = content;\r\n\r\n            return the;\r\n        },\r\n\r\n        /**\r\n         * Show dropdown\r\n         */\r\n        show: function() {\r\n            if (the.options.toggle == 'hover' && mUtil.hasAttr(element, 'hover')) {\r\n                Plugin.clearHovered();\r\n                return the;\r\n            }\r\n\r\n            if (the.open) {\r\n                return the;\r\n            }\r\n\r\n            if (the.layout.arrow) {\r\n                Plugin.adjustArrowPos();\r\n            }\r\n\r\n            Plugin.eventTrigger('beforeShow');\r\n\r\n            Plugin.hideOpened();\r\n\r\n            mUtil.addClass(element, 'm-dropdown--open');\r\n\r\n            if (mUtil.isMobileDevice() && the.options.mobileOverlay) {\r\n                var zIndex = mUtil.css(element, 'z-index') - 1;\r\n\r\n                var dropdownoff = mUtil.insertAfter(document.createElement('DIV'), element );\r\n\r\n                mUtil.addClass(dropdownoff, 'm-dropdown__dropoff');\r\n                mUtil.css(dropdownoff, 'z-index', zIndex);\r\n                mUtil.data(dropdownoff).set('dropdown', element);\r\n                mUtil.data(element).set('dropoff', dropdownoff);\r\n\r\n                mUtil.addEvent(dropdownoff, 'click', function(e) {\r\n                    Plugin.hide();\r\n                    mUtil.remove(this);\r\n                    e.preventDefault();\r\n                });\r\n            }\r\n\r\n            element.focus();\r\n            element.setAttribute('aria-expanded', 'true');\r\n            the.open = true;\r\n\r\n            //== Update scrollers\r\n            mUtil.scrollersUpdate(element);\r\n\r\n            Plugin.eventTrigger('afterShow');\r\n\r\n            return the;\r\n        },\r\n\r\n        /**\r\n         * Clear dropdown hover\r\n         */\r\n        clearHovered: function() {\r\n            var timeout = mUtil.attr(element, 'timeout');\r\n\r\n            mUtil.removeAttr(element, 'hover');            \r\n            mUtil.removeAttr(element, 'timeout');\r\n\r\n            clearTimeout(timeout);\r\n        },\r\n\r\n        /**\r\n         * Hide hovered dropdown\r\n         */\r\n        hideHovered: function(force) {\r\n            if (force === true) {\r\n                if (Plugin.eventTrigger('beforeHide') === false) {\r\n                    return;\r\n                }\r\n\r\n                Plugin.clearHovered();\r\n                mUtil.removeClass(element, 'm-dropdown--open');\r\n                the.open = false;\r\n                Plugin.eventTrigger('afterHide');\r\n            } else {\r\n                if (mUtil.hasAttr(element, 'hover') === true) {\r\n                    return;\r\n                }\r\n\r\n                if (Plugin.eventTrigger('beforeHide') === false) {\r\n                    return;\r\n                }\r\n\r\n                var timeout = setTimeout(function() {\r\n                    if (mUtil.attr(element, 'hover')) {\r\n                        Plugin.clearHovered();\r\n                        mUtil.removeClass(element, 'm-dropdown--open');\r\n                        the.open = false;\r\n                        Plugin.eventTrigger('afterHide');\r\n                    }\r\n                }, the.options.hoverTimeout);\r\n\r\n                mUtil.attr(element, 'hover', '1');            \r\n                mUtil.attr(element, 'timeout', timeout);\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Hide clicked dropdown\r\n         */\r\n        hideClicked: function() {\r\n            if (Plugin.eventTrigger('beforeHide') === false) {\r\n                return;\r\n            }\r\n\r\n            mUtil.removeClass(element, 'm-dropdown--open');\r\n            mUtil.data(element).remove('dropoff');\r\n            the.open = false;\r\n            Plugin.eventTrigger('afterHide');\r\n        },\r\n\r\n        /**\r\n         * Hide dropdown\r\n         */\r\n        hide: function(force) {\r\n            if (the.open === false) {\r\n                return the;\r\n            }\r\n\r\n            if (mUtil.isDesktopDevice() && the.options.toggle == 'hover') {\r\n                Plugin.hideHovered(force);\r\n            } else {\r\n                Plugin.hideClicked();\r\n            }\r\n\r\n            if (the.layout.defaultDropPos == 'down' && the.layout.currentDropPos == 'up') {\r\n                mUtil.removeClass(element, 'm-dropdown--up');\r\n                the.layout.arrow.prependTo(the.layout.wrapper);\r\n                the.layout.currentDropPos = 'down';\r\n            }\r\n\r\n            return the;\r\n        },\r\n\r\n        /**\r\n         * Hide on mouseout\r\n         */\r\n        hideMouseout: function() {\r\n            if (mUtil.isDesktopDevice()) {\r\n                Plugin.hide();\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Hide opened dropdowns\r\n         */\r\n        hideOpened: function() {\r\n            var query = mUtil.findAll(body, '.m-dropdown.m-dropdown--open');\r\n            \r\n            for (var i = 0, j = query.length; i < j; i++) {\r\n                var dropdown = query[i];\r\n                mUtil.data(dropdown).get('dropdown').hide(true);\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Adjust dropdown arrow positions\r\n         */\r\n        adjustArrowPos: function() {\r\n            var width = mUtil.outerWidth(element); // ?\r\n\r\n            var alignment = mUtil.hasClass(the.layout.arrow, 'm-dropdown__arrow--right') ? 'right' : 'left';\r\n            var pos = 0;\r\n\r\n            if (the.layout.arrow) {\r\n                if ( mUtil.isInResponsiveRange('mobile') && mUtil.hasClass(element, 'm-dropdown--mobile-full-width') ) {\r\n                    pos = mUtil.offset(element).left + (width / 2) - Math.abs( parseInt(mUtil.css(the.layout.arrow, 'width')) / 2) - parseInt(mUtil.css(the.layout.wrapper, 'left'));\r\n                    \r\n                    mUtil.css(the.layout.arrow, 'right', 'auto');\r\n                    mUtil.css(the.layout.arrow, 'left', pos + 'px');\r\n                    \r\n                    mUtil.css(the.layout.arrow, 'margin-left', 'auto');\r\n                    mUtil.css(the.layout.arrow, 'margin-right', 'auto');\r\n                } else if (mUtil.hasClass(the.layout.arrow, 'm-dropdown__arrow--adjust')) {\r\n                    pos = width / 2 - Math.abs( parseInt(mUtil.css(the.layout.arrow, 'width')) / 2);\r\n                    if (mUtil.hasClass(element, 'm-dropdown--align-push')) {\r\n                        pos = pos + 20;\r\n                    }\r\n\r\n                    if (alignment == 'right') {\r\n                        if (mUtil.isRTL()) {\r\n                            mUtil.css(the.layout.arrow, 'right', 'auto');\r\n                            mUtil.css(the.layout.arrow, 'left', pos + 'px');\r\n                        } else {\r\n                            mUtil.css(the.layout.arrow, 'left', 'auto');\r\n                            mUtil.css(the.layout.arrow, 'right', pos + 'px');\r\n                        }\r\n                    } else {\r\n                        if (mUtil.isRTL()) {\r\n                            mUtil.css(the.layout.arrow, 'left', 'auto');\r\n                            mUtil.css(the.layout.arrow, 'right', pos + 'px');\r\n                        } else {\r\n                            mUtil.css(the.layout.arrow, 'right', 'auto');\r\n                            mUtil.css(the.layout.arrow, 'left', pos + 'px');\r\n                        }                       \r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Get zindex\r\n         */\r\n        setZindex: function() {\r\n            var zIndex = 101; //mUtil.css(the.layout.wrapper, 'z-index');\r\n            var newZindex = mUtil.getHighestZindex(element);\r\n            if (newZindex >= zIndex) {\r\n                zIndex = newZindex + 1;\r\n            }\r\n            \r\n            mUtil.css(the.layout.wrapper, 'z-index', zIndex);\r\n        },\r\n\r\n        /**\r\n         * Check persistent\r\n         */\r\n        isPersistent: function() {\r\n            return the.options.persistent;\r\n        },\r\n\r\n        /**\r\n         * Check persistent\r\n         */\r\n        isShown: function() {\r\n            return the.open;\r\n        },\r\n\r\n        /**\r\n         * Trigger events\r\n         */\r\n        eventTrigger: function(name, args) {\r\n            for (var i = 0; i < the.events.length; i++) {\r\n                var event = the.events[i];\r\n                if (event.name == name) {\r\n                    if (event.one == true) {\r\n                        if (event.fired == false) {\r\n                            the.events[i].fired = true;\r\n                            event.handler.call(this, the, args);\r\n                        }\r\n                    } else {\r\n                        event.handler.call(this, the, args);\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        addEvent: function(name, handler, one) {\r\n            the.events.push({\r\n                name: name,\r\n                handler: handler,\r\n                one: one,\r\n                fired: false\r\n            });\r\n        }\r\n    };\r\n\r\n    //////////////////////////\r\n    // ** Public Methods ** //\r\n    //////////////////////////\r\n\r\n    /**\r\n     * Set default options \r\n     */\r\n\r\n    the.setDefaults = function(options) {\r\n        defaultOptions = options;\r\n    };\r\n\r\n    /**\r\n     * Show dropdown\r\n     * @returns {mDropdown}\r\n     */\r\n    the.show = function() {\r\n        return Plugin.show();\r\n    };\r\n\r\n    /**\r\n     * Hide dropdown\r\n     * @returns {mDropdown}\r\n     */\r\n    the.hide = function() {\r\n        return Plugin.hide();\r\n    };\r\n\r\n    /**\r\n     * Toggle dropdown\r\n     * @returns {mDropdown}\r\n     */\r\n    the.toggle = function() {\r\n        return Plugin.toggle();\r\n    };\r\n\r\n    /**\r\n     * Toggle dropdown\r\n     * @returns {mDropdown}\r\n     */\r\n    the.isPersistent = function() {\r\n        return Plugin.isPersistent();\r\n    };\r\n\r\n    /**\r\n     * Check shown state\r\n     * @returns {mDropdown}\r\n     */\r\n    the.isShown = function() {\r\n        return Plugin.isShown();\r\n    };\r\n\r\n    /**\r\n     * Set dropdown content\r\n     * @returns {mDropdown}\r\n     */\r\n    the.setContent = function(content) {\r\n        return Plugin.setContent(content);\r\n    };\r\n\r\n    /**\r\n     * Register event\r\n     */\r\n    the.on = function(name, handler) {\r\n        return Plugin.addEvent(name, handler);\r\n    };\r\n\r\n    /**\r\n     * Register event\r\n     */\r\n    the.one = function(name, handler) {\r\n        return Plugin.addEvent(name, handler, true);\r\n    };\r\n\r\n    ///////////////////////////////\r\n    // ** Plugin Construction ** //\r\n    ///////////////////////////////\r\n\r\n    //== Run plugin\r\n    Plugin.construct.apply(the, [options]);\r\n\r\n    //== Init done\r\n    init = true;\r\n\r\n    // Return plugin instance\r\n    return the;\r\n};\r\n\r\n//== Plugin global lazy initialization\r\nmUtil.on(document, '[m-dropdown-toggle=\"click\"] .m-dropdown__toggle', 'click', function(e) {\r\n    var element = this.closest('.m-dropdown');  \r\n    var dropdown;\r\n\r\n    if (element) {\r\n        if (mUtil.data(element).has('dropdown')) {\r\n            dropdown = mUtil.data(element).get('dropdown');\r\n        } else {                 \r\n            dropdown = new mDropdown(element);\r\n        }             \r\n\r\n        dropdown.toggle();\r\n\r\n        e.preventDefault();\r\n    } \r\n});\r\n\r\nmUtil.on(document, '[m-dropdown-toggle=\"hover\"] .m-dropdown__toggle', 'click', function(e) {\r\n    if (mUtil.isDesktopDevice()) {\r\n        if (mUtil.attr(this, 'href') == '#') {\r\n            e.preventDefault();\r\n        }\r\n    } else if (mUtil.isMobileDevice()) {\r\n        var element = this.closest('.m-dropdown');\r\n        var dropdown;\r\n\r\n        if (element) {\r\n            if (mUtil.data(element).has('dropdown')) {\r\n                dropdown = mUtil.data(element).get('dropdown');\r\n            } else {                        \r\n                dropdown = new mDropdown(element);\r\n            }  \r\n\r\n            dropdown.toggle();\r\n\r\n            e.preventDefault();\r\n        }\r\n    }\r\n});\r\n\r\nmUtil.on(document, '[m-dropdown-toggle=\"hover\"]', 'mouseover', function(e) {\r\n    if (mUtil.isDesktopDevice()) {\r\n        var element = this;\r\n        var dropdown;\r\n\r\n        if (element) {\r\n            if (mUtil.data(element).has('dropdown')) {\r\n                dropdown = mUtil.data(element).get('dropdown');\r\n            } else {                        \r\n                dropdown = new mDropdown(element);\r\n            }              \r\n\r\n            dropdown.show();\r\n\r\n            e.preventDefault();\r\n        }\r\n    }\r\n});\r\n\r\ndocument.addEventListener(\"click\", function(e) {\r\n    var query;\r\n    var body = mUtil.get('body');\r\n    var target = e.target;\r\n\r\n    //== Handle dropdown close\r\n    if (query = body.querySelectorAll('.m-dropdown.m-dropdown--open')) {\r\n        for (var i = 0, len = query.length; i < len; i++) {\r\n            var element = query[i];\r\n            if (mUtil.data(element).has('dropdown') === false) {\r\n                return;\r\n            }\r\n\r\n            var the = mUtil.data(element).get('dropdown');\r\n            var toggle = mUtil.find(element, '.m-dropdown__toggle');\r\n\r\n            if (mUtil.hasClass(element, 'm-dropdown--disable-close')) {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                //return;\r\n            }\r\n\r\n            if (toggle && target !== toggle && toggle.contains(target) === false && target.contains(toggle) === false) {\r\n                if (the.isPersistent() === true) {\r\n                    if (element.contains(target) === false) {\r\n                        the.hide();\r\n                    }    \r\n                } else {\r\n                    the.hide();\r\n                }\r\n            } else if (element.contains(target) === false) {\r\n                the.hide();\r\n            } \r\n        }\r\n    }\r\n});\nvar mHeader = function(elementId, options) {\r\n    //== Main object\r\n    var the = this;\r\n    var init = false;\r\n\r\n    //== Get element object\r\n    var element = mUtil.get(elementId);\r\n    var body = mUtil.get('body');\r\n\r\n    if (element === undefined) {\r\n        return;\r\n    }\r\n\r\n    //== Default options\r\n    var defaultOptions = {\r\n        classic: false,\r\n        offset: {\r\n            mobile: 150,\r\n            desktop: 200\r\n        },\r\n        minimize: {\r\n            mobile: false,\r\n            desktop: false\r\n        }\r\n    };\r\n\r\n    ////////////////////////////\r\n    // ** Private Methods  ** //\r\n    ////////////////////////////\r\n\r\n    var Plugin = {\r\n        /**\r\n         * Run plugin\r\n         * @returns {mHeader}\r\n         */\r\n        construct: function(options) {\r\n            if (mUtil.data(element).has('header')) {\r\n                the = mUtil.data(element).get('header');\r\n            } else {\r\n                // reset header\r\n                Plugin.init(options);\r\n\r\n                // build header\r\n                Plugin.build();\r\n\r\n                mUtil.data(element).set('header', the);\r\n            }\r\n\r\n            return the;\r\n        },\r\n\r\n        /**\r\n         * Handles subheader click toggle\r\n         * @returns {mHeader}\r\n         */\r\n        init: function(options) {\r\n            the.events = [];\r\n\r\n            // merge default and user defined options\r\n            the.options = mUtil.deepExtend({}, defaultOptions, options);\r\n        },\r\n\r\n        /**\r\n         * Reset header\r\n         * @returns {mHeader}\r\n         */\r\n        build: function() {\r\n            var lastScrollTop = 0;\r\n\r\n            if (the.options.minimize.mobile === false && the.options.minimize.desktop === false) {\r\n                return;\r\n            }\r\n\r\n            window.addEventListener('scroll', function() {\r\n                var offset = 0, on, off, st;\r\n\r\n                if (mUtil.isInResponsiveRange('desktop')) {\r\n                    offset = the.options.offset.desktop;\r\n                    on = the.options.minimize.desktop.on;\r\n                    off = the.options.minimize.desktop.off;\r\n                } else if (mUtil.isInResponsiveRange('tablet-and-mobile')) {\r\n                    offset = the.options.offset.mobile;\r\n                    on = the.options.minimize.mobile.on;\r\n                    off = the.options.minimize.mobile.off;\r\n                }\r\n\r\n                st = window.pageYOffset;\r\n\r\n                if (\r\n                    (mUtil.isInResponsiveRange('tablet-and-mobile') && the.options.classic && the.options.classic.mobile) ||\r\n                    (mUtil.isInResponsiveRange('desktop') && the.options.classic && the.options.classic.desktop)\r\n\r\n                ) {\r\n                    if (st > offset) { // down scroll mode\r\n                        mUtil.addClass(body, on);\r\n                        mUtil.removeClass(body, off);\r\n                    } else { // back scroll mode\r\n                        mUtil.addClass(body, off);\r\n                        mUtil.removeClass(body, on);\r\n                    }\r\n                } else {\r\n                    if (st > offset && lastScrollTop < st) { // down scroll mode\r\n                        mUtil.addClass(body, on);\r\n                        mUtil.removeClass(body, off);\r\n                    } else { // back scroll mode\r\n                        mUtil.addClass(body, off);\r\n                        mUtil.removeClass(body, on);\r\n                    }\r\n\r\n                    lastScrollTop = st;\r\n                }\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Trigger events\r\n         */\r\n        eventTrigger: function(name, args) {\r\n            for (var i = 0; i < the.events.length; i++) {\r\n                var event = the.events[i];\r\n                if (event.name == name) {\r\n                    if (event.one == true) {\r\n                        if (event.fired == false) {\r\n                            the.events[i].fired = true;\r\n                            event.handler.call(this, the, args);\r\n                        }\r\n                    } else {\r\n                        event.handler.call(this, the, args);\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        addEvent: function(name, handler, one) {\r\n            the.events.push({\r\n                name: name,\r\n                handler: handler,\r\n                one: one,\r\n                fired: false\r\n            });\r\n        }\r\n    };\r\n\r\n    //////////////////////////\r\n    // ** Public Methods ** //\r\n    //////////////////////////\r\n\r\n    /**\r\n     * Set default options \r\n     */\r\n\r\n    the.setDefaults = function(options) {\r\n        defaultOptions = options;\r\n    };\r\n\r\n    /**\r\n     * Register event\r\n     */\r\n    the.on = function(name, handler) {\r\n        return Plugin.addEvent(name, handler);\r\n    };\r\n\r\n    ///////////////////////////////\r\n    // ** Plugin Construction ** //\r\n    ///////////////////////////////\r\n\r\n    //== Run plugin\r\n    Plugin.construct.apply(the, [options]);\r\n\r\n    //== Init done\r\n    init = true;\r\n\r\n    // Return plugin instance\r\n    return the;\r\n};\nvar mMenu = function(elementId, options) {\r\n    //== Main object\r\n    var the = this;\r\n    var init = false;\r\n\r\n    //== Get element object\r\n    var element = mUtil.get(elementId);\r\n    var body = mUtil.get('body');  \r\n\r\n    if (!element) {\r\n        return;\r\n    }\r\n\r\n    //== Default options\r\n    var defaultOptions = {       \r\n        // accordion submenu mode\r\n        accordion: {\r\n            slideSpeed: 100, // accordion toggle slide speed in milliseconds\r\n            autoScroll: false, // enable auto scrolling(focus) to the clicked menu item\r\n            autoScrollSpeed: 1200,\r\n            expandAll: true // allow having multiple expanded accordions in the menu\r\n        },\r\n\r\n        // dropdown submenu mode\r\n        dropdown: {\r\n            timeout: 500 // timeout in milliseconds to show and hide the hoverable submenu dropdown\r\n        }\r\n    };\r\n\r\n    ////////////////////////////\r\n    // ** Private Methods  ** //\r\n    ////////////////////////////\r\n\r\n    var Plugin = {\r\n        /**\r\n         * Run plugin\r\n         * @returns {mMenu}\r\n         */\r\n        construct: function(options) {\r\n            if (mUtil.data(element).has('menu')) {\r\n                the = mUtil.data(element).get('menu');\r\n            } else {\r\n                // reset menu\r\n                Plugin.init(options);\r\n\r\n                // reset menu\r\n                Plugin.reset();\r\n\r\n                // build menu\r\n                Plugin.build();\r\n\r\n                mUtil.data(element).set('menu', the);\r\n            }\r\n\r\n            return the;\r\n        },\r\n\r\n        /**\r\n         * Handles submenu click toggle\r\n         * @returns {mMenu}\r\n         */\r\n        init: function(options) {\r\n            the.events = [];\r\n\r\n            the.eventHandlers = {};\r\n\r\n            // merge default and user defined options\r\n            the.options = mUtil.deepExtend({}, defaultOptions, options);\r\n\r\n            // pause menu\r\n            the.pauseDropdownHoverTime = 0;\r\n\r\n            the.uid = mUtil.getUniqueID();\r\n        },\r\n\r\n        reload: function() {\r\n             // reset menu\r\n            Plugin.reset();\r\n\r\n            // build menu\r\n            Plugin.build();\r\n        },\r\n\r\n        /**\r\n         * Reset menu\r\n         * @returns {mMenu}\r\n         */\r\n        build: function() {\r\n            //== General accordion submenu toggle\r\n            the.eventHandlers['event_1'] = mUtil.on( element, '.m-menu__toggle', 'click', Plugin.handleSubmenuAccordion);\r\n\r\n            //== Dropdown mode(hoverable)\r\n            if (Plugin.getSubmenuMode() === 'dropdown' || Plugin.isConditionalSubmenuDropdown()) {\r\n                // dropdown submenu - hover toggle\r\n                the.eventHandlers['event_2'] = mUtil.on( element, '[m-menu-submenu-toggle=\"hover\"]', 'mouseover', Plugin.handleSubmenuDrodownHoverEnter);\r\n                the.eventHandlers['event_3'] = mUtil.on( element, '[m-menu-submenu-toggle=\"hover\"]', 'mouseout', Plugin.handleSubmenuDrodownHoverExit);\r\n\r\n                // dropdown submenu - click toggle\r\n                the.eventHandlers['event_4'] = mUtil.on( element, '[m-menu-submenu-toggle=\"click\"] > .m-menu__toggle, [m-menu-submenu-toggle=\"click\"] > .m-menu__link .m-menu__toggle', 'click', Plugin.handleSubmenuDropdownClick);\r\n                the.eventHandlers['event_5'] = mUtil.on( element, '[m-menu-submenu-toggle=\"tab\"] > .m-menu__toggle, [m-menu-submenu-toggle=\"tab\"] > .m-menu__link .m-menu__toggle', 'click', Plugin.handleSubmenuDropdownTabClick);\r\n            }\r\n\r\n            //== General link click\r\n            the.eventHandlers['event_6'] = mUtil.on(element, '.m-menu__item:not(.m-menu__item--submenu) > .m-menu__link:not(.m-menu__toggle):not(.m-menu__link--toggle-skip)', 'click', Plugin.handleLinkClick);\r\n\r\n            //== Init scrollable menu\r\n            if (the.options.scroll && the.options.scroll.height) {\r\n                Plugin.scrollerInit();\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Reset menu\r\n         * @returns {mMenu}\r\n         */\r\n        reset: function() { \r\n            mUtil.off( element, 'click', the.eventHandlers['event_1']);\r\n\r\n            // dropdown submenu - hover toggle\r\n            mUtil.off( element, 'mouseover', the.eventHandlers['event_2']);\r\n            mUtil.off( element, 'mouseout', the.eventHandlers['event_3']);\r\n\r\n            // dropdown submenu - click toggle\r\n            mUtil.off( element, 'click', the.eventHandlers['event_4']);\r\n            mUtil.off( element, 'click', the.eventHandlers['event_5']);\r\n            \r\n            mUtil.off(element, 'click', the.eventHandlers['event_6']);\r\n        },\r\n\r\n        /**\r\n         * Init scroll menu\r\n         *\r\n        */\r\n        scrollerInit: function() {\r\n            if ( the.options.scroll && the.options.scroll.height ) {\r\n                mUtil.scrollerInit(element, {disableForMobile: true, resetHeightOnDestroy: true, handleWindowResize: true, height: the.options.scroll.height});\r\n            }            \r\n        },\r\n\r\n        /**\r\n         * Update scroll menu\r\n        */\r\n        scrollerUpdate: function() {\r\n            if ( the.options.scroll && the.options.scroll.height ) {\r\n                mUtil.scrollerUpdate(element);\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Scroll top\r\n        */\r\n        scrollerTop: function() {\r\n            if ( the.options.scroll && the.options.scroll.height ) {\r\n                mUtil.scrollerTop(element);\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Get submenu mode for current breakpoint and menu state\r\n         * @returns {mMenu}\r\n         */\r\n        getSubmenuMode: function(el) {\r\n            if ( mUtil.isInResponsiveRange('desktop') ) {\r\n                if (el && mUtil.hasAttr(el, 'm-menu-submenu-toggle')) {\r\n                    return mUtil.attr(el, 'm-menu-submenu-toggle');\r\n                }\r\n\r\n                if ( mUtil.isset(the.options.submenu, 'desktop.state.body') ) {\r\n                    if ( mUtil.hasClass(body, the.options.submenu.desktop.state.body) ) {\r\n                        return the.options.submenu.desktop.state.mode;\r\n                    } else {\r\n                        return the.options.submenu.desktop.default;\r\n                    }\r\n                } else if ( mUtil.isset(the.options.submenu, 'desktop') ) {\r\n                    return the.options.submenu.desktop;\r\n                }\r\n            } else if ( mUtil.isInResponsiveRange('tablet') && mUtil.isset(the.options.submenu, 'tablet') ) {\r\n                return the.options.submenu.tablet;\r\n            } else if ( mUtil.isInResponsiveRange('mobile') && mUtil.isset(the.options.submenu, 'mobile') ) {\r\n                return the.options.submenu.mobile;\r\n            } else {\r\n                return false;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Get submenu mode for current breakpoint and menu state\r\n         * @returns {mMenu}\r\n         */\r\n        isConditionalSubmenuDropdown: function() {\r\n            if ( mUtil.isInResponsiveRange('desktop') && mUtil.isset(the.options.submenu, 'desktop.state.body') ) {\r\n                return true;\r\n            } else {\r\n                return false;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Handles menu link click\r\n         * @returns {mMenu}\r\n         */\r\n        handleLinkClick: function(e) {\r\n            if ( Plugin.eventTrigger('linkClick', this) === false ) {\r\n                e.preventDefault();\r\n            };\r\n\r\n            if ( Plugin.getSubmenuMode(this) === 'dropdown' || Plugin.isConditionalSubmenuDropdown() ) {\r\n                Plugin.handleSubmenuDropdownClose(e, this);\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Handles submenu hover toggle\r\n         * @returns {mMenu}\r\n         */\r\n        handleSubmenuDrodownHoverEnter: function(e) {\r\n            if ( Plugin.getSubmenuMode(this) === 'accordion' ) {\r\n                return;\r\n            }\r\n\r\n            if ( the.resumeDropdownHover() === false ) {\r\n                return;\r\n            }\r\n\r\n            var item = this;\r\n\r\n            if ( item.getAttribute('data-hover') == '1' ) {\r\n                item.removeAttribute('data-hover');\r\n                clearTimeout( item.getAttribute('data-timeout') );\r\n                item.removeAttribute('data-timeout');\r\n                //Plugin.hideSubmenuDropdown(item, false);\r\n            }\r\n\r\n            Plugin.showSubmenuDropdown(item);\r\n        },\r\n\r\n        /**\r\n         * Handles submenu hover toggle\r\n         * @returns {mMenu}\r\n         */\r\n        handleSubmenuDrodownHoverExit: function(e) {\r\n            if ( the.resumeDropdownHover() === false ) {\r\n                return;\r\n            }\r\n\r\n            if ( Plugin.getSubmenuMode(this) === 'accordion' ) {\r\n                return;\r\n            }\r\n\r\n            var item = this;\r\n            var time = the.options.dropdown.timeout;\r\n\r\n            var timeout = setTimeout(function() {\r\n                if ( item.getAttribute('data-hover') == '1' ) {\r\n                    Plugin.hideSubmenuDropdown(item, true);\r\n                } \r\n            }, time);\r\n\r\n            item.setAttribute('data-hover', '1');\r\n            item.setAttribute('data-timeout', timeout);  \r\n        },\r\n\r\n        /**\r\n         * Handles submenu click toggle\r\n         * @returns {mMenu}\r\n         */\r\n        handleSubmenuDropdownClick: function(e) {\r\n            if ( Plugin.getSubmenuMode(this) === 'accordion' ) {\r\n                return;\r\n            }\r\n \r\n            var item = this.closest('.m-menu__item'); \r\n\r\n            if ( item.getAttribute('m-menu-submenu-mode') == 'accordion' ) {\r\n                return;\r\n            }\r\n\r\n            if ( mUtil.hasClass(item, 'm-menu__item--hover') === false ) {\r\n                mUtil.addClass(item, 'm-menu__item--open-dropdown');\r\n                Plugin.showSubmenuDropdown(item);\r\n            } else {\r\n                mUtil.removeClass(item, 'm-menu__item--open-dropdown' );\r\n                Plugin.hideSubmenuDropdown(item, true);\r\n            }\r\n\r\n            e.preventDefault();\r\n        },\r\n\r\n        /**\r\n         * Handles tab click toggle\r\n         * @returns {mMenu}\r\n         */\r\n        handleSubmenuDropdownTabClick: function(e) {\r\n            if (Plugin.getSubmenuMode(this) === 'accordion') {\r\n                return;\r\n            }\r\n\r\n            var item = this.closest('.m-menu__item');\r\n\r\n            if (item.getAttribute('m-menu-submenu-mode') == 'accordion') {\r\n                return;\r\n            }\r\n\r\n            if (mUtil.hasClass(item, 'm-menu__item--hover') == false) {\r\n                mUtil.addClass(item, 'm-menu__item--open-dropdown');\r\n                Plugin.showSubmenuDropdown(item);\r\n            }\r\n\r\n            e.preventDefault();\r\n        },\r\n\r\n        /**\r\n         * Handles submenu dropdown close on link click\r\n         * @returns {mMenu}\r\n         */\r\n        handleSubmenuDropdownClose: function(e, el) {\r\n            // exit if its not submenu dropdown mode\r\n            if (Plugin.getSubmenuMode(el) === 'accordion') {\r\n                return;\r\n            }\r\n\r\n            var shown = element.querySelectorAll('.m-menu__item.m-menu__item--submenu.m-menu__item--hover:not(.m-menu__item--tabs)');\r\n\r\n            // check if currently clicked link's parent item ha\r\n            if (shown.length > 0 && mUtil.hasClass(el, 'm-menu__toggle') === false && el.querySelectorAll('.m-menu__toggle').length === 0) {\r\n                // close opened dropdown menus\r\n                for (var i = 0, len = shown.length; i < len; i++) {\r\n                    Plugin.hideSubmenuDropdown(shown[0], true);\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * helper functions\r\n         * @returns {mMenu}\r\n         */\r\n        handleSubmenuAccordion: function(e, el) {\r\n            var query;\r\n            var item = el ? el : this;\r\n\r\n            if ( Plugin.getSubmenuMode(el) === 'dropdown' && (query = item.closest('.m-menu__item') ) ) {\r\n                if (query.getAttribute('m-menu-submenu-mode') != 'accordion' ) {\r\n                    e.preventDefault();\r\n                    return;\r\n                }\r\n            }\r\n\r\n            var li = item.closest('.m-menu__item');\r\n            var submenu = mUtil.child(li, '.m-menu__submenu, .m-menu__inner');\r\n\r\n            if (mUtil.hasClass(item.closest('.m-menu__item'), 'm-menu__item--open-always')) {\r\n                return;\r\n            }\r\n\r\n            if ( li && submenu ) {\r\n                e.preventDefault();\r\n                var speed = the.options.accordion.slideSpeed;\r\n                var hasClosables = false;\r\n\r\n                if ( mUtil.hasClass(li, 'm-menu__item--open') === false ) {\r\n                    // hide other accordions                    \r\n                    if ( the.options.accordion.expandAll === false ) {\r\n                        var subnav = item.closest('.m-menu__nav, .m-menu__subnav');\r\n                        var closables = mUtil.children(subnav, '.m-menu__item.m-menu__item--open.m-menu__item--submenu:not(.m-menu__item--expanded):not(.m-menu__item--open-always)');\r\n\r\n                        if ( subnav && closables ) {\r\n                            for (var i = 0, len = closables.length; i < len; i++) {\r\n                                var el_ = closables[0];\r\n                                var submenu_ = mUtil.child(el_, '.m-menu__submenu');\r\n                                if ( submenu_ ) {\r\n                                    mUtil.slideUp(submenu_, speed, function() {\r\n                                        Plugin.scrollerUpdate();\r\n                                        mUtil.removeClass(el_, 'm-menu__item--open');\r\n                                    });                    \r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    mUtil.slideDown(submenu, speed, function() {\r\n                        Plugin.scrollToItem(item);\r\n                        Plugin.scrollerUpdate();\r\n                        \r\n                        Plugin.eventTrigger('submenuToggle', submenu);\r\n                    });\r\n                \r\n                    mUtil.addClass(li, 'm-menu__item--open');\r\n\r\n                } else {\r\n                    mUtil.slideUp(submenu, speed, function() {\r\n                        Plugin.scrollToItem(item);\r\n                        Plugin.eventTrigger('submenuToggle', submenu);\r\n                    });\r\n\r\n                    mUtil.removeClass(li, 'm-menu__item--open');       \r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * scroll to item function\r\n         * @returns {mMenu}\r\n         */\r\n        scrollToItem: function(item) {\r\n            // handle auto scroll for accordion submenus\r\n            if ( mUtil.isInResponsiveRange('desktop') && the.options.accordion.autoScroll && element.getAttribute('m-menu-scrollable') !== '1' ) {\r\n                mUtil.scrollTo(item, the.options.accordion.autoScrollSpeed);\r\n            }\r\n        },\r\n\r\n        /**\r\n         * helper functions\r\n         * @returns {mMenu}\r\n         */\r\n        hideSubmenuDropdown: function(item, classAlso) {\r\n            // remove submenu activation class\r\n            if ( classAlso ) {\r\n                mUtil.removeClass(item, 'm-menu__item--hover');\r\n                mUtil.removeClass(item, 'm-menu__item--active-tab');\r\n            }\r\n\r\n            // clear timeout\r\n            item.removeAttribute('data-hover');\r\n\r\n            if ( item.getAttribute('m-menu-dropdown-toggle-class') ) {\r\n                mUtil.removeClass(body, item.getAttribute('m-menu-dropdown-toggle-class'));\r\n            }\r\n\r\n            var timeout = item.getAttribute('data-timeout');\r\n            item.removeAttribute('data-timeout');\r\n            clearTimeout(timeout);\r\n        },\r\n\r\n        /**\r\n         * helper functions\r\n         * @returns {mMenu}\r\n         */\r\n        showSubmenuDropdown: function(item) {\r\n            // close active submenus\r\n            var list = element.querySelectorAll('.m-menu__item--submenu.m-menu__item--hover, .m-menu__item--submenu.m-menu__item--active-tab');\r\n\r\n            if ( list ) {\r\n                for (var i = 0, len = list.length; i < len; i++) {\r\n                    var el = list[i];\r\n                    if ( item !== el && el.contains(item) === false && item.contains(el) === false ) {\r\n                        Plugin.hideSubmenuDropdown(el, true);\r\n                    }\r\n                }\r\n            } \r\n\r\n            // adjust submenu position\r\n            Plugin.adjustSubmenuDropdownArrowPos(item);\r\n\r\n            // add submenu activation class\r\n            mUtil.addClass(item, 'm-menu__item--hover');\r\n            \r\n            if ( item.getAttribute('m-menu-dropdown-toggle-class') ) {\r\n                mUtil.addClass(body, item.getAttribute('m-menu-dropdown-toggle-class'));\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Handles submenu slide toggle\r\n         * @returns {mMenu}\r\n         */\r\n        createSubmenuDropdownClickDropoff: function(el) {\r\n            var query;\r\n            var zIndex = (query = mUtil.child(el, '.m-menu__submenu') ? mUtil.css(query, 'z-index') : 0) - 1;\r\n\r\n            var dropoff = document.createElement('<div class=\"m-menu__dropoff\" style=\"background: transparent; position: fixed; top: 0; bottom: 0; left: 0; right: 0; z-index: ' + zIndex + '\"></div>');\r\n\r\n            body.appendChild(dropoff);\r\n\r\n            mUtil.addEvent(dropoff, 'click', function(e) {\r\n                e.stopPropagation();\r\n                e.preventDefault();\r\n                mUtil.remove(this);\r\n                Plugin.hideSubmenuDropdown(el, true);\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Handles submenu click toggle\r\n         * @returns {mMenu}\r\n         */\r\n        adjustSubmenuDropdownArrowPos: function(item) {\r\n            var submenu = mUtil.child(item, '.m-menu__submenu');\r\n            var arrow = mUtil.child( submenu, '.m-menu__arrow.m-menu__arrow--adjust');\r\n            var subnav = mUtil.child( submenu, '.m-menu__subnav');\r\n\r\n            if ( arrow ) { \r\n                var pos = 0; \r\n                var link = mUtil.child(item, '.m-menu__link');\r\n\r\n                if ( mUtil.hasClass(submenu, 'm-menu__submenu--classic') || mUtil.hasClass(submenu, 'm-menu__submenu--fixed') ) {\r\n                    if ( mUtil.hasClass(submenu, 'm-menu__submenu--right')) {\r\n                        pos = mUtil.outerWidth(item) / 2;\r\n                        if (mUtil.hasClass(submenu, 'm-menu__submenu--pull')) {\r\n                            if (mUtil.isRTL()) {\r\n                                pos = pos + Math.abs( parseFloat(mUtil.css(submenu, 'margin-left')) );\r\n                            } else {\r\n                                pos = pos + Math.abs( parseFloat(mUtil.css(submenu, 'margin-right')) );\r\n                            }\r\n                        }\r\n                        pos = parseInt(mUtil.css(submenu, 'width')) - pos;\r\n                    } else if ( mUtil.hasClass(submenu, 'm-menu__submenu--left') ) {\r\n                        pos = mUtil.outerWidth(item) / 2;\r\n                        if ( mUtil.hasClass(submenu, 'm-menu__submenu--pull')) {\r\n                            if (mUtil.isRTL()) {\r\n                                pos = pos + Math.abs( parseFloat(mUtil.css(submenu, 'margin-right')) );\r\n                            } else {\r\n                                pos = pos + Math.abs( parseFloat(mUtil.css(submenu, 'margin-left')) );\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    if (mUtil.isRTL()) {\r\n                        mUtil.css(arrow, 'right', pos + 'px');  \r\n                    } else {\r\n                        mUtil.css(arrow, 'left', pos + 'px');  \r\n                    }\r\n                } else {\r\n                    if ( mUtil.hasClass(submenu, 'm-menu__submenu--center') || mUtil.hasClass(submenu, 'm-menu__submenu--full') ) {\r\n                        pos = mUtil.offset(item).left - ((mUtil.getViewPort().width - parseInt(mUtil.css(submenu, 'width'))) / 2);\r\n                        pos = pos + (mUtil.outerWidth(item) / 2);\r\n\r\n                        mUtil.css(arrow, 'left', pos + 'px');\r\n                        if (mUtil.isRTL()) {\r\n                            mUtil.css(arrow, 'right', 'auto');\r\n                        }                        \r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Handles submenu hover toggle\r\n         * @returns {mMenu}\r\n         */\r\n        pauseDropdownHover: function(time) {\r\n            var date = new Date();\r\n\r\n            the.pauseDropdownHoverTime = date.getTime() + time;\r\n        },\r\n\r\n        /**\r\n         * Handles submenu hover toggle\r\n         * @returns {mMenu}\r\n         */\r\n        resumeDropdownHover: function() {\r\n            var date = new Date();\r\n\r\n            return (date.getTime() > the.pauseDropdownHoverTime ? true : false);\r\n        },\r\n\r\n        /**\r\n         * Reset menu's current active item\r\n         * @returns {mMenu}\r\n         */\r\n        resetActiveItem: function(item) {\r\n            var list;\r\n            var parents;\r\n\r\n            list = element.querySelectorAll('.m-menu__item--active');\r\n            \r\n            for (var i = 0, len = list.length; i < len; i++) {\r\n                var el = list[0];\r\n                mUtil.removeClass(el, 'm-menu__item--active');\r\n                mUtil.hide( mUtil.child(el, '.m-menu__submenu') );\r\n                parents = mUtil.parents(el, '.m-menu__item--submenu');\r\n\r\n                for (var i_ = 0, len_ = parents.length; i_ < len_; i_++) {\r\n                    var el_ = parents[i];\r\n                    mUtil.removeClass(el_, 'm-menu__item--open');\r\n                    mUtil.hide( mUtil.child(el_, '.m-menu__submenu') );\r\n                }\r\n            }\r\n\r\n            // close open submenus\r\n            if ( the.options.accordion.expandAll === false ) {\r\n                if ( list = element.querySelectorAll('.m-menu__item--open') ) {\r\n                    for (var i = 0, len = list.length; i < len; i++) {\r\n                        mUtil.removeClass(parents[0], 'm-menu__item--open');\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Sets menu's active item\r\n         * @returns {mMenu}\r\n         */\r\n        setActiveItem: function(item) {\r\n            // reset current active item\r\n            Plugin.resetActiveItem();\r\n\r\n            mUtil.addClass(item, 'm-menu__item--active');\r\n            \r\n            var parents = mUtil.parents(item, '.m-menu__item--submenu');\r\n            for (var i = 0, len = parents.length; i < len; i++) {\r\n                mUtil.addClass(parents[i], 'm-menu__item--open');\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Returns page breadcrumbs for the menu's active item\r\n         * @returns {mMenu}\r\n         */\r\n        getBreadcrumbs: function(item) {\r\n            var query;\r\n            var breadcrumbs = [];\r\n            var link = mUtil.child(item, '.m-menu__link');\r\n\r\n            breadcrumbs.push({\r\n                text: (query = mUtil.child(link, '.m-menu__link-text') ? query.innerHTML : ''),\r\n                title: link.getAttribute('title'),\r\n                href: link.getAttribute('href')\r\n            });\r\n\r\n            var parents = mUtil.parents(item, '.m-menu__item--submenu');\r\n            for (var i = 0, len = parents.length; i < len; i++) {\r\n                var submenuLink = mUtil.child(parents[i], '.m-menu__link');\r\n\r\n                breadcrumbs.push({\r\n                    text: (query = mUtil.child(submenuLink, '.m-menu__link-text') ? query.innerHTML : ''),\r\n                    title: submenuLink.getAttribute('title'),\r\n                    href: submenuLink.getAttribute('href')\r\n                });\r\n            }\r\n\r\n            return  breadcrumbs.reverse();\r\n        },\r\n\r\n        /**\r\n         * Returns page title for the menu's active item\r\n         * @returns {mMenu}\r\n         */\r\n        getPageTitle: function(item) {\r\n            var query;\r\n\r\n            return (query = mUtil.child(item, '.m-menu__link-text') ? query.innerHTML : '');\r\n        },\r\n\r\n        /**\r\n         * Trigger events\r\n         */\r\n        eventTrigger: function(name, args) {\r\n            for (var i = 0; i < the.events.length; i++ ) {\r\n                var event = the.events[i];\r\n                if ( event.name == name ) {\r\n                    if ( event.one == true ) {\r\n                        if ( event.fired == false ) {\r\n                            the.events[i].fired = true;\r\n                            event.handler.call(this, the, args);\r\n                        }\r\n                    } else {\r\n                        event.handler.call(this, the, args);\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        addEvent: function(name, handler, one) {\r\n            the.events.push({\r\n                name: name,\r\n                handler: handler,\r\n                one: one,\r\n                fired: false\r\n            });\r\n        }\r\n    };\r\n\r\n    //////////////////////////\r\n    // ** Public Methods ** //\r\n    //////////////////////////\r\n\r\n    /**\r\n     * Set default options \r\n     */\r\n\r\n    the.setDefaults = function(options) {\r\n        defaultOptions = options;\r\n    };\r\n\r\n    /**\r\n     * Set active menu item\r\n     */\r\n    the.scrollerUpdate = function() {\r\n        return Plugin.scrollerUpdate();\r\n    };\r\n\r\n    /**\r\n     * Set active menu item\r\n     */\r\n    the.scrollerTop = function() {\r\n        return Plugin.scrollerTop();\r\n    };\r\n\r\n    /**\r\n     * Set active menu item\r\n     */\r\n    the.setActiveItem = function(item) {\r\n        return Plugin.setActiveItem(item);\r\n    };\r\n\r\n    the.reload = function() {\r\n        return Plugin.reload();\r\n    };\r\n\r\n    /**\r\n     * Set breadcrumb for menu item\r\n     */\r\n    the.getBreadcrumbs = function(item) {\r\n        return Plugin.getBreadcrumbs(item);\r\n    };\r\n\r\n    /**\r\n     * Set page title for menu item\r\n     */\r\n    the.getPageTitle = function(item) {\r\n        return Plugin.getPageTitle(item);\r\n    };\r\n\r\n    /**\r\n     * Get submenu mode\r\n     */\r\n    the.getSubmenuMode = function(el) {\r\n        return Plugin.getSubmenuMode(el);\r\n    };\r\n\r\n    /**\r\n     * Hide dropdown submenu\r\n     * @returns {jQuery}\r\n     */\r\n    the.hideDropdown = function(item) {\r\n        Plugin.hideSubmenuDropdown(item, true);\r\n    };\r\n\r\n    /**\r\n     * Disable menu for given time\r\n     * @returns {jQuery}\r\n     */\r\n    the.pauseDropdownHover = function(time) {\r\n        Plugin.pauseDropdownHover(time);\r\n    };\r\n\r\n    /**\r\n     * Disable menu for given time\r\n     * @returns {jQuery}\r\n     */\r\n    the.resumeDropdownHover = function() {\r\n        return Plugin.resumeDropdownHover();\r\n    };\r\n\r\n    /**\r\n     * Register event\r\n     */\r\n    the.on = function(name, handler) {\r\n        return Plugin.addEvent(name, handler);\r\n    };\r\n\r\n    the.one = function(name, handler) {\r\n        return Plugin.addEvent(name, handler, true);\r\n    };\r\n\r\n    ///////////////////////////////\r\n    // ** Plugin Construction ** //\r\n    ///////////////////////////////\r\n\r\n    //== Run plugin\r\n    Plugin.construct.apply(the, [options]);\r\n\r\n    //== Handle plugin on window resize\r\n    mUtil.addResizeHandler(function() {\r\n        if (init) {\r\n            the.reload();\r\n        }  \r\n    });\r\n\r\n    //== Init done\r\n    init = true;\r\n\r\n    // Return plugin instance\r\n    return the;\r\n};\r\n\r\n// Plugin global lazy initialization\r\ndocument.addEventListener(\"click\", function (e) {\r\n    var body = mUtil.get('body');\r\n    var query;\r\n    if ( query = body.querySelectorAll('.m-menu__nav .m-menu__item.m-menu__item--submenu.m-menu__item--hover:not(.m-menu__item--tabs)[m-menu-submenu-toggle=\"click\"]') ) {\r\n        for (var i = 0, len = query.length; i < len; i++) {\r\n            var element = query[i].closest('.m-menu__nav').parentNode;\r\n\r\n            if ( element ) {\r\n                var the = mUtil.data(element).get('menu');\r\n\r\n                if ( !the ) {\r\n                    break;\r\n                }\r\n\r\n                if ( !the || the.getSubmenuMode() !== 'dropdown' ) {\r\n                    break;\r\n                }\r\n\r\n                if ( e.target !== element && element.contains(e.target) === false ) {\r\n                    var items;\r\n                    if ( items = element.querySelectorAll('.m-menu__item--submenu.m-menu__item--hover:not(.m-menu__item--tabs)[m-menu-submenu-toggle=\"click\"]') ) {\r\n                        for (var j = 0, cnt = items.length; j < cnt; j++) {\r\n                            the.hideDropdown(items[j]);\r\n                        }\r\n                    }\r\n                }\r\n            }            \r\n        }\r\n    } \r\n});\nvar mOffcanvas = function(elementId, options) {\r\n    //== Main object\r\n    var the = this;\r\n    var init = false;\r\n\r\n    //== Get element object\r\n    var element = mUtil.get(elementId);\r\n    var body = mUtil.get('body');\r\n\r\n    if (!element) {\r\n        return;\r\n    }\r\n\r\n    //== Default options\r\n    var defaultOptions = {};\r\n\r\n    ////////////////////////////\r\n    // ** Private Methods  ** //\r\n    ////////////////////////////\r\n\r\n    var Plugin = {\r\n        /**\r\n         * Run plugin\r\n         * @returns {moffcanvas}\r\n         */\r\n        construct: function(options) {\r\n            if (mUtil.data(element).has('offcanvas')) {\r\n                the = mUtil.data(element).get('offcanvas');\r\n            } else {\r\n                // reset offcanvas\r\n                Plugin.init(options);\r\n                \r\n                // build offcanvas\r\n                Plugin.build();\r\n\r\n                mUtil.data(element).set('offcanvas', the);\r\n            }\r\n\r\n            return the;\r\n        },\r\n\r\n        /**\r\n         * Handles suboffcanvas click toggle\r\n         * @returns {moffcanvas}\r\n         */\r\n        init: function(options) {\r\n            the.events = [];\r\n\r\n            // merge default and user defined options\r\n            the.options = mUtil.deepExtend({}, defaultOptions, options);\r\n            the.overlay;\r\n\r\n            the.classBase = the.options.baseClass;\r\n            the.classShown = the.classBase + '--on';\r\n            the.classOverlay = the.classBase + '-overlay';\r\n\r\n            the.state = mUtil.hasClass(element, the.classShown) ? 'shown' : 'hidden';\r\n        },\r\n\r\n        build: function() {\r\n            //== offcanvas toggle\r\n            if (the.options.toggleBy) {\r\n                if (typeof the.options.toggleBy === 'string') { \r\n                    mUtil.addEvent( the.options.toggleBy, 'click', Plugin.toggle); \r\n                } else if (the.options.toggleBy && the.options.toggleBy[0] && the.options.toggleBy[0].target) {\r\n                    for (var i in the.options.toggleBy) { \r\n                        mUtil.addEvent( the.options.toggleBy[i].target, 'click', Plugin.toggle); \r\n                    }\r\n                } else if (the.options.toggleBy && the.options.toggleBy.target) {\r\n                    mUtil.addEvent( the.options.toggleBy.target, 'click', Plugin.toggle); \r\n                } \r\n            }\r\n\r\n            //== offcanvas close\r\n            var closeBy = mUtil.get(the.options.closeBy);\r\n            if (closeBy) {\r\n                mUtil.addEvent(closeBy, 'click', Plugin.hide);\r\n            }\r\n        },\r\n\r\n\r\n        /**\r\n         * Handles offcanvas toggle\r\n         */\r\n        toggle: function() {;\r\n            Plugin.eventTrigger('toggle'); \r\n\r\n            if (the.state == 'shown') {\r\n                Plugin.hide(this);\r\n            } else {\r\n                Plugin.show(this);\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Handles offcanvas show\r\n         */\r\n        show: function(target) {\r\n            if (the.state == 'shown') {\r\n                return;\r\n            }\r\n\r\n            Plugin.eventTrigger('beforeShow');\r\n\r\n            Plugin.togglerClass(target, 'show');\r\n\r\n            //== Offcanvas panel\r\n            mUtil.addClass(body, the.classShown);\r\n            mUtil.addClass(element, the.classShown);\r\n\r\n            the.state = 'shown';\r\n\r\n            if (the.options.overlay) {\r\n                the.overlay = mUtil.insertAfter(document.createElement('DIV') , element );\r\n                mUtil.addClass(the.overlay, the.classOverlay);\r\n                mUtil.addEvent(the.overlay, 'click', function(e) {\r\n                    e.stopPropagation();\r\n                    e.preventDefault();\r\n                    Plugin.hide(target);       \r\n                });\r\n            }\r\n\r\n            Plugin.eventTrigger('afterShow');\r\n        },\r\n\r\n        /**\r\n         * Handles offcanvas hide\r\n         */\r\n        hide: function(target) {\r\n            if (the.state == 'hidden') {\r\n                return;\r\n            }\r\n\r\n            Plugin.eventTrigger('beforeHide');\r\n\r\n            Plugin.togglerClass(target, 'hide');\r\n\r\n            mUtil.removeClass(body, the.classShown);\r\n            mUtil.removeClass(element, the.classShown);\r\n\r\n            the.state = 'hidden';\r\n\r\n            if (the.options.overlay && the.overlay) {\r\n                mUtil.remove(the.overlay);\r\n            }\r\n\r\n            Plugin.eventTrigger('afterHide');\r\n        },\r\n\r\n        /**\r\n         * Handles toggler class\r\n         */\r\n        togglerClass: function(target, mode) {\r\n            //== Toggler\r\n            var id = mUtil.attr(target, 'id');\r\n            var toggleBy;\r\n\r\n            if (the.options.toggleBy && the.options.toggleBy[0] && the.options.toggleBy[0].target) {\r\n                for (var i in the.options.toggleBy) {\r\n                    if (the.options.toggleBy[i].target === id) {\r\n                        toggleBy = the.options.toggleBy[i];\r\n                    }        \r\n                }\r\n            } else if (the.options.toggleBy && the.options.toggleBy.target) {\r\n                toggleBy = the.options.toggleBy;\r\n            }\r\n\r\n            if (toggleBy) {                \r\n                var el = mUtil.get(toggleBy.target);\r\n                \r\n                if (mode === 'show') {\r\n                    mUtil.addClass(el, toggleBy.state);\r\n                }\r\n\r\n                if (mode === 'hide') {\r\n                    mUtil.removeClass(el, toggleBy.state);\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Trigger events\r\n         */\r\n        eventTrigger: function(name, args) {\r\n            for (var i = 0; i < the.events.length; i++) {\r\n                var event = the.events[i];\r\n                if (event.name == name) {\r\n                    if (event.one == true) {\r\n                        if (event.fired == false) {\r\n                            the.events[i].fired = true;\r\n                            event.handler.call(this, the, args);\r\n                        }\r\n                    } else {\r\n                        event.handler.call(this, the, args);\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        addEvent: function(name, handler, one) {\r\n            the.events.push({\r\n                name: name,\r\n                handler: handler,\r\n                one: one,\r\n                fired: false\r\n            });\r\n        }\r\n    };\r\n\r\n    //////////////////////////\r\n    // ** Public Methods ** //\r\n    //////////////////////////\r\n\r\n    /**\r\n     * Set default options \r\n     */\r\n\r\n    the.setDefaults = function(options) {\r\n        defaultOptions = options;\r\n    };\r\n\r\n    /**\r\n     * Hide \r\n     */\r\n    the.hide = function() {\r\n        return Plugin.hide();\r\n    };\r\n\r\n    /**\r\n     * Show \r\n     */\r\n    the.show = function() {\r\n        return Plugin.show();\r\n    };\r\n\r\n    /**\r\n     * Get suboffcanvas mode\r\n     */\r\n    the.on = function(name, handler) {\r\n        return Plugin.addEvent(name, handler);\r\n    };\r\n\r\n    /**\r\n     * Set offcanvas content\r\n     * @returns {mOffcanvas}\r\n     */\r\n    the.one = function(name, handler) {\r\n        return Plugin.addEvent(name, handler, true);\r\n    };\r\n\r\n    ///////////////////////////////\r\n    // ** Plugin Construction ** //\r\n    ///////////////////////////////\r\n\r\n    //== Run plugin\r\n    Plugin.construct.apply(the, [options]);\r\n\r\n    //== Init done\r\n    init = true;\r\n\r\n    // Return plugin instance\r\n    return the;\r\n};\n// plugin setup\r\nvar mPortlet = function(elementId, options) {\r\n    //== Main object\r\n    var the = this;\r\n    var init = false;\r\n\r\n    //== Get element object\r\n    var element = mUtil.get(elementId);\r\n    var body = mUtil.get('body');\r\n\r\n    if (!element) {\r\n        return;\r\n    }\r\n\r\n    //== Default options\r\n    var defaultOptions = {\r\n        bodyToggleSpeed: 400,\r\n        tooltips: true,\r\n        tools: {\r\n            toggle: {\r\n                collapse: 'Collapse',\r\n                expand: 'Expand'\r\n            },\r\n            reload: 'Reload',\r\n            remove: 'Remove',\r\n            fullscreen: {\r\n                on: 'Fullscreen',\r\n                off: 'Exit Fullscreen'\r\n            }\r\n        },\r\n        sticky: {\r\n            offset: 300,\r\n            zIndex: 101\r\n        }\r\n    };\r\n\r\n    ////////////////////////////\r\n    // ** Private Methods  ** //\r\n    ////////////////////////////\r\n\r\n    var Plugin = {\r\n        /**\r\n         * Construct\r\n         */\r\n\r\n        construct: function(options) {\r\n            if (mUtil.data(element).has('portlet')) {\r\n                the = mUtil.data(element).get('portlet');\r\n            } else {\r\n                // reset menu\r\n                Plugin.init(options);\r\n\r\n                // build menu\r\n                Plugin.build();\r\n\r\n                mUtil.data(element).set('portlet', the);\r\n            }\r\n\r\n            return the;\r\n        },\r\n\r\n        /**\r\n         * Init portlet\r\n         */\r\n        init: function(options) {\r\n            the.element = element;\r\n            the.events = [];\r\n\r\n            // merge default and user defined options\r\n            the.options = mUtil.deepExtend({}, defaultOptions, options);\r\n            the.head = mUtil.child(element, '.m-portlet__head');\r\n            the.foot = mUtil.child(element, '.m-portlet__foot');\r\n\r\n            if (mUtil.child(element, '.m-portlet__body')) {\r\n                the.body = mUtil.child(element, '.m-portlet__body');\r\n            } else if (mUtil.child(element, '.m-form').length !== 0) {\r\n                the.body = mUtil.child(element, '.m-form');\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Build Form Wizard\r\n         */\r\n        build: function() {\r\n            //== Remove\r\n            var remove = mUtil.find(the.head, '[m-portlet-tool=remove]');\r\n            if (remove) {\r\n                mUtil.addEvent(remove, 'click', function(e) {\r\n                    e.preventDefault();\r\n                    Plugin.remove();\r\n                });\r\n            }\r\n\r\n            //== Reload\r\n            var reload = mUtil.find(the.head, '[m-portlet-tool=reload]');\r\n            if (reload) {\r\n                mUtil.addEvent(reload, 'click', function(e) {\r\n                    e.preventDefault();\r\n                    Plugin.reload();\r\n                });\r\n            }\r\n\r\n            //== Toggle\r\n            var toggle = mUtil.find(the.head, '[m-portlet-tool=toggle]');\r\n            if (toggle) {\r\n                mUtil.addEvent(toggle, 'click', function(e) {\r\n                    e.preventDefault();\r\n                    Plugin.toggle();\r\n                });\r\n            }\r\n\r\n            //== Fullscreen\r\n            var fullscreen = mUtil.find(the.head, '[m-portlet-tool=fullscreen]');\r\n            if (fullscreen) {\r\n                mUtil.addEvent(fullscreen, 'click', function(e) {\r\n                    e.preventDefault();\r\n                    Plugin.fullscreen();\r\n                });\r\n            }\r\n\r\n            Plugin.setupTooltips();\r\n        },\r\n\r\n        /**\r\n         * Window scroll handle event for sticky portlet\r\n         */\r\n        onScrollSticky: function() {\r\n            var st = window.pageYOffset;\r\n            var offset = the.options.sticky.offset;\r\n\r\n\r\n            if (st > offset) {\r\n                if (mUtil.hasClass(body, 'm-portlet--sticky') === false) {\r\n                    Plugin.eventTrigger('stickyOn');\r\n\r\n                    mUtil.addClass(body, 'm-portlet--sticky');\r\n                    mUtil.addClass(element, 'm-portlet--sticky');\r\n\r\n                    Plugin.updateSticky();\r\n                }\r\n            } else { // back scroll mode\r\n                if (mUtil.hasClass(body, 'm-portlet--sticky')) {\r\n                    Plugin.eventTrigger('stickyOff');\r\n\r\n                    mUtil.removeClass(body, 'm-portlet--sticky');\r\n                    mUtil.removeClass(element, 'm-portlet--sticky');\r\n\r\n                    Plugin.resetSticky();\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Init sticky portlet\r\n         */\r\n        initSticky: function() {\r\n            if (!the.head) {\r\n                return;\r\n            }\r\n\r\n            window.addEventListener('scroll', Plugin.onScrollSticky);\r\n        },\r\n\r\n        /**\r\n         * Update sticky portlet positions\r\n         */\r\n        updateSticky: function() {\r\n            if (!the.head) {\r\n                return;\r\n            }\r\n\r\n            var top;\r\n\r\n            if (mUtil.hasClass(body, 'm-portlet--sticky')) {\r\n                if (the.options.sticky.position.top instanceof Function) {\r\n                    top = parseInt(the.options.sticky.position.top.call());\r\n                } else {\r\n                    top = parseInt(the.options.sticky.position.top);\r\n                }\r\n\r\n                var left;\r\n                if (the.options.sticky.position.left instanceof Function) {\r\n                    left = parseInt(the.options.sticky.position.left.call());\r\n                } else {\r\n                    left = parseInt(the.options.sticky.position.left);\r\n                }\r\n\r\n                var right;\r\n                if (the.options.sticky.position.right instanceof Function) {\r\n                    right = parseInt(the.options.sticky.position.right.call());\r\n                } else {\r\n                    right = parseInt(the.options.sticky.position.right);\r\n                }\r\n\r\n                mUtil.css(the.head, 'z-index', the.options.sticky.zIndex);\r\n                mUtil.css(the.head, 'top', top + 'px');\r\n\r\n                if (mUtil.isRTL()) {\r\n                    mUtil.css(the.head, 'left', right + 'px');\r\n                    mUtil.css(the.head, 'right',left  + 'px');\r\n                } else {\r\n                    mUtil.css(the.head, 'left', left + 'px');\r\n                    mUtil.css(the.head, 'right', right + 'px');\r\n                }\r\n                \r\n            }\r\n        },\r\n\r\n        /**\r\n         * Reset sticky portlet positions\r\n         */\r\n        resetSticky: function() {\r\n            if (!the.head) {\r\n                return;\r\n            }\r\n\r\n            if (mUtil.hasClass(body, 'm-portlet--sticky') === false) {\r\n                mUtil.css(the.head, 'z-index', '');\r\n                mUtil.css(the.head, 'top', '');\r\n                mUtil.css(the.head, 'left', '');\r\n                mUtil.css(the.head, 'right', '');\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Destroy sticky portlet\r\n         */\r\n        destroySticky: function() {\r\n            if (!the.head) {\r\n                return;\r\n            }\r\n\r\n            Plugin.resetSticky();\r\n\r\n            window.removeEventListener('scroll', Plugin.onScrollSticky);\r\n        },\r\n\r\n        /**\r\n         * Remove portlet\r\n         */\r\n        remove: function() {\r\n            if (Plugin.eventTrigger('beforeRemove') === false) {\r\n                return;\r\n            }\r\n\r\n            if (mUtil.hasClass(body, 'm-portlet--fullscreen') && mUtil.hasClass(element, 'm-portlet--fullscreen')) {\r\n                Plugin.fullscreen('off');\r\n            }\r\n\r\n            Plugin.removeTooltips();\r\n\r\n            mUtil.remove(element);\r\n\r\n            Plugin.eventTrigger('afterRemove');\r\n        },\r\n\r\n        /**\r\n         * Set content\r\n         */\r\n        setContent: function(html) {\r\n            if (html) {\r\n                the.body.innerHTML = html;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Get body\r\n         */\r\n        getBody: function() {\r\n            return the.body;\r\n        },\r\n\r\n        /**\r\n         * Get self\r\n         */\r\n        getSelf: function() {\r\n            return element;\r\n        },\r\n\r\n        /**\r\n         * Setup tooltips\r\n         */\r\n        setupTooltips: function() {\r\n            if (the.options.tooltips) {\r\n                var collapsed = mUtil.hasClass(element, 'm-portlet--collapse') || mUtil.hasClass(element, 'm-portlet--collapsed');\r\n                var fullscreenOn = mUtil.hasClass(body, 'm-portlet--fullscreen') && mUtil.hasClass(element, 'm-portlet--fullscreen');\r\n\r\n                //== Remove\r\n                var remove = mUtil.find(the.head, '[m-portlet-tool=remove]');\r\n                if (remove) {\r\n                    var placement = (fullscreenOn ? 'bottom' : 'top');\r\n                    var tip = new Tooltip(remove, {\r\n                        title: the.options.tools.remove,\r\n                        placement: placement,\r\n                        offset: (fullscreenOn ? '0,10px,0,0' : '0,5px'),\r\n                        trigger: 'hover',\r\n                        template: '<div class=\"m-tooltip m-tooltip--portlet tooltip bs-tooltip-' + placement + '\" role=\"tooltip\">\\\r\n                            <div class=\"tooltip-arrow arrow\"></div>\\\r\n                            <div class=\"tooltip-inner\"></div>\\\r\n                        </div>'\r\n                    });\r\n\r\n                    mUtil.data(remove).set('tooltip', tip);\r\n                }\r\n\r\n                //== Reload\r\n                var reload = mUtil.find(the.head, '[m-portlet-tool=reload]');\r\n                if (reload) {\r\n                    var placement = (fullscreenOn ? 'bottom' : 'top');\r\n                    var tip = new Tooltip(reload, {\r\n                        title: the.options.tools.reload,\r\n                        placement: placement,\r\n                        offset: (fullscreenOn ? '0,10px,0,0' : '0,5px'),\r\n                        trigger: 'hover',\r\n                        template: '<div class=\"m-tooltip m-tooltip--portlet tooltip bs-tooltip-' + placement + '\" role=\"tooltip\">\\\r\n                            <div class=\"tooltip-arrow arrow\"></div>\\\r\n                            <div class=\"tooltip-inner\"></div>\\\r\n                        </div>'\r\n                    });\r\n\r\n                    mUtil.data(reload).set('tooltip', tip);\r\n                }\r\n\r\n                //== Toggle\r\n                var toggle = mUtil.find(the.head, '[m-portlet-tool=toggle]');\r\n                if (toggle) {\r\n                    var placement = (fullscreenOn ? 'bottom' : 'top');\r\n                    var tip = new Tooltip(toggle, {\r\n                        title: (collapsed ? the.options.tools.toggle.expand : the.options.tools.toggle.collapse),\r\n                        placement: placement,\r\n                        offset: (fullscreenOn ? '0,10px,0,0' : '0,5px'),\r\n                        trigger: 'hover',\r\n                        template: '<div class=\"m-tooltip m-tooltip--portlet tooltip bs-tooltip-' + placement + '\" role=\"tooltip\">\\\r\n                            <div class=\"tooltip-arrow arrow\"></div>\\\r\n                            <div class=\"tooltip-inner\"></div>\\\r\n                        </div>'\r\n                    });\r\n\r\n                    mUtil.data(toggle).set('tooltip', tip);\r\n                }\r\n\r\n                //== Fullscreen\r\n                var fullscreen = mUtil.find(the.head, '[m-portlet-tool=fullscreen]');\r\n                if (fullscreen) {\r\n                    var placement = (fullscreenOn ? 'bottom' : 'top');\r\n                    var tip = new Tooltip(fullscreen, {\r\n                        title: (fullscreenOn ? the.options.tools.fullscreen.off : the.options.tools.fullscreen.on),\r\n                        placement: placement,\r\n                        offset: (fullscreenOn ? '0,10px,0,0' : '0,5px'),\r\n                        trigger: 'hover',\r\n                        template: '<div class=\"m-tooltip m-tooltip--portlet tooltip bs-tooltip-' + placement + '\" role=\"tooltip\">\\\r\n                            <div class=\"tooltip-arrow arrow\"></div>\\\r\n                            <div class=\"tooltip-inner\"></div>\\\r\n                        </div>'\r\n                    });\r\n\r\n                    mUtil.data(fullscreen).set('tooltip', tip);\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Setup tooltips\r\n         */\r\n        removeTooltips: function() {\r\n            if (the.options.tooltips) {\r\n                //== Remove\r\n                var remove = mUtil.find(the.head, '[m-portlet-tool=remove]');\r\n                if (remove && mUtil.data(remove).has('tooltip')) {\r\n                    mUtil.data(remove).get('tooltip').dispose();\r\n                }\r\n\r\n                //== Reload\r\n                var reload = mUtil.find(the.head, '[m-portlet-tool=reload]');\r\n                if (reload && mUtil.data(reload).has('tooltip')) {\r\n                    mUtil.data(reload).get('tooltip').dispose();\r\n                }\r\n\r\n                //== Toggle\r\n                var toggle = mUtil.find(the.head, '[m-portlet-tool=toggle]');\r\n                if (toggle && mUtil.data(toggle).has('tooltip')) {\r\n                    mUtil.data(toggle).get('tooltip').dispose();\r\n                }\r\n\r\n                //== Fullscreen\r\n                var fullscreen = mUtil.find(the.head, '[m-portlet-tool=fullscreen]');\r\n                if (fullscreen && mUtil.data(fullscreen).has('tooltip')) {\r\n                    mUtil.data(fullscreen).get('tooltip').dispose();\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Reload\r\n         */\r\n        reload: function() {\r\n            Plugin.eventTrigger('reload');\r\n        },\r\n\r\n        /**\r\n         * Toggle\r\n         */\r\n        toggle: function() {\r\n            if (mUtil.hasClass(element, 'm-portlet--collapse') || mUtil.hasClass(element, 'm-portlet--collapsed')) {\r\n                Plugin.expand();\r\n            } else {\r\n                Plugin.collapse();\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Collapse\r\n         */\r\n        collapse: function() {\r\n            if (Plugin.eventTrigger('beforeCollapse') === false) {\r\n                return;\r\n            }\r\n\r\n            mUtil.slideUp(the.body, the.options.bodyToggleSpeed, function() {\r\n                Plugin.eventTrigger('afterCollapse');\r\n            });\r\n\r\n            mUtil.addClass(element, 'm-portlet--collapse');\r\n\r\n            var toggle = mUtil.find(the.head, '[m-portlet-tool=toggle]');\r\n            if (toggle && mUtil.data(toggle).has('tooltip')) {\r\n                mUtil.data(toggle).get('tooltip').updateTitleContent(the.options.tools.toggle.expand);\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Expand\r\n         */\r\n        expand: function() {\r\n            if (Plugin.eventTrigger('beforeExpand') === false) {\r\n                return;\r\n            }\r\n\r\n            mUtil.slideDown(the.body, the.options.bodyToggleSpeed, function() {\r\n                Plugin.eventTrigger('afterExpand');\r\n            });\r\n\r\n            mUtil.removeClass(element, 'm-portlet--collapse');\r\n            mUtil.removeClass(element, 'm-portlet--collapsed');\r\n\r\n            var toggle = mUtil.find(the.head, '[m-portlet-tool=toggle]');\r\n            if (toggle && mUtil.data(toggle).has('tooltip')) {\r\n                mUtil.data(toggle).get('tooltip').updateTitleContent(the.options.tools.toggle.collapse);\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Toggle\r\n         */\r\n        fullscreen: function(mode) {\r\n            var d = {};\r\n            var speed = 300;\r\n\r\n            if (mode === 'off' || (mUtil.hasClass(body, 'm-portlet--fullscreen') && mUtil.hasClass(element, 'm-portlet--fullscreen'))) {\r\n                Plugin.eventTrigger('beforeFullscreenOff');\r\n\r\n                mUtil.removeClass(body, 'm-portlet--fullscreen');\r\n                mUtil.removeClass(element, 'm-portlet--fullscreen');\r\n\r\n                Plugin.removeTooltips();\r\n                Plugin.setupTooltips();\r\n\r\n                if (the.foot) {\r\n                    mUtil.css(the.body, 'margin-bottom', '');\r\n                    mUtil.css(the.foot, 'margin-top', '');\r\n                }\r\n\r\n                Plugin.eventTrigger('afterFullscreenOff');\r\n            } else {\r\n                Plugin.eventTrigger('beforeFullscreenOn');\r\n\r\n                mUtil.addClass(element, 'm-portlet--fullscreen');\r\n                mUtil.addClass(body, 'm-portlet--fullscreen');\r\n\r\n                Plugin.removeTooltips();\r\n                Plugin.setupTooltips();\r\n\r\n\r\n                if (the.foot) {\r\n                    var height1 = parseInt(mUtil.css(the.foot, 'height'));\r\n                    var height2 = parseInt(mUtil.css(the.foot, 'height')) + parseInt(mUtil.css(the.head, 'height'));\r\n                    mUtil.css(the.body, 'margin-bottom', height1 + 'px');\r\n                    mUtil.css(the.foot, 'margin-top', '-' + height2 + 'px');\r\n                }\r\n\r\n                Plugin.eventTrigger('afterFullscreenOn');\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Trigger events\r\n         */\r\n        eventTrigger: function(name) {\r\n            //mUtil.triggerCustomEvent(name);\r\n            for (i = 0; i < the.events.length; i++) {\r\n                var event = the.events[i];\r\n                if (event.name == name) {\r\n                    if (event.one == true) {\r\n                        if (event.fired == false) {\r\n                            the.events[i].fired = true;\r\n                            event.handler.call(this, the);\r\n                        }\r\n                    } else {\r\n                        event.handler.call(this, the);\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        addEvent: function(name, handler, one) {\r\n            the.events.push({\r\n                name: name,\r\n                handler: handler,\r\n                one: one,\r\n                fired: false\r\n            });\r\n\r\n            return the;\r\n        }\r\n    };\r\n\r\n    //////////////////////////\r\n    // ** Public Methods ** //\r\n    //////////////////////////\r\n\r\n    /**\r\n     * Set default options \r\n     */\r\n\r\n    the.setDefaults = function(options) {\r\n        defaultOptions = options;\r\n    };\r\n\r\n    /**\r\n     * Remove portlet\r\n     * @returns {mPortlet}\r\n     */\r\n    the.remove = function() {\r\n        return Plugin.remove(html);\r\n    };\r\n\r\n    /**\r\n     * Init sticky portlet\r\n     * @returns {mPortlet}\r\n     */\r\n    the.initSticky = function() {\r\n        return Plugin.initSticky();\r\n    };\r\n\r\n    /**\r\n     * Update sticky portlet scroll event\r\n     * @returns {mPortlet}\r\n     */\r\n    the.updateSticky = function() {\r\n        return Plugin.updateSticky();\r\n    };\r\n\r\n    /**\r\n     * Reset sticky portlet positions\r\n     * @returns {mPortlet}\r\n     */\r\n    the.resetSticky = function() {\r\n        return Plugin.resetSticky();\r\n    };\r\n\r\n    /**\r\n     * Destroy sticky portlet scroll event\r\n     * @returns {mPortlet}\r\n     */\r\n    the.destroySticky = function() {\r\n        return Plugin.destroySticky();\r\n    };\r\n\r\n    /**\r\n     * Reload portlet\r\n     * @returns {mPortlet}\r\n     */\r\n    the.reload = function() {\r\n        return Plugin.reload();\r\n    };\r\n\r\n    /**\r\n     * Set portlet content\r\n     * @returns {mPortlet}\r\n     */\r\n    the.setContent = function(html) {\r\n        return Plugin.setContent(html);\r\n    };\r\n\r\n    /**\r\n     * Toggle portlet\r\n     * @returns {mPortlet}\r\n     */\r\n    the.toggle = function() {\r\n        return Plugin.toggle();\r\n    };\r\n\r\n    /**\r\n     * Collapse portlet\r\n     * @returns {mPortlet}\r\n     */\r\n    the.collapse = function() {\r\n        return Plugin.collapse();\r\n    };\r\n\r\n    /**\r\n     * Expand portlet\r\n     * @returns {mPortlet}\r\n     */\r\n    the.expand = function() {\r\n        return Plugin.expand();\r\n    };\r\n\r\n    /**\r\n     * Fullscreen portlet\r\n     * @returns {mPortlet}\r\n     */\r\n    the.fullscreen = function() {\r\n        return Plugin.fullscreen('on');\r\n    };\r\n\r\n    /**\r\n     * Fullscreen portlet\r\n     * @returns {mPortlet}\r\n     */\r\n    the.unFullscreen = function() {\r\n        return Plugin.fullscreen('off');\r\n    };\r\n\r\n    /**\r\n     * Get portletbody \r\n     * @returns {jQuery}\r\n     */\r\n    the.getBody = function() {\r\n        return Plugin.getBody();\r\n    };\r\n\r\n    /**\r\n     * Get portletbody \r\n     * @returns {jQuery}\r\n     */\r\n    the.getSelf = function() {\r\n        return Plugin.getSelf();\r\n    };\r\n\r\n    /**\r\n     * Attach event\r\n     */\r\n    the.on = function(name, handler) {\r\n        return Plugin.addEvent(name, handler);\r\n    };\r\n\r\n    /**\r\n     * Attach event that will be fired once\r\n     */\r\n    the.one = function(name, handler) {\r\n        return Plugin.addEvent(name, handler, true);\r\n    };\r\n\r\n    //== Construct plugin\r\n    Plugin.construct.apply(the, [options]);\r\n\r\n    return the;\r\n};\n// plugin setup\r\nvar mQuicksearch = function(elementId, options) {\r\n    //== Main object\r\n    var the = this;\r\n    var init = false;\r\n\r\n    //== Get element object\r\n    var element = mUtil.get(elementId);\r\n    var body = mUtil.get('body');  \r\n\r\n    if (!element) {\r\n        return;\r\n    }\r\n\r\n    //== Default options\r\n    var defaultOptions = {\r\n        mode: 'default', //'default/dropdown'\r\n        minLength: 1,\r\n        maxHeight: 300,\r\n        requestTimeout: 200, // ajax request fire timeout in milliseconds \r\n        inputTarget: 'm_quicksearch_input',\r\n        iconCloseTarget: 'm_quicksearch_close',\r\n        iconCancelTarget: 'm_quicksearch_cancel',\r\n        iconSearchTarget: 'm_quicksearch_search',\r\n        \r\n        spinnerClass: 'm-loader m-loader--skin-light m-loader--right',\r\n        hasResultClass: 'm-list-search--has-result',\r\n        \r\n        templates: {\r\n            error: '<div class=\"m-search-results m-search-results--skin-light\"><span class=\"m-search-result__message\">{{message}}</div></div>'\r\n        }\r\n    };\r\n\r\n    ////////////////////////////\r\n    // ** Private Methods  ** //\r\n    ////////////////////////////\r\n\r\n    var Plugin = {\r\n        /**\r\n         * Construct\r\n         */\r\n\r\n        construct: function(options) {\r\n            if (mUtil.data(element).has('quicksearch')) {\r\n                the = mUtil.data(element).get('quicksearch');\r\n            } else {\r\n                // reset menu\r\n                Plugin.init(options);\r\n\r\n                // build menu\r\n                Plugin.build();\r\n\r\n                mUtil.data(element).set('quicksearch', the);\r\n            }\r\n\r\n            return the;\r\n        },\r\n\r\n        init: function(options) {\r\n            the.element = element;\r\n            the.events = [];\r\n\r\n            // merge default and user defined options\r\n            the.options = mUtil.deepExtend({}, defaultOptions, options);\r\n\r\n            // search query\r\n            the.query = '';\r\n\r\n            // form\r\n            the.form = mUtil.find(element, 'form');\r\n\r\n            // input element\r\n            the.input = mUtil.get(the.options.inputTarget);\r\n\r\n            // close icon\r\n            the.iconClose = mUtil.get(the.options.iconCloseTarget);\r\n\r\n            if (the.options.mode == 'default') {\r\n                // search icon\r\n                the.iconSearch = mUtil.get(the.options.iconSearchTarget);\r\n\r\n                // cancel icon\r\n                the.iconCancel = mUtil.get(the.options.iconCancelTarget);\r\n            }\r\n\r\n            // dropdown\r\n            the.dropdown = new mDropdown(element, {\r\n                mobileOverlay: false\r\n            });\r\n\r\n            // cancel search timeout\r\n            the.cancelTimeout;\r\n\r\n            // ajax processing state\r\n            the.processing = false;\r\n\r\n            // ajax request fire timeout\r\n            the.requestTimeout = false;\r\n        },\r\n\r\n        /**\r\n         * Build plugin\r\n         */\r\n        build: function() {\r\n            // attach input keyup handler\r\n            mUtil.addEvent(the.input, 'keyup', Plugin.search);\r\n\r\n            if (the.options.mode == 'default') {\r\n                mUtil.addEvent(the.input, 'focus', Plugin.showDropdown);\r\n                mUtil.addEvent(the.iconCancel, 'click', Plugin.handleCancel);\r\n\r\n                mUtil.addEvent(the.iconSearch, 'click', function() {\r\n                    if (mUtil.isInResponsiveRange('tablet-and-mobile')) {\r\n                        mUtil.addClass(body, 'm-header-search--mobile-expanded');\r\n                        the.input.focus();\r\n                    }\r\n                });\r\n\r\n                mUtil.addEvent(the.iconClose, 'click', function() {\r\n                    if (mUtil.isInResponsiveRange('tablet-and-mobile')) {\r\n                        mUtil.removeClass(body, 'm-header-search--mobile-expanded');\r\n                        Plugin.closeDropdown();\r\n                    }\r\n                });\r\n            } else if (the.options.mode == 'dropdown') {\r\n                the.dropdown.on('afterShow', function() {\r\n                    the.input.focus();\r\n                });\r\n\r\n                mUtil.addEvent(the.iconClose, 'click', Plugin.closeDropdown);\r\n            }\r\n        },\r\n\r\n        showProgress: function() {\r\n            the.processing = true;\r\n            mUtil.addClass(the.form, the.options.spinnerClass);\r\n            Plugin.handleCancelIconVisibility('off');\r\n\r\n            return the;\r\n        },\r\n\r\n        hideProgress: function() {\r\n            the.processing = false;\r\n            mUtil.removeClass(the.form, the.options.spinnerClass);\r\n            Plugin.handleCancelIconVisibility('on');\r\n            mUtil.addClass(element, the.options.hasResultClass);\r\n\r\n            return the;\r\n        },\r\n\r\n        /**\r\n         * Search handler\r\n         */\r\n        search: function(e) {\r\n            the.query = the.input.value;\r\n\r\n            if (the.query.length === 0) {\r\n                Plugin.handleCancelIconVisibility('on');\r\n                mUtil.removeClass(element, the.options.hasResultClass);\r\n                mUtil.removeClass(the.form, the.options.spinnerClass);\r\n            }\r\n\r\n            if (the.query.length < the.options.minLength || the.processing == true) {\r\n                return;\r\n            }\r\n\r\n            if (the.requestTimeout) {\r\n                clearTimeout(the.requestTimeout);\r\n            }\r\n\r\n            the.requestTimeout = false;\r\n\r\n            the.requestTimeout = setTimeout(function() {\r\n                Plugin.eventTrigger('search');\r\n            }, the.options.requestTimeout);            \r\n\r\n            return the;\r\n        },\r\n\r\n        /**\r\n         * Handle cancel icon visibility\r\n         */\r\n        handleCancelIconVisibility: function(status) {\r\n            if (status == 'on') {\r\n                if (the.input.value.length === 0) {\r\n                    if (the.iconCancel) mUtil.css(the.iconCancel, 'visibility', 'hidden');\r\n                    if (the.iconClose) mUtil.css(the.iconClose, 'visibility', 'visible');\r\n                } else {\r\n                    clearTimeout(the.cancelTimeout);\r\n                    the.cancelTimeout = setTimeout(function() {\r\n                        if (the.iconCancel) mUtil.css(the.iconCancel, 'visibility', 'visible');\r\n                        if (the.iconClose) mUtil.css(the.iconClose, 'visibility', 'visible');\r\n                    }, 500);\r\n                }\r\n            } else {\r\n                if (the.iconCancel) mUtil.css(the.iconCancel, 'visibility', 'hidden');\r\n                if (the.iconClose) mUtil.css(the.iconClose, 'visibility', 'hidden');\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Cancel handler\r\n         */\r\n        handleCancel: function(e) {\r\n            the.input.value = '';\r\n            mUtil.css(the.iconCancel, 'visibility', 'hidden');\r\n            mUtil.removeClass(element, the.options.hasResultClass);\r\n\r\n            Plugin.closeDropdown();\r\n        },\r\n\r\n        /**\r\n         * Cancel handler\r\n         */\r\n        closeDropdown: function() {\r\n            the.dropdown.hide();\r\n        },\r\n\r\n        /**\r\n         * Show dropdown\r\n         */\r\n        showDropdown: function(e) {\r\n            if (the.dropdown.isShown() == false && the.input.value.length > the.options.minLength && the.processing == false) {\r\n                console.log('show!!!');\r\n                the.dropdown.show();\r\n                if (e) {\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n                }                \r\n            }\r\n        },\r\n\r\n        /**\r\n         * Trigger events\r\n         */\r\n        eventTrigger: function(name) {\r\n            //mUtil.triggerCustomEvent(name);\r\n            for (i = 0; i < the.events.length; i++) {\r\n                var event = the.events[i];\r\n                if (event.name == name) {\r\n                    if (event.one == true) {\r\n                        if (event.fired == false) {\r\n                            the.events[i].fired = true;\r\n                            event.handler.call(this, the);\r\n                        }\r\n                    } else {\r\n                        event.handler.call(this, the);\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        addEvent: function(name, handler, one) {\r\n            the.events.push({\r\n                name: name,\r\n                handler: handler,\r\n                one: one,\r\n                fired: false\r\n            });\r\n\r\n            return the;\r\n        }\r\n    };\r\n\r\n    //////////////////////////\r\n    // ** Public Methods ** //\r\n    //////////////////////////\r\n\r\n    /**\r\n     * Set default options \r\n     */\r\n\r\n    the.setDefaults = function(options) {\r\n        defaultOptions = options;\r\n    };\r\n\r\n    /**\r\n     * quicksearch off \r\n     */\r\n    the.search = function() {\r\n        return Plugin.handleSearch();\r\n    };\r\n\r\n    the.showResult = function(res) {\r\n        the.dropdown.setContent(res);\r\n        Plugin.showDropdown();\r\n\r\n        return the;\r\n    };\r\n\r\n    the.showError = function(text) {\r\n        var msg = the.options.templates.error.replace('{{message}}', text);\r\n        the.dropdown.setContent(msg);\r\n        Plugin.showDropdown();\r\n\r\n        return the;\r\n    };\r\n\r\n    /**\r\n     *  \r\n     */\r\n    the.showProgress = function() {\r\n        return Plugin.showProgress();\r\n    };\r\n\r\n    the.hideProgress = function() {\r\n        return Plugin.hideProgress();\r\n    };\r\n\r\n    /**\r\n     * quicksearch off \r\n     */\r\n    the.search = function() {\r\n        return Plugin.search();\r\n    };\r\n\r\n    /**\r\n     * Attach event\r\n     * @returns {mQuicksearch}\r\n     */\r\n    the.on = function(name, handler) {\r\n        return Plugin.addEvent(name, handler);\r\n    };\r\n\r\n    /**\r\n     * Attach event that will be fired once\r\n     * @returns {mQuicksearch}\r\n     */\r\n    the.one = function(name, handler) {\r\n        return Plugin.addEvent(name, handler, true);\r\n    };\r\n\r\n    //== Construct plugin\r\n    Plugin.construct.apply(the, [options]);\r\n\r\n    return the;\r\n};\nvar mScrollTop = function(elementId, options) {\r\n    //== Main object\r\n    var the = this;\r\n    var init = false;\r\n\r\n    //== Get element object\r\n    var element = mUtil.get(elementId);\r\n    var body = mUtil.get('body');\r\n\r\n    if (!element) {\r\n        return;\r\n    }\r\n\r\n    //== Default options\r\n    var defaultOptions = {\r\n        offset: 300,\r\n        speed: 600\r\n    };\r\n\r\n    ////////////////////////////\r\n    // ** Private Methods  ** //\r\n    ////////////////////////////\r\n\r\n    var Plugin = {\r\n        /**\r\n         * Run plugin\r\n         * @returns {mscrolltop}\r\n         */\r\n        construct: function(options) {\r\n            if (mUtil.data(element).has('scrolltop')) {\r\n                the = mUtil.data(element).get('scrolltop');\r\n            } else {\r\n                // reset scrolltop\r\n                Plugin.init(options);\r\n\r\n                // build scrolltop\r\n                Plugin.build();\r\n\r\n                mUtil.data(element).set('scrolltop', the);\r\n            }\r\n\r\n            return the;\r\n        },\r\n\r\n        /**\r\n         * Handles subscrolltop click toggle\r\n         * @returns {mscrolltop}\r\n         */\r\n        init: function(options) {\r\n            the.events = [];\r\n\r\n            // merge default and user defined options\r\n            the.options = mUtil.deepExtend({}, defaultOptions, options);\r\n        },\r\n\r\n        build: function() {\r\n            // handle window scroll\r\n            if (navigator.userAgent.match(/iPhone|iPad|iPod/i)) {\r\n                window.addEventListener('touchend', function() {\r\n                    Plugin.handle();\r\n                });\r\n\r\n                window.addEventListener('touchcancel', function() {\r\n                    Plugin.handle();\r\n                });\r\n\r\n                window.addEventListener('touchleave', function() {\r\n                    Plugin.handle();\r\n                });\r\n            } else {\r\n                window.addEventListener('scroll', function() { \r\n                    Plugin.handle();\r\n                });\r\n            }\r\n\r\n            // handle button click \r\n            mUtil.addEvent(element, 'click', Plugin.scroll);\r\n        },\r\n\r\n        /**\r\n         * Handles scrolltop click scrollTop\r\n         */\r\n        handle: function() {\r\n            var pos = window.pageYOffset; // current vertical position\r\n            if (pos > the.options.offset) {\r\n                mUtil.addClass(body, 'm-scroll-top--shown');\r\n            } else {\r\n                mUtil.removeClass(body, 'm-scroll-top--shown');\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Handles scrolltop click scrollTop\r\n         */\r\n        scroll: function(e) {\r\n            e.preventDefault();\r\n\r\n            mUtil.scrollTop(0, the.options.speed);\r\n        },\r\n\r\n\r\n        /**\r\n         * Trigger events\r\n         */\r\n        eventTrigger: function(name, args) {\r\n            for (var i = 0; i < the.events.length; i++) {\r\n                var event = the.events[i];\r\n                if (event.name == name) {\r\n                    if (event.one == true) {\r\n                        if (event.fired == false) {\r\n                            the.events[i].fired = true;\r\n                            event.handler.call(this, the, args);\r\n                        }\r\n                    } else {\r\n                        event.handler.call(this, the, args);\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        addEvent: function(name, handler, one) {\r\n            the.events.push({\r\n                name: name,\r\n                handler: handler,\r\n                one: one,\r\n                fired: false\r\n            });\r\n        }\r\n    };\r\n\r\n    //////////////////////////\r\n    // ** Public Methods ** //\r\n    //////////////////////////\r\n\r\n    /**\r\n     * Set default options \r\n     */\r\n\r\n    the.setDefaults = function(options) {\r\n        defaultOptions = options;\r\n    };\r\n\r\n    /**\r\n     * Get subscrolltop mode\r\n     */\r\n    the.on = function(name, handler) {\r\n        return Plugin.addEvent(name, handler);\r\n    };\r\n\r\n    /**\r\n     * Set scrolltop content\r\n     * @returns {mscrolltop}\r\n     */\r\n    the.one = function(name, handler) {\r\n        return Plugin.addEvent(name, handler, true);\r\n    };\r\n\r\n    ///////////////////////////////\r\n    // ** Plugin Construction ** //\r\n    ///////////////////////////////\r\n\r\n    //== Run plugin\r\n    Plugin.construct.apply(the, [options]);\r\n\r\n    //== Init done\r\n    init = true;\r\n\r\n    // Return plugin instance\r\n    return the;\r\n};\n// plugin setup\r\nvar mToggle = function(elementId, options) {\r\n    //== Main object\r\n    var the = this;\r\n    var init = false;\r\n\r\n    //== Get element object\r\n    var element = mUtil.get(elementId);\r\n    var body = mUtil.get('body');  \r\n\r\n    if (!element) {\r\n        return;\r\n    }\r\n\r\n    //== Default options\r\n    var defaultOptions = {\r\n        togglerState: '',\r\n        targetState: ''\r\n    };    \r\n\r\n    ////////////////////////////\r\n    // ** Private Methods  ** //\r\n    ////////////////////////////\r\n\r\n    var Plugin = {\r\n        /**\r\n         * Construct\r\n         */\r\n\r\n        construct: function(options) {\r\n            if (mUtil.data(element).has('toggle')) {\r\n                the = mUtil.data(element).get('toggle');\r\n            } else {\r\n                // reset menu\r\n                Plugin.init(options);\r\n\r\n                // build menu\r\n                Plugin.build();\r\n\r\n                mUtil.data(element).set('toggle', the);\r\n            }\r\n\r\n            return the;\r\n        },\r\n\r\n        /**\r\n         * Handles subtoggle click toggle\r\n         */\r\n        init: function(options) {\r\n            the.element = element;\r\n            the.events = [];\r\n\r\n            // merge default and user defined options\r\n            the.options = mUtil.deepExtend({}, defaultOptions, options);\r\n\r\n            the.target = mUtil.get(the.options.target);\r\n            the.targetState = the.options.targetState;\r\n            the.togglerState = the.options.togglerState;\r\n\r\n            the.state = mUtil.hasClasses(the.target, the.targetState) ? 'on' : 'off';\r\n        },\r\n\r\n        /**\r\n         * Setup toggle\r\n         */\r\n        build: function() {\r\n            mUtil.addEvent(element, 'mouseup', Plugin.toggle);\r\n        },\r\n        \r\n        /**\r\n         * Handles offcanvas click toggle\r\n         */\r\n        toggle: function() {\r\n            if (the.state == 'off') {\r\n                Plugin.toggleOn();\r\n            } else {\r\n                Plugin.toggleOff();\r\n            }\r\n\r\n            return the;\r\n        },\r\n\r\n        /**\r\n         * Handles toggle click toggle\r\n         */\r\n        toggleOn: function() {\r\n            Plugin.eventTrigger('beforeOn');\r\n\r\n            mUtil.addClass(the.target, the.targetState);\r\n\r\n            if (the.togglerState) {\r\n                mUtil.addClass(element, the.togglerState);\r\n            }\r\n\r\n            the.state = 'on';\r\n\r\n            Plugin.eventTrigger('afterOn');\r\n\r\n            Plugin.eventTrigger('toggle');\r\n\r\n            return the;\r\n        },\r\n\r\n        /**\r\n         * Handles toggle click toggle\r\n         */\r\n        toggleOff: function() {\r\n            Plugin.eventTrigger('beforeOff');\r\n\r\n            mUtil.removeClass(the.target, the.targetState);\r\n\r\n            if (the.togglerState) {\r\n                mUtil.removeClass(element, the.togglerState);\r\n            }\r\n\r\n            the.state = 'off';\r\n\r\n            Plugin.eventTrigger('afterOff');\r\n\r\n            Plugin.eventTrigger('toggle');\r\n\r\n            return the;\r\n        },\r\n\r\n        /**\r\n         * Trigger events\r\n         */\r\n        eventTrigger: function(name) {\r\n            for (i = 0; i < the.events.length; i++) {\r\n                var event = the.events[i];\r\n\r\n                if (event.name == name) {\r\n                    if (event.one == true) {\r\n                        if (event.fired == false) {\r\n                            the.events[i].fired = true;                            \r\n                            event.handler.call(this, the);\r\n                        }\r\n                    } else {\r\n                        event.handler.call(this, the);\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        addEvent: function(name, handler, one) {\r\n            the.events.push({\r\n                name: name,\r\n                handler: handler,\r\n                one: one,\r\n                fired: false\r\n            });\r\n\r\n            return the;\r\n        }\r\n    };\r\n\r\n    //////////////////////////\r\n    // ** Public Methods ** //\r\n    //////////////////////////\r\n\r\n    /**\r\n     * Set default options \r\n     */\r\n\r\n    the.setDefaults = function(options) {\r\n        defaultOptions = options;\r\n    };\r\n\r\n    /**\r\n     * Get toggle state \r\n     */\r\n    the.getState = function() {\r\n        return the.state;\r\n    };\r\n\r\n    /**\r\n     * Toggle \r\n     */\r\n    the.toggle = function() {\r\n        return Plugin.toggle();\r\n    };\r\n\r\n    /**\r\n     * Toggle on \r\n     */\r\n    the.toggleOn = function() {\r\n        return Plugin.toggleOn();\r\n    };\r\n\r\n    /**\r\n     * Toggle off \r\n     */\r\n    the.toggle = function() {\r\n        return Plugin.toggleOff();\r\n    };\r\n\r\n    /**\r\n     * Attach event\r\n     * @returns {mToggle}\r\n     */\r\n    the.on = function(name, handler) {\r\n        return Plugin.addEvent(name, handler);\r\n    };\r\n\r\n    /**\r\n     * Attach event that will be fired once\r\n     * @returns {mToggle}\r\n     */\r\n    the.one = function(name, handler) {\r\n        return Plugin.addEvent(name, handler, true);\r\n    };\r\n\r\n    //== Construct plugin\r\n    Plugin.construct.apply(the, [options]);\r\n\r\n    return the;\r\n};\n// plugin setup\r\nvar mWizard = function(elementId, options) {\r\n    //== Main object\r\n    var the = this;\r\n    var init = false;\r\n\r\n    //== Get element object\r\n    var element = mUtil.get(elementId);\r\n    var body = mUtil.get('body');\r\n\r\n    if (!element) {\r\n        return; \r\n    }\r\n\r\n    //== Default options\r\n    var defaultOptions = {\r\n        startStep: 1,\r\n        manualStepForward: false\r\n    };\r\n\r\n    ////////////////////////////\r\n    // ** Private Methods  ** //\r\n    ////////////////////////////\r\n\r\n    var Plugin = {\r\n        /**\r\n         * Construct\r\n         */\r\n\r\n        construct: function(options) {\r\n            if (mUtil.data(element).has('wizard')) {\r\n                the = mUtil.data(element).get('wizard');\r\n            } else {\r\n                // reset menu\r\n                Plugin.init(options);\r\n\r\n                // build menu\r\n                Plugin.build();\r\n\r\n                mUtil.data(element).set('wizard', the);\r\n            }\r\n\r\n            return the;\r\n        },\r\n\r\n        /**\r\n         * Init wizard\r\n         */\r\n        init: function(options) {\r\n            the.element = element;\r\n            the.events = [];\r\n\r\n            // merge default and user defined options\r\n            the.options = mUtil.deepExtend({}, defaultOptions, options);\r\n\r\n            //== Elements\r\n            the.steps = mUtil.findAll(element, '.m-wizard__step');\r\n\r\n            the.progress = mUtil.find(element, '.m-wizard__progress .progress-bar');\r\n            the.btnSubmit = mUtil.find(element, '[data-wizard-action=\"submit\"]');\r\n            the.btnNext = mUtil.find(element, '[data-wizard-action=\"next\"]');\r\n            the.btnPrev = mUtil.find(element, '[data-wizard-action=\"prev\"]');\r\n            the.btnLast = mUtil.find(element, '[data-wizard-action=\"last\"]');\r\n            the.btnFirst = mUtil.find(element, '[data-wizard-action=\"first\"]');\r\n\r\n            //== Variables\r\n            the.events = [];\r\n            the.currentStep = 1;\r\n            the.stopped = false;\r\n            the.totalSteps = the.steps.length;\r\n\r\n            //== Init current step\r\n            if (the.options.startStep > 1) {\r\n                Plugin.goTo(the.options.startStep);\r\n            }\r\n\r\n            //== Init UI\r\n            Plugin.updateUI();\r\n        },\r\n\r\n        /**\r\n         * Build Form Wizard\r\n         */\r\n        build: function() {\r\n            //== Next button event handler\r\n            mUtil.addEvent(the.btnNext, 'click', function(e) {\r\n                e.preventDefault();\r\n                Plugin.goNext();\r\n            });\r\n\r\n            //== Prev button event handler\r\n            mUtil.addEvent(the.btnPrev, 'click', function(e) {\r\n                e.preventDefault();\r\n                Plugin.goPrev();\r\n            });\r\n\r\n            //== First button event handler\r\n            mUtil.addEvent(the.btnFirst, 'click', function(e) {\r\n                e.preventDefault();\r\n                Plugin.goFirst();\r\n            });\r\n\r\n            //== Last button event handler\r\n            mUtil.addEvent(the.btnLast, 'click', function(e) {\r\n                e.preventDefault();\r\n                Plugin.goLast();\r\n            });\r\n\r\n            mUtil.on(element, '.m-wizard__step a.m-wizard__step-number', 'click', function() {\r\n                var step = this.closest('.m-wizard__step');\r\n                var steps = mUtil.parents(this, '.m-wizard__steps')\r\n                var find = mUtil.findAll(steps, '.m-wizard__step');\r\n                var num;\r\n\r\n                for (var i = 0, j = find.length; i < j; i++) {\r\n                    if (step === find[i]) {\r\n                        num = (i + 1);\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                if (num) {\r\n                    if (the.options.manualStepForward === false) {\r\n                        if (num < the.currentStep) {\r\n                            Plugin.goTo(num);\r\n                        }\r\n                    } else {\r\n                        Plugin.goTo(num);\r\n                    }                    \r\n                }\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Handles wizard click wizard\r\n         */\r\n        goTo: function(number) {\r\n            //== Skip if this step is already shown\r\n            if (number === the.currentStep || number > the.totalSteps || number < 0) {\r\n                return;\r\n            }\r\n\r\n            //== Validate step number\r\n            if (number) {\r\n                number = parseInt(number);\r\n            } else {\r\n                number = Plugin.getNextStep();\r\n            }\r\n\r\n            //== Before next and prev events\r\n            var callback;\r\n\r\n            if (number > the.currentStep) {\r\n                callback = Plugin.eventTrigger('beforeNext');\r\n            } else {\r\n                callback = Plugin.eventTrigger('beforePrev');\r\n            }\r\n            \r\n            //== Skip if stopped\r\n            if (the.stopped === true) {\r\n                the.stopped = false;\r\n                return;\r\n            }\r\n\r\n            //== Continue if no exit\r\n            if (callback !== false) {\r\n                //== Before change\r\n                Plugin.eventTrigger('beforeChange');\r\n\r\n                //== Set current step \r\n                the.currentStep = number;\r\n\r\n                //== Update UI\r\n                Plugin.updateUI();\r\n\r\n                //== Trigger change event\r\n                Plugin.eventTrigger('change');\r\n            }\r\n\r\n            //== After next and prev events\r\n            if (number > the.startStep) {\r\n                Plugin.eventTrigger('afterNext');\r\n            } else {\r\n                Plugin.eventTrigger('afterPrev');\r\n            }\r\n\r\n            return the;\r\n        },\r\n\r\n        /**\r\n         * Set step class\r\n         */\r\n        setStepClass: function() {\r\n            if (Plugin.isLastStep()) {\r\n                mUtil.addClass(element, 'm-wizard--step-last');\r\n            } else {\r\n                mUtil.removeClass(element, 'm-wizard--step-last');\r\n            }\r\n\r\n            if (Plugin.isFirstStep()) {\r\n                mUtil.addClass(element, 'm-wizard--step-first');\r\n            } else {\r\n                mUtil.removeClass(element, 'm-wizard--step-first');\r\n            }\r\n\r\n            if (Plugin.isBetweenStep()) {\r\n                mUtil.addClass(element, 'm-wizard--step-between');\r\n            } else {\r\n                mUtil.removeClass(element, 'm-wizard--step-between');\r\n            }\r\n        },\r\n\r\n        updateUI: function(argument) {\r\n            //== Update progress bar\r\n            Plugin.updateProgress();\r\n\r\n            //== Show current target content\r\n            Plugin.handleTarget();\r\n\r\n            //== Set classes\r\n            Plugin.setStepClass();\r\n\r\n            //== Apply nav step classes\r\n            for (var i = 0, j = the.steps.length; i < j; i++) {\r\n                mUtil.removeClass(the.steps[i], 'm-wizard__step--current m-wizard__step--done');\r\n            }\r\n\r\n            for (var i = 1; i < the.currentStep; i++) {\r\n                mUtil.addClass(the.steps[i - 1], 'm-wizard__step--done');\r\n            }\r\n            \r\n            mUtil.addClass(the.steps[the.currentStep - 1], 'm-wizard__step--current');\r\n        },\r\n\r\n        /**\r\n         * Cancel\r\n         */\r\n        stop: function() {\r\n            the.stopped = true;\r\n        },\r\n\r\n        /**\r\n         * Resume\r\n         */\r\n        start: function() {\r\n            the.stopped = false;\r\n        },\r\n\r\n        /**\r\n         * Check last step\r\n         */\r\n        isLastStep: function() {\r\n            return the.currentStep === the.totalSteps;\r\n        },\r\n\r\n        /**\r\n         * Check first step\r\n         */\r\n        isFirstStep: function() {\r\n            return the.currentStep === 1;\r\n        },\r\n\r\n        /**\r\n         * Check between step\r\n         */\r\n        isBetweenStep: function() {\r\n            return Plugin.isLastStep() === false && Plugin.isFirstStep() === false;\r\n        },\r\n\r\n        /**\r\n         * Go to the next step\r\n         */\r\n        goNext: function() {\r\n            return Plugin.goTo(Plugin.getNextStep());\r\n        },\r\n\r\n        /**\r\n         * Go to the prev step\r\n         */\r\n        goPrev: function() {\r\n            return Plugin.goTo(Plugin.getPrevStep());\r\n        },\r\n\r\n        /**\r\n         * Go to the last step\r\n         */\r\n        goLast: function() {\r\n            return Plugin.goTo(the.totalSteps);\r\n        },\r\n\r\n        /**\r\n         * Go to the first step\r\n         */\r\n        goFirst: function() {\r\n            return Plugin.goTo(1);\r\n        },\r\n\r\n        /**\r\n         * Set progress\r\n         */\r\n        updateProgress: function() {\r\n            //== Calculate progress position\r\n            if (!the.progress) {\r\n                return;\r\n            }\r\n\r\n            //== Update progress\r\n            if (mUtil.hasClass(element, 'm-wizard--1')) {\r\n                var width = 100 * ((the.currentStep) / (the.totalSteps));\r\n                var number = mUtil.find(element, '.m-wizard__step-number');\r\n                var offset = parseInt(mUtil.css(number, 'width'));\r\n                mUtil.css(the.progress, 'width', 'calc(' + width + '% + ' + (offset / 2) + 'px)');\r\n            } else if (mUtil.hasClass(element, 'm-wizard--2')) {\r\n                if (the.currentStep === 1) {\r\n                    //return;\r\n                }\r\n\r\n                var progress = (the.currentStep - 1) * (100 * (1 / (the.totalSteps - 1)));\r\n\r\n                if (mUtil.isInResponsiveRange('minimal-desktop-and-below')) {\r\n                    mUtil.css(the.progress, 'height', progress + '%');\r\n                } else {\r\n                    mUtil.css(the.progress, 'width', progress + '%');\r\n                }\r\n            } else {\r\n                var width = 100 * ((the.currentStep) / (the.totalSteps));\r\n                mUtil.css(the.progress, 'width', width + '%');\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Show/hide target content\r\n         */\r\n        handleTarget: function() {\r\n            var step = the.steps[the.currentStep - 1];\r\n            var target = mUtil.get(mUtil.attr(step, 'm-wizard-target'));\r\n            var current = mUtil.find(element, '.m-wizard__form-step--current');\r\n            \r\n            mUtil.removeClass(current, 'm-wizard__form-step--current');\r\n            mUtil.addClass(target, 'm-wizard__form-step--current');\r\n        },\r\n\r\n        /**\r\n         * Get next step\r\n         */\r\n        getNextStep: function() {\r\n            if (the.totalSteps >= (the.currentStep + 1)) {\r\n                return the.currentStep + 1;\r\n            } else {\r\n                return the.totalSteps;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Get prev step\r\n         */\r\n        getPrevStep: function() {\r\n            if ((the.currentStep - 1) >= 1) {\r\n                return the.currentStep - 1;\r\n            } else {\r\n                return 1;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Trigger events\r\n         */\r\n        eventTrigger: function(name) {\r\n            //mUtil.triggerCustomEvent(name);\r\n            for (i = 0; i < the.events.length; i++) {\r\n                var event = the.events[i];\r\n                if (event.name == name) {\r\n                    if (event.one == true) {\r\n                        if (event.fired == false) {\r\n                            the.events[i].fired = true;\r\n                            event.handler.call(this, the);\r\n                        }\r\n                    } else {\r\n                        event.handler.call(this, the);\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        addEvent: function(name, handler, one) {\r\n            the.events.push({\r\n                name: name,\r\n                handler: handler,\r\n                one: one,\r\n                fired: false\r\n            });\r\n\r\n            return the;\r\n        }\r\n    };\r\n\r\n    //////////////////////////\r\n    // ** Public Methods ** //\r\n    //////////////////////////\r\n\r\n    /**\r\n     * Set default options \r\n     */\r\n\r\n    the.setDefaults = function(options) {\r\n        defaultOptions = options;\r\n    };\r\n\r\n    /**\r\n     * Go to the next step \r\n     */\r\n    the.goNext = function() {\r\n        return Plugin.goNext();\r\n    };\r\n\r\n    /**\r\n     * Go to the prev step \r\n     */\r\n    the.goPrev = function() {\r\n        return Plugin.goPrev();\r\n    };\r\n\r\n    /**\r\n     * Go to the last step \r\n     */\r\n    the.goLast = function() {\r\n        return Plugin.goLast();\r\n    };\r\n\r\n    /**\r\n     * Cancel step \r\n     */\r\n    the.stop = function() {\r\n        return Plugin.stop();\r\n    };\r\n\r\n    /**\r\n     * Resume step \r\n     */\r\n    the.start = function() {\r\n        return Plugin.start();\r\n    };\r\n\r\n    /**\r\n     * Go to the first step \r\n     */\r\n    the.goFirst = function() {\r\n        return Plugin.goFirst();\r\n    };\r\n\r\n    /**\r\n     * Go to a step\r\n     */\r\n    the.goTo = function(number) {\r\n        return Plugin.goTo(number);\r\n    };\r\n\r\n    /**\r\n     * Get current step number \r\n     */\r\n    the.getStep = function() {\r\n        return the.currentStep;\r\n    };\r\n\r\n    /**\r\n     * Check last step \r\n     */\r\n    the.isLastStep = function() {\r\n        return Plugin.isLastStep();\r\n    };\r\n\r\n    /**\r\n     * Check first step \r\n     */\r\n    the.isFirstStep = function() {\r\n        return Plugin.isFirstStep();\r\n    };\r\n    \r\n    /**\r\n     * Attach event\r\n     */\r\n    the.on = function(name, handler) {\r\n        return Plugin.addEvent(name, handler);\r\n    };\r\n\r\n    /**\r\n     * Attach event that will be fired once\r\n     */\r\n    the.one = function(name, handler) {\r\n        return Plugin.addEvent(name, handler, true);\r\n    };\r\n\r\n    //== Construct plugin\r\n    Plugin.construct.apply(the, [options]);\r\n\r\n    return the;\r\n};\nvar mLayout = function() {\r\n    var header;\r\n    var horMenu;\r\n    var asideMenu;\r\n    var asideMenuOffcanvas;\r\n    var horMenuOffcanvas;\r\n    var asideLeftToggle;\r\n    var asideLeftHide;\r\n    var scrollTop;\r\n    var quicksearch;\r\n    var mainPortlet;\r\n\r\n    //== Header\r\n    var initStickyHeader = function() {\r\n        var tmp;\r\n        var headerEl = mUtil.get('m_header');\r\n        var options = {\r\n            offset: {},\r\n            minimize: {}\r\n        };\r\n\r\n        if (mUtil.attr(headerEl, 'm-minimize-mobile') == 'hide') {\r\n            options.minimize.mobile = {};\r\n            options.minimize.mobile.on = 'm-header--hide';\r\n            options.minimize.mobile.off = 'm-header--show';\r\n        } else {\r\n            options.minimize.mobile = false;\r\n        }\r\n\r\n        if (mUtil.attr(headerEl, 'm-minimize') == 'hide') {\r\n            options.minimize.desktop = {};\r\n            options.minimize.desktop.on = 'm-header--hide';\r\n            options.minimize.desktop.off = 'm-header--show';\r\n        } else {\r\n            options.minimize.desktop = false;\r\n        }\r\n\r\n        if (tmp = mUtil.attr(headerEl, 'm-minimize-offset')) {\r\n            options.offset.desktop = tmp;\r\n        }\r\n\r\n        if (tmp = mUtil.attr(headerEl, 'm-minimize-mobile-offset')) {\r\n            options.offset.mobile = tmp;\r\n        }\r\n\r\n        header = new mHeader('m_header', options);\r\n    }\r\n\r\n    //== Hor menu\r\n    var initHorMenu = function() {\r\n        // init aside left offcanvas\r\n        horMenuOffcanvas = new mOffcanvas('m_header_menu', {\r\n            overlay: true,\r\n            baseClass: 'm-aside-header-menu-mobile',\r\n            closeBy: 'm_aside_header_menu_mobile_close_btn',\r\n            toggleBy: {\r\n                target: 'm_aside_header_menu_mobile_toggle',\r\n                state: 'm-brand__toggler--active'\r\n            }\r\n        });\r\n\r\n        horMenu = new mMenu('m_header_menu', {\r\n            submenu: {\r\n                desktop: 'dropdown',\r\n                tablet: 'accordion',\r\n                mobile: 'accordion'\r\n            },\r\n            accordion: {\r\n                slideSpeed: 200, // accordion toggle slide speed in milliseconds\r\n                expandAll: false // allow having multiple expanded accordions in the menu\r\n            }\r\n        });\r\n    }\r\n\r\n    //== Aside menu\r\n    var initLeftAsideMenu = function() {\r\n        //== Init aside menu\r\n        var menu = mUtil.get('m_ver_menu');\r\n        var menuDesktopMode = (mUtil.attr(menu, 'm-menu-dropdown') === '1' ? 'dropdown' : 'accordion');\r\n\r\n        var scroll;\r\n        if (mUtil.attr(menu, 'm-menu-scrollable') === '1') {\r\n            scroll = {\r\n                height: function() {\r\n                    return mUtil.getViewPort().height - parseInt(mUtil.css('m_header', 'height'));\r\n                }\r\n            };\r\n        }\r\n\r\n        asideMenu = new mMenu('m_ver_menu', {\r\n            // vertical scroll\r\n            scroll: scroll,\r\n\r\n            // submenu setup\r\n            submenu: {\r\n                desktop: {\r\n                    // by default the menu mode set to accordion in desktop mode\r\n                    default: menuDesktopMode,\r\n                    // whenever body has this class switch the menu mode to dropdown\r\n                    state: {\r\n                        body: 'm-aside-left--minimize',\r\n                        mode: 'dropdown'\r\n                    }\r\n                },\r\n                tablet: 'accordion', // menu set to accordion in tablet mode\r\n                mobile: 'accordion' // menu set to accordion in mobile mode\r\n            },\r\n\r\n            //accordion setup\r\n            accordion: {\r\n                autoScroll: false, // enable auto scrolling(focus) to the clicked menu item\r\n                expandAll: false // allow having multiple expanded accordions in the menu\r\n            }\r\n        });\r\n    }\r\n\r\n    //== Aside\r\n    var initLeftAside = function() {\r\n        // init aside left offcanvas\r\n        var body = mUtil.get('body');\r\n        var asideLeft = mUtil.get('m_aside_left');\r\n        var asideOffcanvasClass = mUtil.hasClass(asideLeft, 'm-aside-left--offcanvas-default') ? 'm-aside-left--offcanvas-default' : 'm-aside-left';\r\n\r\n        asideMenuOffcanvas = new mOffcanvas('m_aside_left', {\r\n            baseClass: asideOffcanvasClass,\r\n            overlay: true,\r\n            closeBy: 'm_aside_left_close_btn',\r\n            toggleBy: {\r\n                target: 'm_aside_left_offcanvas_toggle',\r\n                state: 'm-brand__toggler--active'\r\n            }\r\n        });\r\n\r\n        //== Handle minimzied aside hover\r\n        if (mUtil.hasClass(body, 'm-aside-left--fixed')) {\r\n            var insideTm;\r\n            var outsideTm;\r\n\r\n            mUtil.addEvent(asideLeft, 'mouseenter', function() {\r\n                if (outsideTm) {\r\n                    clearTimeout(outsideTm);\r\n                    outsideTm = null;\r\n                }\r\n\r\n                insideTm = setTimeout(function() {\r\n                    if (mUtil.hasClass(body, 'm-aside-left--minimize') && mUtil.isInResponsiveRange('desktop')) {\r\n                        mUtil.removeClass(body, 'm-aside-left--minimize');\r\n                        mUtil.addClass(body, 'm-aside-left--minimize-hover');\r\n                        asideMenu.scrollerUpdate();\r\n                        asideMenu.scrollerTop();\r\n                    }\r\n                }, 300);\r\n            });\r\n\r\n            mUtil.addEvent(asideLeft, 'mouseleave', function() {\r\n                if (insideTm) {\r\n                    clearTimeout(insideTm);\r\n                    insideTm = null;\r\n                }\r\n\r\n                outsideTm = setTimeout(function() {\r\n                    if (mUtil.hasClass(body, 'm-aside-left--minimize-hover') && mUtil.isInResponsiveRange('desktop')) {\r\n                        mUtil.removeClass(body, 'm-aside-left--minimize-hover');\r\n                        mUtil.addClass(body, 'm-aside-left--minimize');\r\n                        asideMenu.scrollerUpdate();\r\n                        asideMenu.scrollerTop();\r\n                    }\r\n                }, 500);\r\n            });\r\n        }\r\n    }\r\n\r\n    //== Sidebar toggle\r\n    var initLeftAsideToggle = function() {\r\n        if ($('#m_aside_left_minimize_toggle').length === 0) {\r\n            return;\r\n        }\r\n\r\n        asideLeftToggle = new mToggle('m_aside_left_minimize_toggle', {\r\n            target: 'body',\r\n            targetState: 'm-brand--minimize m-aside-left--minimize',\r\n            togglerState: 'm-brand__toggler--active'\r\n        }); \r\n\r\n        asideLeftToggle.on('toggle', function(toggle) {     \r\n            mainPortlet.updateSticky();       \r\n            \r\n            horMenu.pauseDropdownHover(800);\r\n            asideMenu.pauseDropdownHover(800);\r\n\r\n            //== Remember state in cookie\r\n            Cookies.set('sidebar_toggle_state', toggle.getState());\r\n            // to set default minimized left aside use this cookie value in your \r\n            // server side code and add \"m-brand--minimize m-aside-left--minimize\" classes to \r\n            // the body tag in order to initialize the minimized left aside mode during page loading.\r\n        });\r\n    }\r\n\r\n    //== Sidebar hide\r\n    var initLeftAsideHide = function() {\r\n        if ($('#m_aside_left_hide_toggle').length === 0 ) {\r\n            return;\r\n        }\r\n\r\n        initLeftAsideHide = new mToggle('m_aside_left_hide_toggle', {\r\n            target: 'body',\r\n            targetState: 'm-aside-left--hide',\r\n            togglerState: 'm-brand__toggler--active'\r\n        });\r\n\r\n        initLeftAsideHide.on('toggle', function(toggle) {\r\n            horMenu.pauseDropdownHover(800);\r\n            asideMenu.pauseDropdownHover(800);\r\n\r\n            //== Remember state in cookie\r\n            Cookies.set('sidebar_hide_state', toggle.getState());\r\n            // to set default minimized left aside use this cookie value in your \r\n            // server side code and add \"m-brand--minimize m-aside-left--minimize\" classes to \r\n            // the body tag in order to initialize the minimized left aside mode during page loading.\r\n        });\r\n    }\r\n\r\n    //== Topbar\r\n    var initTopbar = function() {\r\n        $('#m_aside_header_topbar_mobile_toggle').click(function() {\r\n            $('body').toggleClass('m-topbar--on');\r\n        });\r\n\r\n        // Animated Notification Icon \r\n        /*\r\n        setInterval(function() {\r\n            $('#m_topbar_notification_icon .m-nav__link-icon').addClass('m-animate-shake');\r\n            $('#m_topbar_notification_icon .m-nav__link-badge').addClass('m-animate-blink');\r\n        }, 3000);\r\n\r\n        setInterval(function() {\r\n            $('#m_topbar_notification_icon .m-nav__link-icon').removeClass('m-animate-shake');\r\n            $('#m_topbar_notification_icon .m-nav__link-badge').removeClass('m-animate-blink');\r\n        }, 6000);\r\n        */\r\n    }\r\n\r\n    //== Quicksearch\r\n    var initQuicksearch = function() {\r\n        if ($('#m_quicksearch').length === 0) {\r\n            return;\r\n        }\r\n\r\n        quicksearch = new mQuicksearch('m_quicksearch', {\r\n            mode: mUtil.attr('m_quicksearch', 'm-quicksearch-mode'), // quick search type\r\n            minLength: 1\r\n        });\r\n\r\n        //<div class=\"m-search-results m-search-results--skin-light\"><span class=\"m-search-result__message\">Something went wrong</div></div>\r\n\r\n        quicksearch.on('search', function(the) {\r\n            the.showProgress();\r\n\r\n            $.ajax({\r\n                url: 'inc/api/quick_search.php',\r\n                data: {\r\n                    query: the.query\r\n                },\r\n                dataType: 'html',\r\n                success: function(res) {\r\n                    the.hideProgress();\r\n                    the.showResult(res);\r\n                },\r\n                error: function(res) {\r\n                    the.hideProgress();\r\n                    the.showError('Connection error. Pleae try again later.');\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    //== Scrolltop\r\n    var initScrollTop = function() {\r\n        var scrollTop = new mScrollTop('m_scroll_top', {\r\n            offset: 300,\r\n            speed: 600\r\n        });\r\n    }\r\n\r\n    //== Main portlet(sticky portlet)\r\n    var createMainPortlet = function() {\r\n        return new mPortlet('main_portlet', {\r\n            sticky: {\r\n                offset: parseInt(mUtil.css( mUtil.get('m_header'), 'height')),\r\n                zIndex: 90,\r\n                position: {\r\n                    top: function() {\r\n                        return parseInt(mUtil.css( mUtil.get('m_header'), 'height') );\r\n                    },\r\n                    left: function() {\r\n                        var left = parseInt(mUtil.css( mUtil.getByClass('m-content'), 'paddingLeft'));\r\n                        \r\n                        if (mUtil.isInResponsiveRange('desktop')) {\r\n                            //left += parseInt(mUtil.css(mUtil.get('m_aside_left'), 'width') );\r\n                            if (mUtil.hasClass(mUtil.get('body'), 'm-aside-left--minimize')) {\r\n                                left += 78; // need to use hardcoded width of the minimize aside\r\n                            } else {\r\n                                left += 255; // need to use hardcoded width of the aside\r\n                            }\r\n                        } \r\n\r\n                        return left; \r\n                    },\r\n                    right: function() {\r\n                        return parseInt(mUtil.css( mUtil.getByClass('m-content'), 'paddingRight') );\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    return {\r\n        init: function() {\r\n            this.initHeader();\r\n            this.initAside();\r\n            this.initMainPortlet();\r\n        },\r\n\r\n        initMainPortlet: function() {\r\n            if (!mUtil.get('main_portlet')) {\r\n                return;\r\n            }\r\n            \r\n            mainPortlet = createMainPortlet();\r\n            mainPortlet.initSticky();\r\n            \r\n            mUtil.addResizeHandler(function(){\r\n                mainPortlet.updateSticky();\r\n            });\r\n        },\r\n\r\n        resetMainPortlet: function() {\r\n            mainPortlet.destroySticky();\r\n            mainPortlet = createMainPortlet();\r\n            mainPortlet.initSticky();\r\n        },\r\n\r\n        initHeader: function() {\r\n            initStickyHeader();\r\n            initHorMenu();\r\n            initTopbar();\r\n            initQuicksearch();\r\n            initScrollTop();\r\n        },\r\n\r\n        initAside: function() { \r\n            initLeftAside();\r\n            initLeftAsideMenu();\r\n            initLeftAsideToggle();\r\n            initLeftAsideHide();\r\n\r\n            this.onLeftSidebarToggle(function(e) {\r\n                //== Update sticky portlet\r\n                if (mainPortlet) {\r\n                    mainPortlet.updateSticky();\r\n                }\r\n\r\n                //== Reload datatable\r\n                var datatables = $('.m-datatable');\r\n                if (datatables) {\r\n                    datatables.each(function() {\r\n                        $(this).mDatatable('redraw');\r\n                    });\r\n                }                \r\n            });\r\n        },\r\n\r\n        getAsideMenu: function() {\r\n            return asideMenu;\r\n        },\r\n\r\n        onLeftSidebarToggle: function(handler) {\r\n            if (asideLeftToggle) {\r\n                asideLeftToggle.on('toggle', handler);\r\n            }\r\n        },\r\n\r\n        closeMobileAsideMenuOffcanvas: function() {\r\n            if (mUtil.isMobileDevice()) {\r\n                asideMenuOffcanvas.hide();\r\n            }\r\n        },\r\n\r\n        closeMobileHorMenuOffcanvas: function() {\r\n            if (mUtil.isMobileDevice()) {\r\n                horMenuOffcanvas.hide();\r\n            }\r\n        }\r\n    };\r\n}();\r\n\r\n$(document).ready(function() {\r\n    if (mUtil.isAngularVersion() === false) {\r\n        mLayout.init();\r\n    }\r\n});\n\nvar mQuickSidebar = function() {\r\n    var topbarAside = $('#m_quick_sidebar');\r\n    var topbarAsideTabs = $('#m_quick_sidebar_tabs');    \r\n    var topbarAsideContent = topbarAside.find('.m-quick-sidebar__content');\r\n\r\n    var initMessages = function() {\r\n        var messages = mUtil.find( mUtil.get('m_quick_sidebar_tabs_messenger'),  '.m-messenger__messages'); \r\n        var form = $('#m_quick_sidebar_tabs_messenger .m-messenger__form');\r\n\r\n        mUtil.scrollerInit(messages, {\r\n            disableForMobile: true, \r\n            resetHeightOnDestroy: false, \r\n            handleWindowResize: true, \r\n            height: function() {\r\n                var height = topbarAside.outerHeight(true) - \r\n                    topbarAsideTabs.outerHeight(true) - \r\n                    form.outerHeight(true) - 120;\r\n\r\n                return height;                    \r\n            }\r\n        });\r\n    }\r\n\r\n    var initSettings = function() { \r\n        var settings = mUtil.find( mUtil.get('m_quick_sidebar_tabs_settings'),  '.m-list-settings'); \r\n\r\n        if (!settings) {\r\n            return;\r\n        }\r\n\r\n        mUtil.scrollerInit(settings, {\r\n            disableForMobile: true, \r\n            resetHeightOnDestroy: false, \r\n            handleWindowResize: true, \r\n            height: function() {\r\n                return mUtil.getViewPort().height - topbarAsideTabs.outerHeight(true) - 60;            \r\n            }\r\n        });\r\n    }\r\n\r\n    var initLogs = function() {\r\n        var logs = mUtil.find( mUtil.get('m_quick_sidebar_tabs_logs'),  '.m-list-timeline'); \r\n\r\n        if (!logs) {\r\n            return;\r\n        }\r\n\r\n        mUtil.scrollerInit(logs, {\r\n            disableForMobile: true, \r\n            resetHeightOnDestroy: false, \r\n            handleWindowResize: true, \r\n            height: function() {\r\n                return mUtil.getViewPort().height - topbarAsideTabs.outerHeight(true) - 60;            \r\n            }\r\n        });\r\n    }\r\n\r\n    var initOffcanvasTabs = function() {\r\n        initMessages();\r\n        initSettings();\r\n        initLogs();\r\n    }\r\n\r\n    var initOffcanvas = function() {\r\n        var topbarAsideObj = new mOffcanvas('m_quick_sidebar', {\r\n            overlay: true,  \r\n            baseClass: 'm-quick-sidebar',\r\n            closeBy: 'm_quick_sidebar_close',\r\n            toggleBy: 'm_quick_sidebar_toggle'\r\n        });   \r\n\r\n        // run once on first time dropdown shown\r\n        topbarAsideObj.one('afterShow', function() {\r\n            mApp.block(topbarAside);\r\n\r\n            setTimeout(function() {\r\n                mApp.unblock(topbarAside);\r\n                \r\n                topbarAsideContent.removeClass('m--hide');\r\n\r\n                initOffcanvasTabs();\r\n            }, 1000);                         \r\n        });\r\n    }\r\n\r\n    return {     \r\n        init: function() {  \r\n            if (topbarAside.length === 0) {\r\n                return;\r\n            }\r\n\r\n            initOffcanvas(); \r\n        }\r\n    };\r\n}();\r\n\r\n$(document).ready(function() {\r\n    mQuickSidebar.init();\r\n});"],"file":"scripts.bundle.js"}